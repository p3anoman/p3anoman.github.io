/**
 * Copyright Croquet Corporation 2021
 * Bundle of @croquet/croquet
 * Date: 2021-10-21
 * Version: 1.0.5
 */

var Croquet=function(e){"use strict";if(void 0===window.TextEncoder){window.TextEncoder=function(){},TextEncoder.prototype.encode=function(e){for(var t=e.length,n=-1,i="undefined"==typeof Uint8Array?new Array(1.5*t):new Uint8Array(3*t),r=0,o=0,s=0;s!==t;){if(r=e.charCodeAt(s),s+=1,r>=55296&&r<=56319){if(s===t){i[n+=1]=239,i[n+=1]=191,i[n+=1]=189;break}if(!((o=e.charCodeAt(s))>=56320&&o<=57343)){i[n+=1]=239,i[n+=1]=191,i[n+=1]=189;continue}if(s+=1,(r=1024*(r-55296)+o-56320+65536)>65535){i[n+=1]=240|r>>>18,i[n+=1]=128|r>>>12&63,i[n+=1]=128|r>>>6&63,i[n+=1]=128|63&r;continue}}r<=127?i[n+=1]=0|r:r<=2047?(i[n+=1]=192|r>>>6,i[n+=1]=128|63&r):(i[n+=1]=224|r>>>12,i[n+=1]=128|r>>>6&63,i[n+=1]=128|63&r)}return"undefined"!=typeof Uint8Array?i.subarray(0,n+1):(i.length=n+1,i)},TextEncoder.prototype.toString=function(){return"[object TextEncoder]"};try{Object.defineProperty(TextEncoder.prototype,"encoding",{get:function(){if(TextEncoder.prototype.isPrototypeOf(this))return"utf-8";throw TypeError("Illegal invocation")}})}catch(e){TextEncoder.prototype.encoding="utf-8"}"undefined"!=typeof Symbol&&(TextEncoder.prototype[Symbol.toStringTag]="TextEncoder")}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,c,"next",e)}function c(e){r(s,i,o,a,c,"throw",e)}a(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function m(e,t,n){return(m=f()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&h(r,n.prototype),r}).apply(null,arguments)}function p(e){var t="function"==typeof Map?new Map:void 0;return(p=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return m(e,arguments,d(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),h(i,e)})(e)}function y(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function b(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){var t=f();return function(){var n,i=d(e);if(t){var r=d(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return b(this,n)}}function g(e,t,n){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Z(e,t){return x(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){a=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}(e,t)||L(e,t)||S()}function w(e){return x(e)||k(e)||L(e)||S()}function X(e){return function(e){if(Array.isArray(e))return G(e)}(e)||k(e)||L(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){if(Array.isArray(e))return e}function k(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function L(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=L(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}var Y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var r=t&&t.prototype instanceof b?t:b,o=Object.create(r.prototype),s=new Y(i||[]);return o._invoke=function(e,t,n){var i=h;return function(r,o){if(i===m)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return R()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=G(s,n);if(a){if(a===y)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=m;var c=d(e,t,n);if("normal"===c.type){if(i=n.done?p:f,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=p,n.method="throw",n.arg=c.arg)}}}(e,n,s),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",m="executing",p="completed",y={};function b(){}function v(){}function g(){}var Z={};l(Z,s,(function(){return this}));var w=Object.getPrototypeOf,X=w&&w(w(C([])));X&&X!==n&&r.call(X,s)&&(Z=X);var x=g.prototype=b.prototype=Object.create(Z);function k(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,s,a,c){var l=d(e[o],e,s);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"===i(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(l.arg)}var o;this._invoke=function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return o=o?o.then(r,r):r()}}function G(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,G(e,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=d(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,y;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function W(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function C(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:t,done:!0}}return v.prototype=g,l(x,"constructor",g),l(g,"constructor",v),v.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},k(L.prototype),l(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var s=new L(u(t,n,i,r),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},k(x),l(x,c,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=C,Y.prototype={constructor:Y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(W),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(i,r){return a.type="throw",a.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),W(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;W(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:C(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{globalThis.regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":i(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}({exports:{}});var C=window.location.hostname.endsWith("croquet.studio"),R="",V="";function I(e,t){if(t){var n,i=W(t.split("&"));try{for(i.s();!(n=i.n()).done;){var r=n.value.split("="),o=r[0],s=!0;if(r.length>1&&(s=decodeURIComponent(r.slice(1).join("="))).match(/^(true|false|null|[0-9.]*|["[{].*)$/))try{s=JSON.parse(s)}catch(e){"["===s[0]&&(s=s.slice(1,-1).split(","))}e[o]=s}}catch(e){i.e(e)}finally{i.f()}}}var T,K=new(function(){function e(){s(this,e),this.getSession(),I(this,window.location.search.slice(1)),I(this,C?window.location.hash.slice(1):V),window.location.pathname.indexOf("/ar.html")>=0&&(this.ar=!0)}return c(e,[{key:"has",value:function(e,t,n){"boolean"!=typeof n&&(n=this.isHost(n));var i=this[e];if("string"!=typeof i)return n;var r=i.split(",");return!0===n&&(t="no".concat(t)),t.endsWith("s")&&(t=t.slice(0,-1)),r.includes(t)||r.includes("".concat(t,"s"))?!n:n}},{key:"getSession",value:function(){if(C){var e=window.location.pathname.match(/^\/([^/]+)\/(.*)$/);if(e)return R=e[1],e[2]}else{var t=window.location.hash.match(/^#([^&]+)&?(.*)$/);if(t)return t[1].includes("=")?(V="".concat(t[1],"&").concat(t[2]),""):(V=t[2],t[1])}return"string"==typeof this.session?(V=window.location.hash.slice(1),this.session):""}},{key:"setSession",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==C&&this.getSession();var n=window.location,i=n.search,r=n.hash,o=C?"/".concat(R,"/").concat(e).concat(i).concat(r):"#".concat(e).concat(V?"&"+V:"");t?window.history.replaceState({},"",o):window.history.pushState({},"",o)}},{key:"isHost",value:function(e){var t=window.location.hostname;if(t===e)return!0;if("localhost"!==e)return!1;if(t.endsWith(".ngrok.io"))return!0;if("croquet.io"===t&&window.location.pathname.match(/^\/(dev|files)\//))return!0;return["127.0.0.1","[::1]"].includes(t)}},{key:"isLocalhost",value:function(){return this.isHost("localhost")}}]),e}()),P=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,o=t.cmp&&(n=t.cmp,function(e){return function(t,i){var r={key:t,value:e[t]},o={key:i,value:e[i]};return n(r,o)}}),s=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==i(t))return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==s.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var c=s.push(t)-1,l=Object.keys(t).sort(o&&o(t));for(a="",n=0;n<l.length;n++){var u=l[n],d=e(t[u]);d&&(a&&(a+=","),a+=JSON.stringify(u)+":"+d)}return s.splice(c,1),"{"+a+"}"}}(e)},H={exports:{}},M={exports:{}};M.exports=T=T||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==Y&&Y.crypto&&(n=Y.crypto),!n)try{n=require("crypto")}catch(e){}var i=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},s=o.lib={},a=s.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=a.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=s<<24-(i+o)%4*8}else for(var a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new c.init(t,e)}}),l=o.enc={},u=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new c.init(n,t/2)}},d=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new c.init(n,t)}},h=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},f=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,i=this._data,r=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),l=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,u=e.min(4*l,o);if(l){for(var d=0;d<l;d+=s)this._doProcessBlock(r,d);n=r.splice(0,l),i.sigBytes-=u}return new c.init(n,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}});var m=o.algo={};return o}(Math),function(e,t){e.exports=function(e){return function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init;(t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,i=[],r=0;r<t;r++)i[r>>>2]|=e[r]<<24-r%4*8;n.call(this,i,t)}else n.apply(this,arguments)}).prototype=t}}(),e.lib.WordArray}(M.exports)}(H);var N=H.exports,F={exports:{}};!function(e,t){e.exports=function(e){return function(t){var n=e,i=n.lib,r=i.WordArray,o=i.Hasher,s=n.algo,a=[],c=[];!function(){function e(e){for(var n=t.sqrt(e),i=2;i<=n;i++)if(!(e%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,r=0;r<64;)e(i)&&(r<8&&(a[r]=n(t.pow(i,.5))),c[r]=n(t.pow(i,1/3)),r++),i++}();var l=[],u=s.SHA256=o.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],u=n[5],d=n[6],h=n[7],f=0;f<64;f++){if(f<16)l[f]=0|e[t+f];else{var m=l[f-15],p=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,y=l[f-2],b=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;l[f]=p+l[f-7]+b+l[f-16]}var v=i&r^i&o^r&o,g=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),Z=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&d)+c[f]+l[f];h=d,d=u,u=a,a=s+Z|0,s=o,o=r,r=i,i=Z+(g+v)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(u),n.HmacSHA256=o._createHmacHelper(u)}(Math),e.SHA256}(M.exports)}(F);var z,j=F.exports,E=["hashOverride"];function _(e){for(var t=e.sigBytes,n=e.words,i=new Uint8Array(t),r=0,o=0;r<t;){var s=n[o++];if(i[r++]=(4278190080&s)>>>24,r===t)break;if(i[r++]=(16711680&s)>>>16,r===t)break;if(i[r++]=(65280&s)>>>8,r===t)break;i[r++]=255&s}return i}function J(e){function t(e){var t=e.indexOf("{"),n=e.lastIndexOf("}");if(-1===t||-1===n||n<t)return e;var i=e.slice(0,t).replace(/\s+/g," ").replace(/\s\(/,"("),r=e.slice(t+1,n);return"".concat(i.trim(),"{").concat(r.trim(),"}")}var n=t(""+e);if(!n.startsWith("class")){var i=e.prototype;i&&(n+=Object.getOwnPropertyNames(i).map((function(e){return"".concat(e,":").concat(t(""+i[e]))})).join(""))}return n}function Q(e){return btoa(String.fromCharCode.apply(String,X(new Uint8Array(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function U(e){return D.apply(this,arguments)}function D(){return(D=o(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return","47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU");case 2:return e.next=4,z("SHA-256",t);case 4:return n=e.sent,e.abrupt("return",Q(n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return K.has("debug","hashing",!1)}z=window.crypto&&window.crypto.subtle&&"function"==typeof window.crypto.subtle.digest?window.crypto.subtle.digest.bind(window.crypto.subtle):function(e,t){if("SHA-256"!==e)throw Error("Croquet: only SHA-256 available");var n=N.create(t);return _(j(n)).buffer};var B={},A=new TextEncoder;function q(e){return $.apply(this,arguments)}function $(){return($=o(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A.encode(t),e.next=3,U(n);case 3:return i=e.sent,O()&&(B[i]={string:t,buffer:n}),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=[],te={};function ne(e,t){return ie.apply(this,arguments)}function ie(){return(ie=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",q(t+P(n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=new Set;function oe(e,t,n,i){return se.apply(this,arguments)}function se(){return(se=o(regeneratorRuntime.mark((function e(t,i,r,o){var s,a,c,l,u,d,h,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=te[t],l="",!c){e.next=8;break}s=c.codeHashes,a=c.computedCodeHash,l=" (code hashing from cache)",e.next=15;break;case 8:return e.next=10,Promise.all(ee);case 10:return s=e.sent,e.next=13,q([o].concat(X(s)).join("|"));case 13:a=e.sent,te[t]={codeHashes:s,computedCodeHash:a};case 15:return u=r.hashOverride,d=y(r,E),h=u||a,e.next=19,q(t+"|"+i+P(d)+h);case 19:return f=e.sent,O()&&!re.has(f)&&(X(document.getElementsByTagName("meta")).find((function(e){return e.getAttribute("charset")}))||console.warn('Croquet: Missing <meta charset="..."> declaration. Croquet model code hashing might differ between browsers.'),B[a].what="Version ID",B[t].what="Persistent ID",B[f].what="Session ID",h!==a&&(s.push(a),B[a].what="Computed Version ID (replaced by overrideHash)",B[h]={what:"Version ID (as specified by overrideHash)"}),m=[].concat(X(s),[h,t,f]).map((function(e){return n({hash:e},B[e])})),console.log("Croquet: Debug Hashing for session ".concat(f).concat(l),m),re.add(f)),e.abrupt("return",{id:f,persistentId:t,codeHash:h,computedCodeHash:a});case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ae={exports:{}};!function(e){var t,n;t=Y,n=function(e){var t=function e(t){return new e.lib.init(t)};function n(e,t){return t.offset[e]?isNaN(t.offset[e])?t.offset[e]:t.offset[e]+"px":"0px"}function r(e,t){return!(!e||"string"!=typeof t||!(e.className&&e.className.trim().split(/\s+/gi).indexOf(t)>-1))}return t.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,style:{background:""}},t.lib=t.prototype={toastify:"1.11.2",constructor:t,init:function(e){return e||(e={}),this.options={},this.toastElement=null,this.options.text=e.text||t.defaults.text,this.options.node=e.node||t.defaults.node,this.options.duration=0===e.duration?0:e.duration||t.defaults.duration,this.options.selector=e.selector||t.defaults.selector,this.options.callback=e.callback||t.defaults.callback,this.options.destination=e.destination||t.defaults.destination,this.options.newWindow=e.newWindow||t.defaults.newWindow,this.options.close=e.close||t.defaults.close,this.options.gravity="bottom"===e.gravity?"toastify-bottom":t.defaults.gravity,this.options.positionLeft=e.positionLeft||t.defaults.positionLeft,this.options.position=e.position||t.defaults.position,this.options.backgroundColor=e.backgroundColor||t.defaults.backgroundColor,this.options.avatar=e.avatar||t.defaults.avatar,this.options.className=e.className||t.defaults.className,this.options.stopOnFocus=void 0===e.stopOnFocus?t.defaults.stopOnFocus:e.stopOnFocus,this.options.onClick=e.onClick||t.defaults.onClick,this.options.offset=e.offset||t.defaults.offset,this.options.escapeMarkup=void 0!==e.escapeMarkup?e.escapeMarkup:t.defaults.escapeMarkup,this.options.style=e.style||t.defaults.style,e.backgroundColor&&(this.options.style.background=e.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var e=document.createElement("div");for(var t in e.className="toastify on "+this.options.className,this.options.position?e.className+=" toastify-"+this.options.position:!0===this.options.positionLeft?(e.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):e.className+=" toastify-right",e.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.'),this.options.style)e.style[t]=this.options.style[t];if(this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)e.appendChild(this.options.node);else if(this.options.escapeMarkup?e.innerText=this.options.text:e.innerHTML=this.options.text,""!==this.options.avatar){var r=document.createElement("img");r.src=this.options.avatar,r.className="toastify-avatar","left"==this.options.position||!0===this.options.positionLeft?e.appendChild(r):e.insertAdjacentElement("afterbegin",r)}if(!0===this.options.close){var o=document.createElement("span");o.innerHTML="&#10006;",o.className="toast-close",o.addEventListener("click",function(e){e.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}.bind(this));var s=window.innerWidth>0?window.innerWidth:screen.width;("left"==this.options.position||!0===this.options.positionLeft)&&s>360?e.insertAdjacentElement("afterbegin",o):e.appendChild(o)}if(this.options.stopOnFocus&&this.options.duration>0){var a=this;e.addEventListener("mouseover",(function(t){window.clearTimeout(e.timeOutValue)})),e.addEventListener("mouseleave",(function(){e.timeOutValue=window.setTimeout((function(){a.removeElement(e)}),a.options.duration)}))}if(void 0!==this.options.destination&&e.addEventListener("click",function(e){e.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination}.bind(this)),"function"==typeof this.options.onClick&&void 0===this.options.destination&&e.addEventListener("click",function(e){e.stopPropagation(),this.options.onClick()}.bind(this)),"object"===i(this.options.offset)){var c=n("x",this.options),l=n("y",this.options),u="left"==this.options.position?c:"-"+c,d="toastify-top"==this.options.gravity?l:"-"+l;e.style.transform="translate("+u+","+d+")"}return e},showToast:function(){var e;if(this.toastElement=this.buildToast(),!(e="string"==typeof this.options.selector?document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||"undefined"!=typeof ShadowRoot&&this.options.selector instanceof ShadowRoot?this.options.selector:document.body))throw"Root element is not defined";var n=t.defaults.oldestFirst?e.firstChild:e.lastChild;return e.insertBefore(this.toastElement,n),t.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout(function(){this.removeElement(this.toastElement)}.bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(e){e.className=e.className.replace(" on",""),window.setTimeout(function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),e.parentNode&&e.parentNode.removeChild(e),this.options.callback.call(e),t.reposition()}.bind(this),400)}},t.reposition=function(){for(var e,t={top:15,bottom:15},n={top:15,bottom:15},i={top:15,bottom:15},o=document.getElementsByClassName("toastify"),s=0;s<o.length;s++){e=!0===r(o[s],"toastify-top")?"toastify-top":"toastify-bottom";var a=o[s].offsetHeight;e=e.substr(9,e.length-1),(window.innerWidth>0?window.innerWidth:screen.width)<=360?(o[s].style[e]=i[e]+"px",i[e]+=a+15):!0===r(o[s],"toastify-left")?(o[s].style[e]=t[e]+"px",t[e]+=a+15):(o[s].style[e]=n[e]+"px",n[e]+=a+15)}return this},t.lib.init.prototype=t.lib,t},e.exports?e.exports=n():t.Toastify=n()}(ae);var ce=ae.exports,le={exports:{}};!function(e){!function(t,n,r){var o,s=256,a=r.pow(s,6),c=r.pow(2,52),l=2*c,u=255;function d(e,i,u){var d=[],b=p(m((i=1==i?{entropy:!0}:i||{}).entropy?[e,y(n)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(s):(e=new Uint8Array(s),(t.crypto||t.msCrypto).getRandomValues(e)),y(e)}catch(e){var i=t.navigator,r=i&&i.plugins;return[+new Date,t,r,t.screen,y(n)]}}():e,3),d),v=new h(d),g=function(){for(var e=v.g(6),t=a,n=0;e<c;)e=(e+n)*s,t*=s,n=v.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return g.int32=function(){return 0|v.g(4)},g.quick=function(){return v.g(4)/4294967296},g.double=g,p(y(v.S),n),(i.pass||u||function(e,t,n,i){return i&&(i.S&&f(i,v),e.state=function(){return f(v,{})}),n?(r.random=e,t):e})(g,b,"global"in i?i.global:this==r,i.state)}function h(e){var t,n=e.length,i=this,r=0,o=i.i=i.j=0,a=i.S=[];for(n||(e=[n++]);r<s;)a[r]=r++;for(r=0;r<s;r++)a[r]=a[o=u&o+e[r%n]+(t=a[r])],a[o]=t;(i.g=function(e){for(var t,n=0,r=i.i,o=i.j,a=i.S;e--;)t=a[r=u&r+1],n=n*s+a[u&(a[r]=a[o=u&o+t])+(a[o]=t)];return i.i=r,i.j=o,n})(s)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],o=i(e);if(t&&"object"==o)for(n in e)try{r.push(m(e[n],t-1))}catch(e){}return r.length?r:"string"==o?e:e+"\0"}function p(e,t){for(var n,i=e+"",r=0;r<i.length;)t[u&r]=u&(n^=19*t[u&r])+i.charCodeAt(r++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(p(r.random(),n),e.exports){e.exports=d;try{o=require("crypto")}catch(e){}}else r.seedrandom=d}("undefined"!=typeof self?self:Y,[],Math)}(le);var ue,de=le.exports;!function(){function e(e){this.mode=n.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,i=this.data.length;t<i;t++){var r=[],o=this.data.charCodeAt(t);o>65536?(r[0]=240|(1835008&o)>>>18,r[1]=128|(258048&o)>>>12,r[2]=128|(4032&o)>>>6,r[3]=128|63&o):o>2048?(r[0]=224|(61440&o)>>>12,r[1]=128|(4032&o)>>>6,r[2]=128|63&o):o>128?(r[0]=192|(1984&o)>>>6,r[1]=128|63&o):r[0]=o,this.parsedData.push(r)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;t<n;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[i][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var i=-1;i<=7;i++)t+i<=-1||this.moduleCount<=t+i||(this.modules[e+n][t+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=h.getLostPoint(this);(0==n||e>i)&&(e=i,t=n)}return t},createMovieClip:function(e,t,n){var i=e.createEmptyMovieClip(t,n);this.make();for(var r=0;r<this.modules.length;r++)for(var o=1*r,s=0;s<this.modules[r].length;s++){var a=1*s;this.modules[r][s]&&(i.beginFill(0,100),i.moveTo(a,o),i.lineTo(a+1,o),i.lineTo(a+1,o+1),i.lineTo(a,o+1),i.endFill())}return i},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=h.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var i=e[t],r=e[n];if(null==this.modules[i][r])for(var o=-2;o<=2;o++)for(var s=-2;s<=2;s++)this.modules[i+o][r+s]=-2==o||2==o||-2==s||2==s||0==o&&0==s}},setupTypeNumber:function(e){for(var t=h.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;n<18;n++){i=!e&&1==(t>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,i=h.getBCHTypeInfo(n),r=0;r<15;r++){var o=!e&&1==(i>>r&1);r<6?this.modules[r][8]=o:r<8?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o}for(r=0;r<15;r++){o=!e&&1==(i>>r&1);r<8?this.modules[8][this.moduleCount-r-1]=o:r<9?this.modules[8][15-r-1+1]=o:this.modules[8][15-r-1]=o}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,i=this.moduleCount-1,r=7,o=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var a=0;a<2;a++)if(null==this.modules[i][s-a]){var c=!1;o<e.length&&(c=1==(e[o]>>>r&1)),h.getMask(t,i,s-a)&&(c=!c),this.modules[i][s-a]=c,-1==--r&&(o++,r=7)}if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,i){for(var r=y.getRSBlocks(e,n),o=new b,s=0;s<i.length;s++){var a=i[s];o.put(a.mode,4),o.put(a.getLength(),h.getLengthInBits(a.mode,e)),a.write(o)}var c=0;for(s=0;s<r.length;s++)c+=r[s].dataCount;if(o.getLengthInBits()>8*c)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*c+")");for(o.getLengthInBits()+4<=8*c&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*c||(o.put(t.PAD0,8),o.getLengthInBits()>=8*c));)o.put(t.PAD1,8);return t.createBytes(o,r)},t.createBytes=function(e,t){for(var n=0,i=0,r=0,o=new Array(t.length),s=new Array(t.length),a=0;a<t.length;a++){var c=t[a].dataCount,l=t[a].totalCount-c;i=Math.max(i,c),r=Math.max(r,l),o[a]=new Array(c);for(var u=0;u<o[a].length;u++)o[a][u]=255&e.buffer[u+n];n+=c;var d=h.getErrorCorrectPolynomial(l),f=new p(o[a],d.getLength()-1).mod(d);s[a]=new Array(d.getLength()-1);for(u=0;u<s[a].length;u++){var m=u+f.getLength()-s[a].length;s[a][u]=m>=0?f.get(m):0}}var y=0;for(u=0;u<t.length;u++)y+=t[u].totalCount;var b=new Array(y),v=0;for(u=0;u<i;u++)for(a=0;a<t.length;a++)u<o[a].length&&(b[v++]=o[a][u]);for(u=0;u<r;u++)for(a=0;a<t.length;a++)u<s[a].length&&(b[v++]=s[a][u]);return b};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},r=0,o=1,s=2,a=3,c=4,l=5,u=6,d=7,h={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;h.getBCHDigit(t)-h.getBCHDigit(h.G15)>=0;)t^=h.G15<<h.getBCHDigit(t)-h.getBCHDigit(h.G15);return(e<<10|t)^h.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;h.getBCHDigit(t)-h.getBCHDigit(h.G18)>=0;)t^=h.G18<<h.getBCHDigit(t)-h.getBCHDigit(h.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return h.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case r:return(t+n)%2==0;case o:return t%2==0;case s:return n%3==0;case a:return(t+n)%3==0;case c:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case l:return t*n%2+t*n%3==0;case u:return(t*n%2+t*n%3)%2==0;case d:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new p([1],0),n=0;n<e;n++)t=t.multiply(new p([1,f.gexp(n)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:case n.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,i=0;i<t;i++)for(var r=0;r<t;r++){for(var o=0,s=e.isDark(i,r),a=-1;a<=1;a++)if(!(i+a<0||t<=i+a))for(var c=-1;c<=1;c++)r+c<0||t<=r+c||0==a&&0==c||s==e.isDark(i+a,r+c)&&o++;o>5&&(n+=3+o-5)}for(i=0;i<t-1;i++)for(r=0;r<t-1;r++){var l=0;e.isDark(i,r)&&l++,e.isDark(i+1,r)&&l++,e.isDark(i,r+1)&&l++,e.isDark(i+1,r+1)&&l++,0!=l&&4!=l||(n+=3)}for(i=0;i<t;i++)for(r=0;r<t-6;r++)e.isDark(i,r)&&!e.isDark(i,r+1)&&e.isDark(i,r+2)&&e.isDark(i,r+3)&&e.isDark(i,r+4)&&!e.isDark(i,r+5)&&e.isDark(i,r+6)&&(n+=40);for(r=0;r<t;r++)for(i=0;i<t-6;i++)e.isDark(i,r)&&!e.isDark(i+1,r)&&e.isDark(i+2,r)&&e.isDark(i+3,r)&&e.isDark(i+4,r)&&!e.isDark(i+5,r)&&e.isDark(i+6,r)&&(n+=40);var u=0;for(r=0;r<t;r++)for(i=0;i<t;i++)e.isDark(i,r)&&u++;return n+=10*(Math.abs(100*u/t/t-50)/5)}},f={glog:function(e){if(e<1)throw new Error("glog("+e+")");return f.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return f.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},m=0;m<8;m++)f.EXP_TABLE[m]=1<<m;for(m=8;m<256;m++)f.EXP_TABLE[m]=f.EXP_TABLE[m-4]^f.EXP_TABLE[m-5]^f.EXP_TABLE[m-6]^f.EXP_TABLE[m-8];for(m=0;m<255;m++)f.LOG_TABLE[f.EXP_TABLE[m]]=m;function p(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var i=0;i<e.length-n;i++)this.num[i]=e[i+n]}function y(e,t){this.totalCount=e,this.dataCount=t}function b(){this.buffer=[],this.length=0}p.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<e.getLength();i++)t[n+i]^=f.gexp(f.glog(this.get(n))+f.glog(e.get(i)));return new p(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=f.glog(this.get(0))-f.glog(e.get(0)),n=new Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<e.getLength();i++)n[i]^=f.gexp(f.glog(e.get(i))+t);return new p(n,0).mod(e)}},y.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],y.getRSBlocks=function(e,t){var n=y.getRsBlockTable(e,t);if(null==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var i=n.length/3,r=[],o=0;o<i;o++)for(var s=n[3*o+0],a=n[3*o+1],c=n[3*o+2],l=0;l<s;l++)r.push(new y(a,c));return r},y.getRsBlockTable=function(e,t){switch(t){case i.L:return y.RS_BLOCK_TABLE[4*(e-1)+0];case i.M:return y.RS_BLOCK_TABLE[4*(e-1)+1];case i.Q:return y.RS_BLOCK_TABLE[4*(e-1)+2];case i.H:return y.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},b.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var v=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],g=function(){var e=function(e,t){this._bIsPainted=!1,this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null};return e.prototype.draw=function(e){var t=this._oContext,n=this._htOption,i=e.getModuleCount(),r=n.width/i,o=n.height/i,s=Math.round(r),a=Math.round(o);this.clear();for(var c=0;c<i;c++)for(var l=0;l<i;l++){var u=e.isDark(c,l),d=l*r,h=c*o;t.strokeStyle=u?n.colorDark:n.colorLight,t.lineWidth=1,t.fillStyle=u?n.colorDark:n.colorLight,t.fillRect(d,h,r,o),t.strokeRect(Math.floor(d)+.5,Math.floor(h)+.5,s,a),t.strokeRect(Math.ceil(d)-.5,Math.ceil(h)-.5,s,a)}this._bIsPainted=!0},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},e}();function Z(e,t){for(var n=1,r=function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}(e),o=0,s=v.length;o<=s;o++){var a=0;switch(t){case i.L:a=v[o][0];break;case i.M:a=v[o][1];break;case i.Q:a=v[o][2];break;case i.H:a=v[o][3]}if(r<=a)break;n++}if(n>v.length)throw new Error("Too long data");return n}(ue=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._htOption.useSVG&&(g=svgDrawer),this._el=e,this._oQRCode=null,this._oDrawing=new g(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(e){this._oQRCode=new t(Z(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode)},ue.prototype.clear=function(){this._oDrawing.clear()},ue.prototype.getCanvas=function(){for(var e=0;e<this._el.children.length;e++){var t=this._el.children[e];if("CANVAS"===t.tagName)return t}return null},ue.CorrectLevel=i}();var he=ue,fe=Date.now();"undefined"==typeof performance&&(window.performance={now:function(){return Date.now()-fe}});var me,pe,ye=["simulate","update","render","snapshot"],be={total:"black",update:"blue",render:"magenta",simulate:"yellow",snapshot:"green",backlog:"red",network:"lightgray"},ve=null,ge=null,Ze=null,we=0,Xe=null,xe=null;function ke(e){for(ve=e;e.firstChild;)e.removeChild(e.firstChild);e.style.background="#faf0dc",Xe=document.createElement("canvas"),xe=Xe.getContext("2d"),Xe.id="text_stats",Xe.width=Math.min(140,window.innerWidth),Xe.height=36,Xe.style.width=Xe.width,Xe.style.height=Xe.height,xe.font="9.5pt sans-serif",e.appendChild(Xe),e.title=Object.entries(be).map((function(e){var t=Z(e,2),n=t[0],i=t[1];return"".concat(i,": ").concat(n)})).join("\n"),(ge=document.createElement("canvas")).width=Math.min(125,window.innerWidth),ge.height=125,ge.style.width="100%";var t=document.createElement("div");t.id="innerDiv",e.appendChild(t),t.appendChild(ge),Ze=ge.getContext("2d")}var Le=[],Ge=0,Se=!1,We=Ie(0),Ye={},Ce=1e3/60;function Re(e){return 20*(1-e/Ce)+60}function Ve(e){me=function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.style.width="100%",t.style.position="absolute",t.style.left="0px",ve.querySelector("#innerDiv").appendChild(t),t}(e),(pe=me.getContext("2d")).strokeStyle="rgba(255, 255, 255, 0.5)";for(var t=0;t<60;t+=Ce){var n=Re(t);pe.moveTo(0,n),pe.lineTo(me.width,n),pe.stroke()}}function Ie(e){return{start:e,total:0,items:{},users:0,backlog:0,network:0,latency:0,activity:1e3,connected:Se}}function Te(e){We.total=e-We.start;var t=Math.min(120,window.innerWidth);if(Le.length>=t&&Le.splice(0,Le.length-t+1),Le.push(We),!(Le.length<=1)&&ve&&0!==ve.offsetHeight){var n=Le.slice(1).filter((function(e){return e.total})),i=n.map((function(e){return e.total})).reduce((function(e,t){return e+t}),0)/n.length,r=Math.max.apply(Math,X(n.map((function(e){return e.total}))));Math.max.apply(Math,X(n.map((function(e){return Math.max(e.backlog,e.network)})))),Ge=1e3,function(e,t){xe.globalCompositeOperation="copy",xe.fillStyle="rgb(255, 255, 255, 0)",xe.fillRect(0,0,Xe.width,Xe.height),xe.fillStyle="rgb(0, 0, 0, 1)",xe.globalCompositeOperation="source-over";var n="".concat(We.users," users, ").concat(Math.round(1e3/e)," fps");t>70&&(n+=" ".concat(Math.ceil(t).toLocaleString(),"ms")),xe.fillText(n,2,15),n=We.backlog<100&&We.activity<1e3?"latency: ".concat(We.latency," ms"):"backlog: ".concat(We.backlog<100?"0.0":(We.backlog/1e3).toFixed(1)," s"),xe.fillText(n,2,33)}(i,r),me||Ve(ge),we===ge.width?(Ze.globalCompositeOperation="copy",Ze.drawImage(ge,1,0,ge.width-1,ge.height,0,0,ge.width-1,ge.height),Ze.globalCompositeOperation="source-over",Ze.fillStyle="transparent",Ze.fillRect(ge.width-1,0,1,ge.height)):we++;var o=function(e){return Re(e/Ge*-2*Ce)+5},s=Le[Le.length-1],a=we-.5,c=Re(0);Ze.beginPath(),Ze.moveTo(a,c),Ze.lineTo(a,Re(s.total)),Ze.strokeStyle=be[s.connected?"total":"network"],Ze.stroke(),Ze.beginPath(),Ze.moveTo(a,c),c=Re(s.total);var l,u=0,d=W(ye);try{for(d.s();!(l=d.n()).done;){var h=l.value;s.items[h]&&(c=Re(u+=s.items[h]),Ze.lineTo(a,c),Ze.strokeStyle=be[h],Ze.stroke(),Ze.beginPath(),Ze.moveTo(a,c))}}catch(e){d.e(e)}finally{d.f()}s.network&&(Ze.beginPath(),Ze.moveTo(a,o(0)),Ze.lineTo(a,o(s.network)),Ze.strokeStyle=be.network,Ze.stroke())}}var Ke=[],Pe={animationFrame:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Te(e),We=Ie(e);for(var n=0,i=Object.entries(t);n<i.length;n++){var r=Z(i[n],2),o=r[0],s=r[1];this[o](s)}},begin:function(e){var t=performance.now();We.items[e]=(We.items[e]||0)-t;var n=Ke[Ke.length-1];return n&&(We.items[n]+=t),Ke.push(e),t},end:function(e){var t=performance.now();We.items[e]+=t;var n=Ke.pop();if(n!==e)throw Error('Unmatched stats calls: expected end("'.concat(n,'"), got end("').concat(e,'")'));var i=Ke[Ke.length-1];return i&&(We.items[i]-=t),t},backlog:function(e){We.backlog=Math.max(e,We.backlog)},network:function(e){We.network=e},starvation:function(e){We.network=e},latency:function(e){We.latency=e},activity:function(e){We.activity=e},users:function(e){We.users=e},connected:function(e){var t=Se;We.connected=Se=e,t&&!Se&&me&&(me.remove(),pe=null)},perSecondTally:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,n=Object.entries(e);t<n.length;t++){var i=Z(n[t],2),r=i[0],o=i[1];Ye[r]=(Ye[r]||0)+o}},stepSession:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Math.floor(Date.now()/1e3),r=null;if(i!==Ye.second){if(Ye.second&&t&&(Ye.requestedMessages||Ye.sentMessagesTotal)){r=n({},Ye);var o=i-Ye.second;1!==o&&(r.sampleSeconds=o),r.sentBundles&&(r.averageDelay=Math.round(10*r.sendDelay/r.sentMessagesTotal)/10,r.averageBundlePayload=Math.round(r.sentBundlePayload/r.sentBundles)),delete r.second,delete r.sendDelay,delete r.sentBundlePayload}Ye={second:i}}return r}},He="ontouchstart"in document.documentElement,Me=window.parent!==window,Ne=He?20:12,Fe=He?0:15,ze=!1;function je(){if(!ze){ze=!0;var e="\n        #croquet_dock { position: fixed; z-index: 2; border: 3px solid white; bottom: 6px; left: 6px; width: 36px; height: 36px; box-sizing: border-box; background: white; opacity: 0.4; transition: all ".concat(.3,"s ease; }\n        #croquet_dock.active { opacity: 0.95; border-radius: 12px; }\n        #croquet_dock.debug { width: 84px; }\n        #croquet_dock_bar { position: absolute; border: 3px solid white; width: 100%; height: 30px; box-sizing: border-box; background: white; }\n\n        #croquet_badge { position: absolute; width: 72px; height: 24px; top: 50%; transform: translate(0px, -50%); cursor: none; }\n        #croquet_dock.active #croquet_badge { left: 2%; }\n        #croquet_dock:not(.debug) #croquet_badge { display: none; }\n\n        .croquet_dock_button { position: absolute; width: ").concat(Ne,"%; height: 90%; top: 50%; transform: translate(0px, -50%); border-radius: 20%; }\n        .croquet_dock_button:focus { outline: 0; }\n        .croquet_dock_button canvas { position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; }\n        #croquet_dock:not(.active) .croquet_dock_button { display: none; }\n        #croquet_dock_left { right: ").concat(2+Fe+Ne+2,"% }\n        #croquet_dock:not(.debug) #croquet_dock_left { display: none; }\n        #croquet_dock_right { right: ").concat(2+Fe,"%; }\n        #croquet_dock:not(.debug) #croquet_dock_right { display: none; }\n        #croquet_dock_pin { right: ").concat(2,"%; }\n        #croquet_dock_pin.pinned { background: #cce6ff; }\n\n        #croquet_dock_content { position: absolute; left: ").concat(2,"px; top: ").concat(2,"px; right: ").concat(2,"px; bottom: ").concat(2,"px; background: white; overflow: hidden; }\n        #croquet_dock.debug:not(.active) #croquet_dock_content { display: none; }\n        #croquet_dock.debug:not(.active) #croquet_dock_content div { display: none; }\n\n        #croquet_qrcode { position: absolute; width: 100%; height: 100%;box-sizing: border-box; cursor: crosshair; }\n        #croquet_dock.active #croquet_qrcode { border: 6px solid white; }\n        #croquet_dock.debug #croquet_qrcode:not(.active) { display: none; }\n        #croquet_qrcode canvas { image-rendering: pixelated; }\n\n        #croquet_stats { position: absolute; width: 70%; height: 90%; left: 15%; top: 5%; opacity: 0.8; font-family: sans-serif; }\n        #croquet_stats:not(.active) { display: none; }\n"),t=document.createElement("style");t.innerHTML=e,document.head.insertBefore(t,document.head.getElementsByTagName("style")[0])}}var Ee=!1;var _e,Je=!1;function Qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&ct.showMessage(e,n(n({},t),{},{level:"warning"}))}function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&ct.showMessage(e,n(n({},t),{},{level:"status"}))}function De(e,t){console.error("Error during ".concat(e),t);var n=(t.stack||"").split("\n").filter((function(e){return!e.match(/croquet-.*\.min.js/)})).join("\n");ct.showMessage("<b>Error during ".concat(e,": ").concat(t.message,"</b>\n\n").concat(n).replace(/\n/g,"<br>"),{level:"error",duration:1e4,stopOnFocus:!0})}function Oe(e,t){var i=st(ct.root,(function(){return document.body}));if(!1===i)return null;!function(){if(!Je){Je=!0;var e=document.createElement("style");e.innerHTML="/*!\n        * Toastify js 1.5.0\n        * https://github.com/apvarun/toastify-js\n        * @license MIT licensed\n        *\n        * Copyright (C) 2018 Varun A P\n        */\n        .toastify {\n            padding: 12px 20px;\n            color: #ffffff;\n            display: inline-block;\n            box-shadow: 0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);\n            background: -webkit-linear-gradient(315deg, #73a5ff, #5477f5);\n            background: linear-gradient(135deg, #73a5ff, #5477f5);\n            position: fixed;\n            opacity: 0;\n            transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n            border-radius: 2px;\n            cursor: pointer;\n            text-decoration: none;\n            max-width: calc(50% - 20px);\n            z-index: 2147483647;\n        }\n        .toastify.on {\n            opacity: 1;\n        }\n        .toast-close {\n            opacity: 0.4;\n            padding: 0 5px;\n        }\n        .toastify-right {\n            right: 15px;\n        }\n        .toastify-left {\n            left: 15px;\n        }\n        .toastify-top {\n            top: -150px;\n        }\n        .toastify-bottom {\n            bottom: -150px;\n        }\n        .toastify-rounded {\n            border-radius: 25px;\n        }\n        .toastify-avatar {\n            width: 1.5em;\n            height: 1.5em;\n            margin: 0 5px;\n            border-radius: 2px;\n        }\n        @media only screen and (max-width: 360px) {\n            .toastify-right, .toastify-left {\n                margin-left: auto;\n                margin-right: auto;\n                left: 0;\n                right: 0;\n                max-width: fit-content;\n            }\n        }\n\n        .toastify {\n            font-family: sans-serif;\n            border-radius: 8px;\n        }\n\n        .toastify-center {\n            margin-left: auto;\n            margin-right: auto;\n            left: 0;\n            right: 0;\n            max-width: fit-content;\n            max-width: -moz-fit-content;\n        }\n",document.head.insertBefore(e,document.head.getElementsByTagName("style")[0])}}();var r,o=n({text:e,duration:3e3,gravity:"bottom",position:"right",stopOnFocus:!0},t);return i instanceof Element&&i!==document.body?(r=i.id)||(i.id=r="_croquetToastParent"):"string"==typeof i&&(r=i),r&&(o.selector=r),ce(o).showToast()}try{if((_e=window.localStorage)["croquet-debug-persist-allowed"]="true","true"!==_e["croquet-debug-persist-allowed"])throw Error("localStorage not persisted");delete _e["croquet-debug-persist-allowed"]}catch(Xs){console.warn("localStorage not allowed"),_e={}}var Be,Ae,qe={get pinned(){return"true"===_e[window.location.pathname+"/croquet-debug-ui-pinned"]},set pinned(e){_e[window.location.pathname+"/croquet-debug-ui-pinned"]=!!e},get activePage(){return _e[window.location.pathname+"/croquet-debug-ui-activePage"]},set activePage(e){_e[window.location.pathname+"/croquet-debug-ui-activePage"]=e}},$e=function(e){e.preventDefault(),e.stopPropagation()};function et(e,t,n){var i=document.createElement("canvas"),r=i.width=40*Ne/12,o=i.height=60,s=i.getContext("2d");s.font="36px Arial",s.textAlign="center",s.textBaseline="middle",s.fillStyle="black",s.fillText(e,r/2,.55*o);var a=document.createElement("button");a.id=t,a.className="croquet_dock_button";var c=function(e){e.preventDefault(),e.stopPropagation(),n()};return He?(a.ontouchstart=c,a.ontouchend=$e,a.onpointerdown=$e,a.onpointerup=$e):(a.onclick=c,a.onpointerdown=$e,a.onpointerup=$e),a.appendChild(i),a}function tt(e,t){if(!1!==ct.badge){var n=function(e){for(var t=new de(e),n=["bcdfghjklmnpqrstvwxyz","aeiou"],i="",r=0;r<5;r++)i+=n[r%2][t.quick()*n[r%2].length|0];return i}(t);for(document.title=document.title.replace(/:.*/,""),document.title+=":"+n;e.firstChild;)e.removeChild(e.firstChild);var i=document.createElement("canvas"),r=i.width=120,o=i.height=40;i.style.width="100%",e.appendChild(i);var s=i.getContext("2d"),a=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new de(e),i=[],r=0;r<t;r++)i.push("hsl(".concat(360*n.quick(),", 50%, 70%)"));return i}(t,2);s.fillStyle=a[0],s.beginPath(),s.moveTo(0,0),s.lineTo(0,o),s.lineTo(r,0),s.closePath(),s.fill(),s.fillStyle=a[1],s.beginPath(),s.moveTo(r,o),s.lineTo(r,0),s.lineTo(0,o),s.closePath(),s.fill(),s.font="30px Arial",s.textAlign="center",s.textBaseline="middle",s.fillStyle="black",s.fillText(n,r/2,o/2)}}function nt(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.firstChild;)e.removeChild(e.firstChild);return new he(e,n({text:t,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:he.CorrectLevel.L},i))}function it(){if(!1!==ct.root&&!1!==ct.qrcode&&!K.noqr){var e=ct.sessionURL;if(e){var t=st(ct.qrcode);if(t)He||(t.onclick=function(t){var n;t.preventDefault(),t.stopPropagation(),t.shiftKey?(n=document.getElementById("croquet_dock"))&&n.classList.toggle("debug"):window.open(e)}),nt(t,e).getCanvas().style.width="100%"}else console.warn("App.sessionURL is not set")}}var rt=0;function ot(){!function(){if(!Ee){Ee=!0;var e="\n        ".concat(Me?"body { min-height: 100vh }":"","\n        #croquet_spinnerOverlay {\n            z-index: 1000;\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color:#333;\n            opacity:0.9;\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            transition: opacity 1.0s ease-out;\n        }\n        /* https://github.com/lukehaas/css-loaders */\n        @keyframes croquet_dots {\n            0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em; }\n            40% { box-shadow: 0 2.5em 0 0; }\n        }\n        #croquet_loader,\n        #croquet_loader::before,\n        #croquet_loader::after {\n          border-radius: 50%;\n          width: 2.5em;\n          height: 2.5em;\n          animation: croquet_dots 1.8s infinite ease-in-out;\n        }\n        #croquet_loader {\n          color: #fff;\n          font-size: 10px;\n          margin: 80px auto;\n          position: relative;\n          text-indent: -9999em;\n          animation-delay: -0.16s;\n        }\n        #croquet_loader::before,\n        #croquet_loader::after {\n          content: '';\n          position: absolute;\n          top: 0;\n        }\n        #croquet_loader::before { left: -3.5em; animation-delay: -0.32s; }\n        #croquet_loader::after { left: 3.5em; }\n        #croquet_spinnerOverlay.croquet_error>*,\n        #croquet_spinnerOverlay.croquet_error>*::before,\n        #croquet_spinnerOverlay.croquet_error>*::after {\n            color: #f00;\n        }\n        #croquet_spinnerOverlay.croquet_fatal>*,\n        #croquet_spinnerOverlay.croquet_fatal>*::before,\n        #croquet_spinnerOverlay.croquet_fatal>*::after {\n            color: #f00;\n            box-shadow: 0 2.5em 0 0 !important;\n        }\n"),t=document.createElement("style");t.innerHTML=e,document.head.insertBefore(t,document.head.getElementsByTagName("style")[0])}}();var e=document.createElement("div");e.id="croquet_spinnerOverlay";var t=document.createElement("div");return t.id="croquet_loader",t.innerText="Catching up...",e.appendChild(t),e}function st(e,t){if(!1===e)return!1;if(e instanceof Element)return e;if("string"==typeof e){var n=document.getElementById(e);if(n)return n}return t?t():null}var at=new Set,ct={sessionURL:window.location.href,root:null,sync:!0,messages:!1,badge:!1,stats:!1,qrcode:!1,makeWidgetDock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!K.nodock){var t=e.debug||K.debug,n=document.getElementById("croquet_dock");n&&n.parentElement.removeChild(n);var i=st(ct.root,(function(){return document.body}));if(i){je();var r=document.createElement("div");r.id="croquet_dock",t&&r.classList.add("debug"),Me&&!e.iframe&&(r.style.display="none"),i.appendChild(r);var o,s=document.createElement("div");s.id="croquet_dock_bar",r.appendChild(s),!1!==e.badge&&((o=document.createElement("div")).id="croquet_badge",s.appendChild(o),ct.badge=o);var a=document.createElement("div");a.id="croquet_dock_content",r.appendChild(a);var c,l,u=[];if(!1!==e.qrcode){var d=ct.sessionURL;d&&((c=document.createElement("div")).id="croquet_qrcode",a.appendChild(c),u.push(c.id),ct.qrcode=c,t||(qe.activePage=c.id))}if(!1!==e.stats&&((l=document.createElement("div")).id="croquet_stats",a.appendChild(l),u.push(l.id),ct.stats=l),u.length){function h(e){var t,n=u.length,i=0;if(qe.activePage){var r=u.indexOf(qe.activePage);r>=0?(i=r,t=document.getElementById(qe.activePage)):qe.activePage=null}var o,s=u[(i+n+e)%n];s===qe.activePage?o=t:(t&&t.classList.remove("active"),o=document.getElementById(s)),o&&o.classList.add("active"),qe.activePage=s}u.length>1&&(s.appendChild(et("<","croquet_dock_left",(function(){return h(-1)}))),s.appendChild(et(">","croquet_dock_right",(function(){return h(1)})))),h(0)}if(!He&&!e.alwaysPinned){var f=et("📌","croquet_dock_pin",(function(){qe.pinned=!qe.pinned,m()})),m=function(){qe.pinned?f.classList.add("pinned"):f.classList.remove("pinned")};m(),s.appendChild(f)}var p=200,y=166,b=8,v=function(e){r.style.width="".concat(e,"px");var t=1.18*e;r.style.height="".concat(t,"px");var n=18*e/100;s.style.height="".concat(n,"px"),a.style.top="".concat(n+2,"px"),o&&(o.style.height="".concat(.9*n,"px"),o.style.width="".concat(.9*n*3,"px")),c&&(c.style.border="".concat(b*e/p,"px solid white"))},g=function(){r.style.width=r.style.height="",s.style.height="",a.style.top="",o&&(o.style.height=o.style.width=""),c&&(c.style.border="")},Z=e.fixedSize||p,w=function(){return r.classList.contains("active")},X=function(){r.classList.add("active"),v(Z),setTimeout((function(){return r.style.transition="none"}),300)},x=function(){r.style.transition="",r.classList.remove("active"),g()};if(He)x(),r.ontouchstart=function(e){e.preventDefault(),e.stopPropagation(),w()?x():X()},r.ontouchend=$e,r.onpointerdown=$e,r.onpointerup=$e;else if(e.alwaysPinned?X():(qe.pinned?X():x(),r.onmouseenter=X,r.onmouseleave=function(){qe.pinned||x()}),!e.fixedSize){var k=0;r.addEventListener("wheel",(function(e){e.stopPropagation();var t=Date.now();if(!(t-k<100)){k=t;var n=e.deltaY;n=Math.sign(n)*Math.min(5,Math.abs(n));var i=.8*Math.min(window.innerWidth,window.innerHeight);Z=Math.max(y,Math.min(i,r.offsetWidth/Math.pow(1.05,n))),v(Z)}}),{passive:!0})}}}},makeSessionWidgets:function(e){!function(e){if(e&&!1!==ct.root){var t=st(ct.badge);t&&tt(t,e)}}(e),it(),function(){if(!1!==ct.root&&!K.nostats){var e=st(ct.stats);e&&ke(e)}}()},makeQRCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ct.sessionURL)return null;var t=document.createElement("div"),n=nt(t,ct.sessionURL,e);return n&&n.getCanvas()},clearSessionMoniker:function(){!1!==ct.badge&&(document.title=document.title.replace(/:.*/,""))},showSyncWait:function(e){!1===ct.root?e=!1:Be||(Be=ot()),function(e){if(Ae!==e&&("string"!=typeof Ae||!0!==e))if(!1===ct.sync&&(e=!1),Ae=e,e)clearTimeout(rt),rt=setTimeout((function(){Ae&&(st(ct.root,(function(){return document.body})).appendChild(Be),Be.style.opacity=.9,Be.className="error"===Ae?"croquet_error":"fatal"===Ae?"croquet_fatal":"")}),500);else{if(!Be)return;clearTimeout(rt),Be.style.opacity=0,Be.className="",rt=setTimeout((function(){Ae||Be.parentElement&&Be.parentElement.removeChild(Be)}),500)}}(e)},messageFunction:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.level;return"error"===r?(t="orangered,red",console.error(e)):"warning"===r?(t="gold,orange",console.warn(e)):t="silver,gray",Oe(e,n({style:{background:"linear-gradient(90deg,".concat(t,")")}},i))},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("once"===t.only){if(at.has(e))return null;at.add(e)}return"fatal"===t.level&&(t.level="error",t.showSyncWait="fatal"),t.showSyncWait&&("fatal"!==t.showSyncWait||t.duration||(t.duration=-1),ct.showSyncWait(t.showSyncWait)),K.nomessages||!1===ct.root||!1===ct.messages||!ct.messageFunction?("warning"===t.level&&console.warn(e),"error"===t.level&&console.error(e),null):ct.messageFunction(e,t)},isCroquetHost:function(e){return e.endsWith("croquet.io")||["localhost","127.0.0.1","[::1]"].includes(e)||e.endsWith("ngrok.io")},referrerURL:function(){var e=new URL(ct.sessionURL),t=this.isCroquetHost(e.hostname);return"".concat(e.origin).concat(e.pathname).concat(t?e.search:"")},autoSession:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{key:"q"};"string"==typeof e&&(e={key:e}),e||(e={});var t=e.key||"q",n=new URL(window.location),i="",r=n.search.slice(1).split("&"),o=r.find((function(e){return e.split("=")[0]===t}));if(o?i=o.replace(/[^=]*=/,""):(i=r.find((function(e){return!e.includes("=")})))||(i=n.hash.slice(1))&&(n.hash="",n.search?n.searchParams.set(t,i):n.search=i),i)try{i=decodeURIComponent(i)}catch(e){}else i=Math.floor(Math.random()*Math.pow(36,10)).toString(36),n.searchParams.set(t,i);var s=n.toString("");window.location.href!==s&&(window.history.replaceState({},"",s),ct.sessionURL=s),K.has("debug","session")&&console.log('Croquet.App.autoSession: "'.concat(i,'"'));var a=Promise.resolve(i);return a[Symbol.toPrimitive]=function(){return console.warn("Deprecated: Croquet.App.autoSession() return value used directly. It returns a promise now!"),i},a},autoPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{key:"pw",scrub:!1,keyless:!1},t=e.key||"pw",n=e.scrub&&!K.has("debug","password"),i=e.keyless,r=new URL(window.location),o="",s=r.hash.slice(1);if(s){var a=s.split("&"),c=a.find((function(e){return e.split("=")[0]===t}));c?(o=c.replace(/[^=]*=/,""))&&n&&(r.hash=a.filter((function(e){return e.split("=")[0]!==t})).join("&")):i&&(o=a.find((function(e){return!e.includes("=")})))&&n&&(r.hash=a.filter((function(e){return e!==o})).join("&"))}if(!o){var l=new Uint8Array(16);window.crypto.getRandomValues(l),o=Q(l.buffer),r.hash=s?"".concat(s,"&").concat(t,"=").concat(o):i?o:"".concat(t,"=").concat(o),ct.sessionURL=r.href,n&&(r.hash=s)}if(K.has("debug","session")&&console.log("Croquet.App.sessionUrl: ".concat(ct.sessionURL)),window.location.href!==r.href&&window.history.replaceState({},"",r.href),o)try{o=decodeURIComponent(o)}catch(e){}K.has("debug","session")&&console.log('Croquet.App.autoPassword: "'.concat(o,'"'));var u=Promise.resolve(o);return u[Symbol.toPrimitive]=function(){return console.warn("Deprecated: Croquet.App.autoPassword() return value used directly. It returns a promise now!"),o},u}},lt="#__vote";function ut(e,t){function n(e){var n,i=W(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.for===t&&e.delete(r)}}catch(e){i.e(e)}finally{i.f()}}return n(e.immediate),n(e.oncePerFrame),n(e.oncePerFrameWhileSynced),n(e.queued),e.immediate.size+e.queued.size+e.oncePerFrame.size+e.oncePerFrameWhileSynced.size}var dt=new(function(){function e(){s(this,e),this.subscriptions={},this.queuedEvents=[],this.perFrameEvents=new Map,this.perSyncedFrameEvents=new Map,this.id=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})),this.lastId=0}return c(e,[{key:"register",value:function(e){return this.id+"/V"+ ++this.lastId}},{key:"deregister",value:function(e){}},{key:"addSubscription",value:function(e,t,n,i,r){if("vote"!==r){var o=e+":"+t,s=i;s.for=n;var a=this.subscriptions[o];if(a||(a=this.subscriptions[o]={immediate:new Set,queued:new Set,oncePerFrame:new Set,oncePerFrameWhileSynced:new Set}),!a[r])throw Error('Unknown subscribe() option: handling="'.concat(r,'"'));a[r].add(s)}else this.addSubscription(e,t+lt,n,i,"immediate")}},{key:"removeSubscription",value:function(e,t,n){var i=e+":"+t,r=this.subscriptions[i];r&&(0===ut(r,n)&&delete this.subscriptions[i]);t.endsWith(lt)||this.removeSubscription(e,t+lt,n)}},{key:"removeAllSubscriptionsFor",value:function(e){for(var t="".concat(e,":"),n=0,i=Object.entries(this.subscriptions);n<i.length;n++){var r=Z(i[n],2),o=r[0],s=r[1];if(o.startsWith(t))delete this.subscriptions[o];else 0===ut(s,e)&&delete this.subscriptions[o]}}},{key:"handleEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e()},i=this.subscriptions[e];i&&(i.queued.size>0&&this.queuedEvents.push({topic:e,data:t}),i.oncePerFrame.size>0&&this.perFrameEvents.set(e,t),i.oncePerFrameWhileSynced.size>0&&this.perSyncedFrameEvents.set(e,t),i.immediate.size>0&&n((function(){var n,r=W(i.immediate);try{for(r.s();!(n=r.n()).done;){var o=n.value;try{o(t)}catch(t){console.error(t),console.warn('Croquet: error "'.concat(t.message,'" in "immediate" subscription ').concat(e))}}}catch(e){r.e(e)}finally{r.f()}})))}},{key:"processFrameEvents",value:function(e,t){var n,i=this,r=0,o=function(e,t,n){var o=i.subscriptions[e];if(o){var s,a=W(o[n]);try{for(a.s();!(s=a.n()).done;){var c=s.value;try{c(t)}catch(t){console.error(t),console.warn('Croquet: error "'.concat(t.message,'" in "').concat(n,'" subscription ').concat(e))}r++}}catch(e){a.e(e)}finally{a.f()}}},s=W(this.queuedEvents);try{for(s.s();!(n=s.n()).done;){var a=n.value;o(a.topic,a.data,"queued")}}catch(e){s.e(e)}finally{s.f()}if(this.queuedEvents.length=0,e){var c,l=W(this.perFrameEvents);try{for(l.s();!(c=l.n()).done;){var u=Z(c.value,2);o(u[0],u[1],"oncePerFrame")}}catch(e){l.e(e)}finally{l.f()}if(this.perFrameEvents.clear(),t){var d,h=W(this.perSyncedFrameEvents);try{for(h.s();!(d=h.n()).done;){var f=Z(d.value,2);o(f[0],f[1],"oncePerFrameWhileSynced")}}catch(e){h.e(e)}finally{h.f()}this.perSyncedFrameEvents.clear()}var m,p=W(this.queuedEvents);try{for(p.s();!(m=p.n()).done;){var y=m.value;o(y.topic,y.data,"queued")}}catch(e){p.e(e)}finally{p.f()}this.queuedEvents.length=0}return r}}]),e}());var ht={get subscribe(){return(ht={subscribe:K.has("debug","subscribe",!1)}).subscribe}},ft=function(){function e(t){s(this,e),this.vm=t}return c(e,[{key:"register",value:function(e){return this.vm.registerModel(e)}},{key:"deregister",value:function(e){this.vm.deregisterModel(e.id)}},{key:"publish",value:function(e,t,n){this.vm.publishFromModel(n,e,t)}},{key:"subscribe",value:function(e,t,n,i){return ht.subscribe&&console.log('Model.subscribe("'.concat(t,":").concat(n,'", ').concat(e," ").concat((""+i).replace(/\([\s\S]*/,""),")")),this.vm.addSubscription(e,t,n,i)}},{key:"unsubscribe",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";ht.subscribe&&console.log("Model.unsubscribe(".concat(t,":").concat(n,'", ').concat(e," ").concat((""+i).replace(/\([\s\S]*/,""),")")),this.vm.removeSubscription(e,t,n,i)}},{key:"unsubscribeAll",value:function(e){ht.subscribe&&console.log("Model.unsubscribeAll(".concat(e," ").concat(e.id,")")),this.vm.removeAllSubscriptionsFor(e)}},{key:"future",value:function(e,t,n,i){if(pt&&pt.equal(this))return this.vm.future(e,t,n,i);if(t)throw Error("tOffset not supported from cross-realm future send yet.");var r=this.vm;return new Proxy(e,{get:function(t,n){if("function"==typeof e[n])return new Proxy(e[n],{apply:function(t,i,o){r.callModelMethod(e.id,n,o)}});throw Error("Tried to call "+n+"() on future of "+Object.getPrototypeOf(e).constructor.name+" which is not a function")}})}},{key:"random",value:function(){return this.vm.random()}},{key:"now",value:function(){return this.vm.time}},{key:"equal",value:function(t){return t instanceof e&&t.vm===this.vm}},{key:"isViewRealm",value:function(){return!1}}]),e}(),mt=function(){function e(t){s(this,e),this.vm=t}return c(e,[{key:"register",value:function(e){return dt.register(e)}},{key:"deregister",value:function(e){dt.deregister(e)}},{key:"publish",value:function(e,t,n){this.vm.publishFromView(n,e,t)}},{key:"subscribe",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"queued";ht.subscribe&&console.log('View.subscribe("'.concat(i,":").concat(e,'", ').concat(t," ").concat(n.name||(""+n).replace(/\([\s\S]*/,"")," [").concat(r,"])")),dt.addSubscription(i,e,t,n,r)}},{key:"unsubscribe",value:function(e,t,n,i){ht.subscribe&&console.log('View.unsubscribe("'.concat(i,":").concat(e,'", ').concat(t," ").concat(n.name||(""+n).replace(/\([\s\S]*/,""),")")),dt.removeSubscription(i,e,t,n)}},{key:"unsubscribeAll",value:function(e){ht.subscribe&&console.log("View.unsubscribeAll(".concat(e,")")),dt.removeAllSubscriptionsFor(e)}},{key:"future",value:function(e,t){var n=this.vm;return new Proxy(e,{get:function(i,r){if("function"==typeof e[r])return new Proxy(e[r],{apply:function(i,o,s){setTimeout((function(){e.id&&vt(n,(function(){return e[r].apply(e,X(s))}),!0)}),t)}});throw Error("Tried to call "+r+"() on future of "+Object.getPrototypeOf(e).constructor.name+" which is not a function")}})}},{key:"random",value:function(){return Math.random()}},{key:"now",value:function(){return this.vm.time}},{key:"externalNow",value:function(){return this.vm.controller.reflectorTime}},{key:"extrapolatedNow",value:function(){return this.vm.controller.extrapolatedTime}},{key:"isSynced",value:function(){return!!this.vm.controller.synced}},{key:"equal",value:function(t){return t instanceof e&&t.vm===this.vm}},{key:"isViewRealm",value:function(){return!0}}]),e}(),pt=null;function yt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Tried to execute code that requires realm outside of realm.";if(!pt&&e)throw Error(e);return pt}function bt(e,t){if(null!==pt)throw Error("Can't switch realms from inside realm");try{return pt=new ft(e),t()}finally{pt=null}}function vt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==pt&&!n)throw Error("Can't switch realms from inside realm");var i=pt;try{return pt=new mt(e),t()}finally{pt=i}}var gt=function(e){return e!=e},Zt=Math.sqrt,wt=.7853981633974483;var Xt=function(e){var t,n;return 0===e?.16666666666666713:((e<0?-e:e)<=1?(t=e*(19.562619833175948+e*(e*(5.444622390564711+e*(.004253011369004428*e-.6019598008014124))-16.262479672107002))-8.198089802484825,n=e*(139.51056146574857+e*(e*(70.49610280856842+e*(1*e-14.740913729888538))-147.1791292232726))-49.18853881490881):(t=.004253011369004428+(e=1/e)*(e*(5.444622390564711+e*(e*(19.562619833175948+-8.198089802484825*e)-16.262479672107002))-.6019598008014124),n=1+e*(e*(70.49610280856842+e*(e*(139.51056146574857+-49.18853881490881*e)-147.1791292232726))-14.740913729888538)),t/n)};var xt=function(e){var t,n;return 0===e?.08333333333333809:((e<0?-e:e)<=1?(t=28.536655482610616+e*(e*(6.968710824104713+e*(.002967721961301243*e-.5634242780008963))-25.56901049652825),n=342.43986579130785+e*(e*(147.0656354026815+e*(1*e-21.947795316429207))-383.8770957603691)):(t=.002967721961301243+(e=1/e)*(e*(6.968710824104713+e*(28.536655482610616*e-25.56901049652825))-.5634242780008963),n=1+e*(e*(147.0656354026815+e*(342.43986579130785*e-383.8770957603691))-21.947795316429207)),t/n)};var kt=function(e){var t,n,i,r,o;if(gt(e))return NaN;if(e>0?i=e:(t=!0,i=-e),i>1)return NaN;if(i>.625)r=(n=1-i)*xt(n),n=Zt(n+n),o=wt-n,o-=n=n*r-6123233995736766e-32,o+=wt;else{if(i<1e-8)return e;o=i*(o=(n=i*i)*Xt(n))+i}return t?-o:o};var Lt=function(e){var t;return gt(e)||e<-1||e>1?NaN:e>.5?2*kt(Zt(.5-.5*e)):(t=wt-kt(e),t+=6123233995736766e-32,t+=wt)};var Gt=function(){return"function"==typeof Symbol&&"symbol"===i(Symbol("foo"))}();var St=function(){return Gt&&"symbol"===i(Symbol.toStringTag)},Wt=Object.prototype.toString;var Yt=function(e){return Wt.call(e)},Ct=Object.prototype.hasOwnProperty;var Rt=function(e,t){return null!=e&&Ct.call(e,t)},Vt="function"==typeof Symbol?Symbol.toStringTag:"";var It=function(e){var t,n,i;if(null==e)return Wt.call(e);n=e[Vt],t=Rt(e,Vt);try{e[Vt]=void 0}catch(t){return Wt.call(e)}return i=Wt.call(e),t?e[Vt]=n:delete e[Vt],i},Tt=St()?It:Yt,Kt="function"==typeof Uint32Array;var Pt=function(e){return Kt&&e instanceof Uint32Array||"[object Uint32Array]"===Tt(e)},Ht=4294967295,Mt="function"==typeof Uint32Array?Uint32Array:null;var Nt="function"==typeof Uint32Array?Uint32Array:null;var Ft=function(){throw new Error("not implemented")},zt=function(){var e,t;if("function"!=typeof Mt)return!1;try{t=new Mt(t=[1,3.14,-3.14,Ht+1,Ht+2]),e=Pt(t)&&1===t[0]&&3===t[1]&&t[2]===Ht-2&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?Nt:Ft,jt="function"==typeof Float64Array;var Et=function(e){return jt&&e instanceof Float64Array||"[object Float64Array]"===Tt(e)},_t="function"==typeof Float64Array?Float64Array:null;var Jt="function"==typeof Float64Array?Float64Array:null;var Qt=function(){throw new Error("not implemented")},Ut=function(){var e,t;if("function"!=typeof _t)return!1;try{t=new _t([1,3.14,-3.14,NaN]),e=Et(t)&&1===t[0]&&3.14===t[1]&&-3.14===t[2]&&t[3]!=t[3]}catch(t){e=!1}return e}()?Jt:Qt,Dt="function"==typeof Uint8Array;var Ot=function(e){return Dt&&e instanceof Uint8Array||"[object Uint8Array]"===Tt(e)},Bt="function"==typeof Uint8Array?Uint8Array:null;var At="function"==typeof Uint8Array?Uint8Array:null;var qt=function(){throw new Error("not implemented")},$t=function(){var e,t;if("function"!=typeof Bt)return!1;try{t=new Bt(t=[1,3.14,-3.14,256,257]),e=Ot(t)&&1===t[0]&&3===t[1]&&253===t[2]&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?At:qt,en="function"==typeof Uint16Array;var tn=function(e){return en&&e instanceof Uint16Array||"[object Uint16Array]"===Tt(e)},nn="function"==typeof Uint16Array?Uint16Array:null;var rn="function"==typeof Uint16Array?Uint16Array:null;var on,sn=function(){throw new Error("not implemented")},an={uint16:function(){var e,t;if("function"!=typeof nn)return!1;try{t=new nn(t=[1,3.14,-3.14,65536,65537]),e=tn(t)&&1===t[0]&&3===t[1]&&65533===t[2]&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?rn:sn,uint8:$t};(on=new an.uint16(1))[0]=4660;var cn=52===new an.uint8(on.buffer)[0],ln=!0===cn?1:0,un=new Ut(1),dn=new zt(un.buffer);var hn=function(e){return un[0]=e,dn[ln]},fn=!0===cn?1:0,mn=new Ut(1),pn=new zt(mn.buffer);var yn=function(e,t){return mn[0]=e,pn[fn]=t>>>0,mn[0]},bn=Number.POSITIVE_INFINITY,vn=Number.NEGATIVE_INFINITY,gn=1023;var Zn=function(e){return 0===e?.6666666666666735:.6666666666666735+e*(.3999999999940942+e*(.2857142874366239+e*(.22222198432149784+e*(.1818357216161805+e*(.15313837699209373+.14798198605116586*e)))))},wn=.6931471803691238,Xn=1.9082149292705877e-10;var xn=function(e){var t,n,i,r,o,s,a,c,l,u;if(e<-1||gt(e))return NaN;if(-1===e)return vn;if(e===bn)return e;if(0===e)return e;if(u=1,(i=e<0?-e:e)<.41421356237309503){if(i<1.862645149230957e-9)return i<5551115123125783e-32?e:e-e*e*.5;e>-.2928932188134525&&(u=0,r=e,n=1)}return 0!==u&&(i<9007199254740992?(o=(u=((n=hn(l=1+e))>>20)-gn)>0?1-(l-e):e-(l-1),o/=l):(u=((n=hn(l=e))>>20)-gn,o=0),(n&=1048575)<434334?l=yn(l,1072693248|n):(u+=1,l=yn(l,1071644672|n),n=1048576-n>>2),r=l-1),t=.5*r*r,0===n?0===r?u*wn+(o+=u*Xn):u*wn-((c=t*(1-.6666666666666666*r))-(u*Xn+o)-r):(c=(a=(s=r/(2+r))*s)*Zn(a),0===u?r-(t-s*(t+c)):u*wn-(t-(s*(t+c)+(u*Xn+o))-r))},kn=.6931471805599453;var Ln=function(e){return 0===e?.3999999999940942:.3999999999940942+e*(.22222198432149784+.15313837699209373*e)};var Gn=function(e){return 0===e?.6666666666666735:.6666666666666735+e*(.2857142874366239+e*(.1818357216161805+.14798198605116586*e))},Sn=.6931471803691238,Wn=1.9082149292705877e-10,Yn=1048575;var Cn=function(e){var t,n,i,r,o,s,a,c,l,u,d;return 0===e?vn:gt(e)||e<0?NaN:(r=0,(n=hn(e))<1048576&&(r-=54,n=hn(e*=0x40000000000000)),n>=2146435072?e+e:(r+=(n>>20)-gn|0,r+=(a=(n&=Yn)+614244&1048576|0)>>20|0,s=(e=yn(e,n|1072693248^a))-1,(Yn&2+n)<3?0===s?0===r?0:r*Sn+r*Wn:(o=s*s*(.5-.3333333333333333*s),0===r?s-o:r*Sn-(o-r*Wn-s)):(a=n-398458|0,c=440401-n|0,i=(u=(d=(l=s/(2+s))*l)*d)*Ln(u),o=d*Gn(u)+i,(a|=c)>0?(t=.5*s*s,0===r?s-(t-l*(t+o)):r*Sn-(t-(l*(t+o)+r*Wn)-s)):0===r?s-l*(s-o):r*Sn-(l*(s-o)-r*Wn-s))))};var Rn=function(e){var t;return gt(e)||e<1?NaN:1===e?0:e>=268435456?Cn(e)+kn:e>2?Cn(2*e-1/(e+Zt(e*e-1))):xn((t=e-1)+Zt(2*t+t*t))};var Vn=function(e){return e===bn||e===vn};var In=function(e){var t,n,i;return gt(e)||Vn(e)?e:(e<0&&(e=-e,t=!0),i=e<3.725290298461914e-9?e:e>268435456?Cn(e)+kn:e>2?Cn(2*e+1/(Zt(e*e+1)+e)):xn(e+(n=e*e)/(1+Zt(1+n))),t?-i:i)},Tn=1.5707963267948966;var Kn=function(e){return 0===e?-64.85021904942025:e*(e*(e*(-.8750608600031904*e-16.157537187333652)-75.00855792314705)-122.88666844901361)-64.85021904942025};var Pn=function(e){return 0===e?194.5506571482614:194.5506571482614+e*(485.3903996359137+e*(432.88106049129027+e*(165.02700983169885+e*(24.858464901423062+1*e))))},Hn=6123233995736766e-32;var Mn=function(e){var t,n,i,r;return gt(e)||0===e?e:e===bn?Tn:e===vn?-Tn:(e<0&&(n=!0,e=-e),t=0,e>2.414213562373095?(i=Tn,t=1,e=-1/e):e<=.66?i=0:(i=wt,t=2,e=(e-1)/(e+1)),r=e*(r=(r=e*e)*Kn(r)/Pn(r))+e,2===t?r+=.5*Hn:1===t&&(r+=Hn),i+=r,n?-i:i)};var Nn,Fn,zn=function(e){var t,n;return gt(e)||e<-1||e>1?NaN:1===e?bn:-1===e?vn:(e<0&&(t=!0,e=-e),e<3.725290298461914e-9?t?-e:e:(n=e<.5?.5*xn((n=e+e)+n*e/(1-e)):.5*xn((e+e)/(1-e)),t?-n:n))};!0===cn?(Nn=1,Fn=0):(Nn=0,Fn=1);var jn={HIGH:Nn,LOW:Fn},En=new Ut(1),_n=new zt(En.buffer),Jn=jn.HIGH,Qn=jn.LOW;var Un=function(e,t){return En[0]=t,e[0]=_n[Jn],e[1]=_n[Qn],e};var Dn,On,Bn=function(e,t){return 1===arguments.length?Un([0,0],e):Un(e,t)};!0===cn?(Dn=1,On=0):(Dn=0,On=1);var An={HIGH:Dn,LOW:On},qn=new Ut(1),$n=new zt(qn.buffer),ei=An.HIGH,ti=An.LOW;var ni=function(e,t){return $n[ei]=e,$n[ti]=t,qn[0]},ii=[0,0];var ri=function(e,t){var n,i;return Bn(ii,e),n=ii[0],n&=2147483647,i=hn(t),ni(n|=i&=2147483648,ii[1])};var oi=function(e){return!!(hn(e)>>>31)},si=3.141592653589793;var ai=function(e,t){var n;return gt(t)||gt(e)?NaN:Vn(t)?t===bn?Vn(e)?ri(si/4,e):ri(0,e):Vn(e)?ri(3*si/4,e):ri(si,e):Vn(e)?ri(si/2,e):0===e?t>=0&&!oi(t)?ri(0,e):ri(si,e):0===t?ri(si/2,e):(n=Mn(e/t),t<0?n<=0?n+si:n-si:n)},ci=22250738585072014e-324;var li=function(e){return 0===e?1.87595182427177:1.87595182427177+e*(e*(1.6214297201053545+e*(.14599619288661245*e-.758397934778766))-1.8849797954337717)},ui=2147483647;var di=function(e){var t,n,i,r,o;return gt(e)||Vn(e)||0===e?e:(n=-2147483648&(i=hn(e)),i&=ui,o=0,e<ci?(o=0x40000000000000,t=hn(o*=e),o=ni(n|(t=(t&ui)/3+696219795),0)):o=yn(o,n|(t=i/3+715094163)),o*=li(r=o*o*(o/e)),t=hn(o),o=ni(t+1,0),o+=o*(r=((r=e/(o*o))-o)/(o+o+r)))};var hi=function(e){return 0===e?.0416666666666666:.0416666666666666+e*(2480158728947673e-20*e-.001388888888887411)};var fi=function(e){return 0===e?-2.7557314351390663e-7:e*(2.087572321298175e-9+-11359647557788195e-27*e)-2.7557314351390663e-7};var mi=function(e,t){var n,i,r,o;return r=(o=e*e)*o,i=o*hi(o),i+=r*r*fi(o),(r=1-(n=.5*o))+(1-r-n+(o*i-e*t))},pi=-.16666666666666632;var yi=function(e,t){var n,i,r;return n=.00833333333332249+(r=e*e)*(27557313707070068e-22*r-.0001984126982985795)+r*(r*r)*(1.58969099521155e-10*r-2.5050760253406863e-8),i=r*e,0===t?e+i*(pi+r*n):e-(r*(.5*t-i*n)-t-i*pi)},bi=!0===cn?0:1,vi=new Ut(1),gi=new zt(vi.buffer);var Zi=function(e){return vi[0]=e,gi[bi]},wi=Math.floor;var Xi=function(e){return e<0?-e:0===e?0:e};var xi=function(e,t){return gt(t)||Vn(t)?(e[0]=t,e[1]=0,e):0!==t&&Xi(t)<ci?(e[0]=4503599627370496*t,e[1]=-52,e):(e[0]=t,e[1]=0,e)};var ki=function(e,t){return 1===arguments.length?xi([0,0],e):xi(e,t)};var Li=function(e){var t=hn(e);return(t=(2146435072&t)>>>20)-gn|0},Gi=[0,0],Si=[0,0];var Wi=function(e,t){var n,i;return 0===e||gt(e)||Vn(e)?e:(ki(Gi,e),t+=Gi[1],(t+=Li(e=Gi[0]))<-1074?ri(0,e):t>1023?e<0?vn:bn:(t<=-1023?(t+=52,i=2220446049250313e-31):i=1,Bn(Si,e),n=Si[0],n&=2148532223,i*ni(n|=t+gn<<20,Si[1])))},Yi=[10680707,7228996,1387004,2578385,16069853,12639074,9804092,4427841,16666979,11263675,12935607,2387514,4345298,14681673,3074569,13734428,16653803,1880361,10960616,8533493,3062596,8710556,7349940,6258241,3772886,3769171,3798172,8675211,12450088,3874808,9961438,366607,15675153,9132554,7151469,3571407,2607881,12013382,4155038,6285869,7677882,13102053,15825725,473591,9065106,15363067,6271263,9264392,5636912,4652155,7056368,13614112,10155062,1944035,9527646,15080200,6658437,6231200,6832269,16767104,5075751,3212806,1398474,7579849,6349435,12618859],Ci=[1.570796251296997,7.549789415861596e-8,5390302529957765e-30,3282003415807913e-37,1270655753080676e-44,12293330898111133e-52,27337005381646456e-60,21674168387780482e-67],Ri=16777216,Vi=5.960464477539063e-8,Ii=Hi(new Array(20)),Ti=Hi(new Array(20)),Ki=Hi(new Array(20)),Pi=Hi(new Array(20));function Hi(e){var t,n=e.length;for(t=0;t<n;t++)e[t]=0;return e}function Mi(e,t,n,i,r,o,s,a,c){var l,u,d,h,f,m,p,y,b;for(h=o,b=i[n],y=n,f=0;y>0;f++)u=Vi*b|0,Pi[f]=b-Ri*u|0,b=i[y-1]+u,y-=1;if(b=Wi(b,r),b-=8*wi(.125*b),b-=p=0|b,d=0,r>0?(p+=f=Pi[n-1]>>24-r,Pi[n-1]-=f<<24-r,d=Pi[n-1]>>23-r):0===r?d=Pi[n-1]>>23:b>=.5&&(d=2),d>0){for(p+=1,l=0,f=0;f<n;f++)y=Pi[f],0===l?0!==y&&(l=1,Pi[f]=16777216-y):Pi[f]=16777215-y;if(r>0)switch(r){case 1:Pi[n-1]&=8388607;break;case 2:Pi[n-1]&=4194303}2===d&&(b=1-b,0!==l&&(b-=Wi(1,r)))}if(0===b){for(y=0,f=n-1;f>=o;f--)y|=Pi[f];if(0===y){for(m=1;0===Pi[o-m];m++);for(f=n+1;f<=n+m;f++){for(c[a+f]=Yi[s+f],u=0,y=0;y<=a;y++)u+=e[y]*c[a+(f-y)];i[f]=u}return Mi(e,t,n+=m,i,r,o,s,a,c)}}if(0===b)for(n-=1,r-=24;0===Pi[n];)n-=1,r-=24;else(b=Wi(b,-r))>=Ri?(u=Vi*b|0,Pi[n]=b-Ri*u|0,r+=24,Pi[n+=1]=u):Pi[n]=0|b;for(u=Wi(1,r),f=n;f>=0;f--)i[f]=u*Pi[f],u*=Vi;for(f=n;f>=0;f--){for(u=0,m=0;m<=h&&m<=n-f;m++)u+=Ci[m]*i[f+m];Ki[n-f]=u}for(u=0,f=n;f>=0;f--)u+=Ki[f];for(t[0]=0===d?u:-u,u=Ki[0]-u,f=1;f<=n;f++)u+=Ki[f];return t[1]=0===d?u:-u,7&p}var Ni=function(e,t,n,i){var r,o,s,a,c,l,u;for(4,(o=(n-3)/24|0)<0&&(o=0),a=n-24*(o+1),l=o-(s=i-1),u=s+4,c=0;c<=u;c++)Ii[c]=l<0?0:Yi[l],l+=1;for(c=0;c<=4;c++){for(r=0,l=0;l<=s;l++)r+=e[l]*Ii[s+(c-l)];Ti[c]=r}return 4,Mi(e,t,4,Ti,a,4,o,s,Ii)},Fi=Math.round;var zi=function(e,t,n){var i,r,o,s,a;return o=e-1.5707963267341256*(i=Fi(.6366197723675814*e)),s=6077100506506192e-26*i,a=t>>20|0,n[0]=o-s,a-(hn(n[0])>>20&2047)>16&&(s=20222662487959506e-37*i-((r=o)-(o=r-(s=6077100506303966e-26*i))-s),n[0]=o-s,a-(hn(n[0])>>20&2047)>49&&(s=84784276603689e-45*i-((r=o)-(o=r-(s=20222662487111665e-37*i))-s),n[0]=o-s)),n[1]=o-n[0]-s,i},ji=1.5707963267341256,Ei=6077100506506192e-26,_i=2*Ei,Ji=3*Ei,Qi=4*Ei,Ui=new Array(3),Di=new Array(2);var Oi=function(e,t){var n,i,r,o,s,a,c;if((r=2147483647&hn(e)|0)<=1072243195)return t[0]=e,t[1]=0,0;if(r<=1074752122)return 598523==(1048575&r)?zi(e,r,t):r<=1073928572?e>0?(c=e-ji,t[0]=c-Ei,t[1]=c-t[0]-Ei,1):(c=e+ji,t[0]=c+Ei,t[1]=c-t[0]+Ei,-1):e>0?(c=e-2*ji,t[0]=c-_i,t[1]=c-t[0]-_i,2):(c=e+2*ji,t[0]=c+_i,t[1]=c-t[0]+_i,-2);if(r<=1075594811)return r<=1075183036?1074977148===r?zi(e,r,t):e>0?(c=e-3*ji,t[0]=c-Ji,t[1]=c-t[0]-Ji,3):(c=e+3*ji,t[0]=c+Ji,t[1]=c-t[0]+Ji,-3):1075388923===r?zi(e,r,t):e>0?(c=e-4*ji,t[0]=c-Qi,t[1]=c-t[0]-Qi,4):(c=e+4*ji,t[0]=c+Qi,t[1]=c-t[0]+Qi,-4);if(r<1094263291)return zi(e,r,t);if(r>=2146435072)return t[0]=NaN,t[1]=NaN,0;for(n=Zi(e),c=ni(r-((i=(r>>20)-1046)<<20|0),n),s=0;s<2;s++)Ui[s]=0|c,c=16777216*(c-Ui[s]);for(Ui[2]=c,o=3;0===Ui[o-1];)o-=1;return a=Ni(Ui,Di,i,o),e<0?(t[0]=-Di[0],t[1]=-Di[1],-a):(t[0]=Di[0],t[1]=Di[1],a)},Bi=[0,0];var Ai=function(e){var t;if(t=hn(e),(t&=2147483647)<=1072243195)return t<1044381696?1:mi(e,0);if(t>=2146435072)return NaN;switch(3&Oi(e,Bi)){case 0:return mi(Bi[0],Bi[1]);case 1:return-yi(Bi[0],Bi[1]);case 2:return-mi(Bi[0],Bi[1]);default:return yi(Bi[0],Bi[1])}},qi=Math.ceil;var $i=function(e){return e<0?qi(e):wi(e)};var er=function(e){return 0===e?.16666666666666602:.16666666666666602+e*(e*(6613756321437934e-20+e*(4.1381367970572385e-8*e-16533902205465252e-22))-.0027777777777015593)};var tr=function(e,t,n){var i,r,o;return o=(i=e-t)-(r=i*i)*er(r),Wi(1-(t-i*o/(2-o)-e),n)},nr=1.4426950408889634,ir=1/(1<<28);var rr=function(e){var t;return gt(e)||e===bn?e:e===vn?0:e>709.782712893384?bn:e<-745.1332191019411?0:e>-3.725290298461914e-9&&e<ir?1+e:(t=$i(e<0?nr*e-.5:nr*e+.5),tr(e-.6931471803691238*t,1.9082149292705877e-10*t,t))};var or=function(e){return gt(e)?e:(e<0&&(e=-e),e>21?rr(e)/2:(rr(e)+rr(-e))/2)};var sr=function(e){return 0===e?-.03333333333333313:e*(.0015873015872548146+e*(e*(4008217827329362e-21+-2.0109921818362437e-7*e)-793650757867488e-19))-.03333333333333313},ar=.6931471803691238,cr=1.9082149292705877e-10,lr=1.4426950408889634;var ur=function(e){var t,n,i,r,o,s,a,c,l,u,d,h;if(e===bn||gt(e))return e;if(e===vn)return-1;if(0===e)return e;if(e<0?(n=!0,a=-e):(n=!1,a=e),a>=38.816242111356935){if(n)return-1;if(a>=709.782712893384)return bn}if(o=0|hn(a),a>.34657359027997264)a<1.0397207708399179?n?(i=e+ar,r=-cr,h=-1):(i=e-ar,r=cr,h=1):(h=n?lr*e-.5:lr*e+.5,i=e-(u=h|=0)*ar,r=u*cr),l=i-(e=i-r)-r;else{if(o<1016070144)return e;h=0}return d=(c=e*(t=.5*e))*(((s=1+c*sr(c))-(u=3-s*t))/(6-e*u)),0===h?e-(e*d-c):(d=e*(d-l)-l,d-=c,-1===h?.5*(e-d)-.5:1===h?e<-.25?-2*(d-(e+.5)):1+2*(e-d):h<=-2||h>56?(i=hn(a=1-(d-e))+(h<<20)|0,(a=yn(a,i))-1):(u=1,h<20?a=(u=yn(u,i=1072693248-(2097152>>h)|0))-(d-e):(a=e-(d+(u=yn(u,i=gn-h<<20|0))),a+=1),i=hn(a)+(h<<20)|0,yn(a,i)))},dr=!0===cn?0:1,hr=new Ut(1),fr=new zt(hr.buffer);var mr=function(e,t){return hr[0]=e,fr[dr]=t>>>0,hr[0]};var pr=function(e){return 0===e?.3999999999940942:.3999999999940942+e*(.22222198432149784+.15313837699209373*e)};var yr=function(e){return 0===e?.6666666666666735:.6666666666666735+e*(.2857142874366239+e*(.1818357216161805+.14798198605116586*e))},br=1048575;var vr=function(e){var t,n,i,r,o,s,a,c,l,u;return i=hn(e),r=e-1,(br&2+i)<3?0===r?0:r*r*(.3333333333333333*r-.5):(l=(i&=br)-398458|0,u=440401-i|0,n=(c=(s=(o=r/(2+r))*o)*s)*pr(c),a=s*yr(c)+n,(l|=u)>0?o*((t=.5*r*r)+a)-t:o*(a-r))},gr=.4342944818781689;var Zr=function(e){var t,n,i,r,o,s,a;return gt(e)||e<0?NaN:0===e?vn:(o=0,(n=hn(e))<1048576&&(o-=54,n=hn(e*=0x40000000000000)),n>=2146435072?e+e:(o+=(n>>20)-gn|0,e=yn(e,(n&=1048575)|1072693248^(r=n+614244&1048576|0)),s=o+=r>>20|0,i=vr(e),a=3694239077158931e-28*s+25082946711645275e-27*((e-=1)+i),(a+=(e-(t=mr(e,0))+i)*gr+t*gr)+.30102999566361177*s))};var wr=function(e){return 0===e?.3999999999940942:.3999999999940942+e*(.22222198432149784+.15313837699209373*e)};var Xr=function(e){return 0===e?.6666666666666735:.6666666666666735+e*(.2857142874366239+e*(.1818357216161805+.14798198605116586*e))},xr=1048575;var kr=function(e){var t,n,i,r,o,s,a,c,l,u;return i=hn(e),r=e-1,(xr&2+i)<3?0===r?0:r*r*(.3333333333333333*r-.5):(l=(i&=xr)-398458|0,u=440401-i|0,n=(c=(s=(o=r/(2+r))*o)*s)*wr(c),a=s*Xr(c)+n,(l|=u)>0?o*((t=.5*r*r)+a)-t:o*(a-r))},Lr=1.4426950407214463,Gr=[0,0];var Sr=function(e){var t,n,i,r,o;if(gt(e)||e<0)return NaN;if(Bn(Gr,e),o=0,(n=Gr[0])<1048576){if(0==(2147483647&n|Gr[1]))return vn;o-=54,n=hn(e*=0x40000000000000)}return n>=2146435072?e+e:(o+=(n>>20)-gn|0,e=yn(e,(n&=1048575)|1072693248^(r=n+614244&1048576|0)),o+=r>>20|0,i=kr(e),1.6751713164886512e-10*((e-=1)+i)+(e-(t=mr(e,0))+i)*Lr+t*Lr+o)},Wr=[0,0];var Yr=function(e){var t;if(t=hn(e),(t&=2147483647)<=1072243195)return t<1045430272?e:yi(e,0);if(t>=2146435072)return NaN;switch(3&Oi(e,Wr)){case 0:return yi(Wr[0],Wr[1]);case 1:return mi(Wr[0],Wr[1]);case 2:return-yi(Wr[0],Wr[1]);default:return-mi(Wr[0],Wr[1])}};var Cr=function(e){var t,n;return 0===e?.16666666666666666:((e<0?-e:e)<=1?(t=e*(e*(-.789474443963537*e-163.72585752598383)-11561.443576500522)-351754.9648081514,n=e*(36157.827983443196+e*(1*e-277.7110814206028))-2110529.7888489086):(t=(e=1/e)*(e*(-351754.9648081514*e-11561.443576500522)-163.72585752598383)-.789474443963537,n=1+e*(e*(36157.827983443196+-2110529.7888489086*e)-277.7110814206028)),t/n)};var Rr=function(e){var t;return 0===e?e:(t=Xi(e),e>710.4758600739439||e<-709.089565712824?e>0?bn:vn:t>1?t>=709.0895657128241?(t=rr(.5*t),t*=.5*t,e<0&&(t=-t),t):(t=.5*(t=rr(t))-.5/t,e<0&&(t=-t),t):e+e*(t*=t)*Cr(t))};var Vr=function(e){return 0===e?.13333333333320124:.13333333333320124+e*(.021869488294859542+e*(.0035920791075913124+e*(.0005880412408202641+e*(7817944429395571e-20+-18558637485527546e-21*e))))};var Ir=function(e){return 0===e?.05396825397622605:.05396825397622605+e*(.0088632398235993+e*(.0014562094543252903+e*(.0002464631348184699+e*(7140724913826082e-20+2590730518636337e-20*e))))};var Tr=function(e,t,n){var i,r,o,s,a,c,l,u,d;return(r=2147483647&(i=hn(e))|0)>=1072010280&&(e<0&&(e=-e,t=-t),e=(d=.7853981633974483-e)+(u=3061616997868383e-32-t),t=0),s=t+(d=e*e)*((a=d*e)*((s=Vr(u=d*d))+(l=d*Ir(u)))+t),u=e+(s+=.3333333333333341*a),r>=1072010280?(1-(i>>30&2))*((l=n)-2*(e-(u*u/(u+l)-s))):1===n?u:(mr(d=u,0),l=s-(d-e),mr(c=o=-1/u,0),c+o*((a=1+c*d)+c*l))},Kr=[0,0];var Pr=function(e){var t,n;return t=hn(e),(t&=2147483647)<=1072243195?t<1044381696?e:Tr(e,0,1):t>=2146435072?NaN:(n=Oi(e,Kr),Tr(Kr[0],Kr[1],1-((1&n)<<1)))};var Hr=function(e){var t,n;return 0===e?-.3333333333333332:((e<0?-e:e)<=1?(t=e*(e*(0*e-.9643991794250523)-99.28772310019185)-1614.6876844170845,n=4844.063053251255+e*(2235.4883906010045+e*(112.81167849163293+1*e))):(t=0+(e=1/e)*(e*(-1614.6876844170845*e-99.28772310019185)-.9643991794250523),n=1+e*(112.81167849163293+e*(2235.4883906010045+4844.063053251255*e))),t/n)};var Mr=function(e){var t,n;if((n=Xi(e))>44.014845965556525)return e<0?-1:1;if(n>=.625)n=1-2/((t=rr(2*n))+1),e<0&&(n=-n);else{if(0===e)return e;n=e+e*(t=e*e)*Hr(t)}return n};void 0===window.CroquetMath&&(window.CroquetMath={}),Object.assign(window.CroquetMath,{acos:Lt,acosh:Rn,asin:kt,asinh:In,atan:Mn,atanh:zn,atan2:ai,cbrt:di,cos:Ai,cosh:or,exp:rr,expm1:ur,log:Cn,log1p:xn,log10:Zr,log2:Sr,sin:Yr,sinh:Rr,tan:Pr,tanh:Mr});var Nr=Math.pow;function Fr(e){return e===1/0||e===-1/0}window.CroquetMath.pow=function(e,t){if(isNaN(e)||isNaN(t))return NaN;if(Fr(e)||Fr(t))return Nr(e,t);if(0===e||0===t)return Nr(e,t);if(e<0&&!function(e){return Number.isInteger(e)}(t))return NaN;if(1===t)return e;if(2===t)return e*e;if(3===t)return e*e*e;if(4===t)return e*e*e*e;var n=1;return e<0&&(e*=-1,n=Nr(-1,t)),window.CroquetMath.exp(window.CroquetMath.log(e)*t)*n};var zr=function(e,t){return e<t};function jr(e){if(!(this instanceof jr))return new jr(e);this.array=[],this.size=0,this.compare=e||zr}jr.prototype.clone=function(){var e=new jr(this.compare);return e.size=this.size,e.array=this.array.slice(0,this.size),e},jr.prototype.add=function(e){var t,n,i=this.size;for(this.array[this.size]=e,this.size+=1;i>0&&(t=i-1>>1,n=this.array[t],this.compare(e,n));)this.array[i]=n,i=t;this.array[i]=e},jr.prototype.heapify=function(e){var t;for(this.array=e,this.size=e.length,t=this.size>>1;t>=0;t--)this._percolateDown(t)},jr.prototype._percolateUp=function(e,t){for(var n,i,r=this.array[e];e>0&&(n=e-1>>1,i=this.array[n],t||this.compare(r,i));)this.array[e]=i,e=n;this.array[e]=r},jr.prototype._percolateDown=function(e){for(var t,n,i,r=this.size,o=this.size>>>1,s=this.array[e];e<o&&(n=(t=1+(e<<1))+1,i=this.array[t],n<r&&this.compare(this.array[n],i)&&(t=n,i=this.array[n]),this.compare(i,s));)this.array[e]=i,e=t;this.array[e]=s},jr.prototype._removeAt=function(e){if(!(e>this.size-1||e<0))return this._percolateUp(e,!0),this.poll()},jr.prototype.remove=function(e){for(var t=0;t<this.size;t++)if(!this.compare(this.array[t],e)&&!this.compare(e,this.array[t]))return this._removeAt(t),!0;return!1},jr.prototype.removeOne=function(e){if("function"==typeof e)for(var t=0;t<this.size;t++)if(e(this.array[t]))return this._removeAt(t)},jr.prototype.removeMany=function(e,t){if("function"!=typeof e||this.size<1)return[];t=t?Math.min(t,this.size):this.size;for(var n=0,i=new Array(t),r=0,o=new Array(this.size);n<t&&!this.isEmpty();){var s=this.poll();e(s)?i[n++]=s:o[r++]=s}i.length=n;for(var a=0;a<r;)this.add(o[a++]);return i},jr.prototype.peek=function(){if(0!=this.size)return this.array[0]},jr.prototype.poll=function(){if(0!=this.size){var e=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,e}},jr.prototype.replaceTop=function(e){if(0!=this.size){var t=this.array[0];return this.array[0]=e,this._percolateDown(0),t}},jr.prototype.trim=function(){this.array=this.array.slice(0,this.size)},jr.prototype.isEmpty=function(){return 0===this.size},jr.prototype.forEach=function(e){if(!this.isEmpty()&&"function"==typeof e)for(var t=0,n=this.clone();!n.isEmpty();)e(n.poll(),t++)},jr.prototype.kSmallest=function(e){if(0==this.size)return[];e=Math.min(this.size,e);var t=new jr(this.compare),n=Math.min((e>0?Math.pow(2,e-1):0)+1,this.size);t.size=n,t.array=this.array.slice(0,n);for(var i=new Array(e),r=0;r<e;r++)i[r]=t.poll();return i};var Er=function(e){u(n,e);var t=v(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"poll",value:function(){var e=g(d(n.prototype),"poll",this).call(this);return this.array[this.size]=null,e}},{key:"asArray",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"asUnsortedArray",value:function(){return this.array.slice(0,this.size)}}]),n}(jr),_r={exports:{}};!function(e,t){e.exports=function(e){return function(){var t=e,n=t.lib.WordArray;function i(e,t,i){for(var r=[],o=0,s=0;s<t;s++)if(s%4){var a=i[e.charCodeAt(s-1)]<<s%4*2|i[e.charCodeAt(s)]>>>6-s%4*2;r[o>>>2]|=a<<24-o%4*8,o++}return n.create(r,o)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)r.push(i.charAt(s>>>6*(3-a)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return i(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(M.exports)}(_r);var Jr=_r.exports,Qr={exports:{}};!function(e,t){e.exports=function(e){return e.enc.Utf8}(M.exports)}(Qr);var Ur=Qr.exports,Dr={exports:{}},Or={exports:{}};!function(e,t){e.exports=function(e){return function(){var t=e,n=t.lib,i=n.WordArray,r=n.Hasher,o=t.algo,s=[],a=o.SHA1=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],c=n[4],l=0;l<80;l++){if(l<16)s[l]=0|e[t+l];else{var u=s[l-3]^s[l-8]^s[l-14]^s[l-16];s[l]=u<<1|u>>>31}var d=(i<<5|i>>>27)+c+s[l];d+=l<20?1518500249+(r&o|~r&a):l<40?1859775393+(r^o^a):l<60?(r&o|r&a|o&a)-1894007588:(r^o^a)-899497514,c=a,a=o,o=r<<30|r>>>2,r=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=r._createHelper(a),t.HmacSHA1=r._createHmacHelper(a)}(),e.SHA1}(M.exports)}(Or);var Br={exports:{}};!function(e,t){e.exports=function(e){!function(){var t=e,n=t.lib.Base,i=t.enc.Utf8;t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,l=0;l<n;l++)a[l]^=1549556828,c[l]^=909522486;o.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}()}(M.exports)}(Br),function(e,t){e.exports=function(e){return function(){var t=e,n=t.lib,i=n.Base,r=n.WordArray,o=t.algo,s=o.SHA1,a=o.HMAC,c=o.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=a.create(n.hasher,e),o=r.create(),s=r.create([1]),c=o.words,l=s.words,u=n.keySize,d=n.iterations;c.length<u;){var h=i.update(t).finalize(s);i.reset();for(var f=h.words,m=f.length,p=h,y=1;y<d;y++){p=i.finalize(p),i.reset();for(var b=p.words,v=0;v<m;v++)f[v]^=b[v]}o.concat(h),l[0]++}return o.sigBytes=4*u,o}});t.PBKDF2=function(e,t,n){return c.create(n).compute(e,t)}}(),e.PBKDF2}(M.exports)}(Dr);var Ar=Dr.exports,qr={exports:{}},$r={exports:{}};!function(e,t){e.exports=function(e){return function(t){var n=e,i=n.lib,r=i.WordArray,o=i.Hasher,s=n.algo,a=[];!function(){for(var e=0;e<64;e++)a[e]=4294967296*t.abs(t.sin(e+1))|0}();var c=s.MD5=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],f=e[t+2],m=e[t+3],p=e[t+4],y=e[t+5],b=e[t+6],v=e[t+7],g=e[t+8],Z=e[t+9],w=e[t+10],X=e[t+11],x=e[t+12],k=e[t+13],L=e[t+14],G=e[t+15],S=o[0],W=o[1],Y=o[2],C=o[3];S=l(S,W,Y,C,s,7,a[0]),C=l(C,S,W,Y,c,12,a[1]),Y=l(Y,C,S,W,f,17,a[2]),W=l(W,Y,C,S,m,22,a[3]),S=l(S,W,Y,C,p,7,a[4]),C=l(C,S,W,Y,y,12,a[5]),Y=l(Y,C,S,W,b,17,a[6]),W=l(W,Y,C,S,v,22,a[7]),S=l(S,W,Y,C,g,7,a[8]),C=l(C,S,W,Y,Z,12,a[9]),Y=l(Y,C,S,W,w,17,a[10]),W=l(W,Y,C,S,X,22,a[11]),S=l(S,W,Y,C,x,7,a[12]),C=l(C,S,W,Y,k,12,a[13]),Y=l(Y,C,S,W,L,17,a[14]),S=u(S,W=l(W,Y,C,S,G,22,a[15]),Y,C,c,5,a[16]),C=u(C,S,W,Y,b,9,a[17]),Y=u(Y,C,S,W,X,14,a[18]),W=u(W,Y,C,S,s,20,a[19]),S=u(S,W,Y,C,y,5,a[20]),C=u(C,S,W,Y,w,9,a[21]),Y=u(Y,C,S,W,G,14,a[22]),W=u(W,Y,C,S,p,20,a[23]),S=u(S,W,Y,C,Z,5,a[24]),C=u(C,S,W,Y,L,9,a[25]),Y=u(Y,C,S,W,m,14,a[26]),W=u(W,Y,C,S,g,20,a[27]),S=u(S,W,Y,C,k,5,a[28]),C=u(C,S,W,Y,f,9,a[29]),Y=u(Y,C,S,W,v,14,a[30]),S=d(S,W=u(W,Y,C,S,x,20,a[31]),Y,C,y,4,a[32]),C=d(C,S,W,Y,g,11,a[33]),Y=d(Y,C,S,W,X,16,a[34]),W=d(W,Y,C,S,L,23,a[35]),S=d(S,W,Y,C,c,4,a[36]),C=d(C,S,W,Y,p,11,a[37]),Y=d(Y,C,S,W,v,16,a[38]),W=d(W,Y,C,S,w,23,a[39]),S=d(S,W,Y,C,k,4,a[40]),C=d(C,S,W,Y,s,11,a[41]),Y=d(Y,C,S,W,m,16,a[42]),W=d(W,Y,C,S,b,23,a[43]),S=d(S,W,Y,C,Z,4,a[44]),C=d(C,S,W,Y,x,11,a[45]),Y=d(Y,C,S,W,G,16,a[46]),S=h(S,W=d(W,Y,C,S,f,23,a[47]),Y,C,s,6,a[48]),C=h(C,S,W,Y,v,10,a[49]),Y=h(Y,C,S,W,L,15,a[50]),W=h(W,Y,C,S,y,21,a[51]),S=h(S,W,Y,C,x,6,a[52]),C=h(C,S,W,Y,m,10,a[53]),Y=h(Y,C,S,W,w,15,a[54]),W=h(W,Y,C,S,c,21,a[55]),S=h(S,W,Y,C,g,6,a[56]),C=h(C,S,W,Y,G,10,a[57]),Y=h(Y,C,S,W,b,15,a[58]),W=h(W,Y,C,S,k,21,a[59]),S=h(S,W,Y,C,p,6,a[60]),C=h(C,S,W,Y,X,10,a[61]),Y=h(Y,C,S,W,f,15,a[62]),W=h(W,Y,C,S,Z,21,a[63]),o[0]=o[0]+S|0,o[1]=o[1]+W|0,o[2]=o[2]+Y|0,o[3]=o[3]+C|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var o=t.floor(i/4294967296),s=i;n[15+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,c=a.words,l=0;l<4;l++){var u=c[l];c[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function l(e,t,n,i,r,o,s){var a=e+(t&n|~t&i)+r+s;return(a<<o|a>>>32-o)+t}function u(e,t,n,i,r,o,s){var a=e+(t&i|n&~i)+r+s;return(a<<o|a>>>32-o)+t}function d(e,t,n,i,r,o,s){var a=e+(t^n^i)+r+s;return(a<<o|a>>>32-o)+t}function h(e,t,n,i,r,o,s){var a=e+(n^(t|~i))+r+s;return(a<<o|a>>>32-o)+t}n.MD5=o._createHelper(c),n.HmacMD5=o._createHmacHelper(c)}(Math),e.MD5}(M.exports)}($r);var eo={exports:{}};!function(e,t){e.exports=function(e){return function(){var t=e,n=t.lib,i=n.Base,r=n.WordArray,o=t.algo,s=o.MD5,a=o.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,i=this.cfg,o=i.hasher.create(),s=r.create(),a=s.words,c=i.keySize,l=i.iterations;a.length<c;){n&&o.update(n),n=o.update(e).finalize(t),o.reset();for(var u=1;u<l;u++)n=o.finalize(n),o.reset();s.concat(n)}return s.sigBytes=4*c,s}});t.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)}}(),e.EvpKDF}(M.exports)}(eo);var to={exports:{}};!function(e,t){e.exports=function(e){e.lib.Cipher||function(t){var n=e,i=n.lib,r=i.Base,o=i.WordArray,s=i.BufferedBlockAlgorithm,a=n.enc;a.Utf8;var c=a.Base64,l=n.algo.EvpKDF,u=i.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?g:b}return function(t){return{encrypt:function(n,i,r){return e(i).encrypt(t,n,i,r)},decrypt:function(n,i,r){return e(i).decrypt(t,n,i,r)}}}}()});i.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=n.mode={},h=i.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=d.CBC=function(){var e=h.extend();function n(e,n,i){var r,o=this._iv;o?(r=o,this._iv=t):r=this._prevBlock;for(var s=0;s<i;s++)e[n+s]^=r[s]}return e.Encryptor=e.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize;n.call(this,e,t,r),i.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),e.Decryptor=e.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize,o=e.slice(t,t+r);i.decryptBlock(e,t),n.call(this,e,t,r),this._prevBlock=o}}),e}(),m=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,i=n-e.sigBytes%n,r=i<<24|i<<16|i<<8|i,s=[],a=0;a<i;a+=4)s.push(r);var c=o.create(s,i);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};i.BlockCipher=u.extend({cfg:u.cfg.extend({mode:f,padding:m}),reset:function(){var e;u.reset.call(this);var t=this.cfg,n=t.iv,i=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=i.createEncryptor:(e=i.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(i,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var p=i.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?o.create([1398893684,1701076831]).concat(n).concat(t):t).toString(c)},parse:function(e){var t,n=c.parse(e),i=n.words;return 1398893684==i[0]&&1701076831==i[1]&&(t=o.create(i.slice(2,4)),i.splice(0,4),n.sigBytes-=16),p.create({ciphertext:n,salt:t})}},b=i.SerializableCipher=r.extend({cfg:r.extend({format:y}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var r=e.createEncryptor(n,i),o=r.finalize(t),s=r.cfg;return p.create({ciphertext:o,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),v=(n.kdf={}).OpenSSL={execute:function(e,t,n,i){i||(i=o.random(8));var r=l.create({keySize:t+n}).compute(e,i),s=o.create(r.words.slice(t),4*n);return r.sigBytes=4*t,p.create({key:r,iv:s,salt:i})}},g=i.PasswordBasedCipher=b.extend({cfg:b.cfg.extend({kdf:v}),encrypt:function(e,t,n,i){var r=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize);i.iv=r.iv;var o=b.encrypt.call(this,e,t,r.key,i);return o.mixIn(r),o},decrypt:function(e,t,n,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var r=i.kdf.execute(n,e.keySize,e.ivSize,t.salt);return i.iv=r.iv,b.decrypt.call(this,e,t,r.key,i)}})}()}(M.exports)}(to),function(e,t){e.exports=function(e){return function(){var t=e,n=t.lib.BlockCipher,i=t.algo,r=[],o=[],s=[],a=[],c=[],l=[],u=[],d=[],h=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,i=0;for(t=0;t<256;t++){var m=i^i<<1^i<<2^i<<3^i<<4;m=m>>>8^255&m^99,r[n]=m,o[m]=n;var p=e[n],y=e[p],b=e[y],v=257*e[m]^16843008*m;s[n]=v<<24|v>>>8,a[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,l[n]=v,v=16843009*b^65537*y^257*p^16843008*n,u[m]=v<<24|v>>>8,d[m]=v<<16|v>>>16,h[m]=v<<8|v>>>24,f[m]=v,n?(n=p^e[e[e[b^p]]],i^=e[e[i]]):n=i=1}}();var m=[0,1,2,4,8,16,32,64,128,27,54],p=i.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,i=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],s=0;s<i;s++)s<n?o[s]=t[s]:(l=o[s-1],s%n?n>6&&s%n==4&&(l=r[l>>>24]<<24|r[l>>>16&255]<<16|r[l>>>8&255]<<8|r[255&l]):(l=r[(l=l<<8|l>>>24)>>>24]<<24|r[l>>>16&255]<<16|r[l>>>8&255]<<8|r[255&l],l^=m[s/n|0]<<24),o[s]=o[s-n]^l);for(var a=this._invKeySchedule=[],c=0;c<i;c++){if(s=i-c,c%4)var l=o[s];else l=o[s-4];a[c]=c<4||s<=4?l:u[r[l>>>24]]^d[r[l>>>16&255]]^h[r[l>>>8&255]]^f[r[255&l]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,l,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,d,h,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,r,o,s,a){for(var c=this._nRounds,l=e[t]^n[0],u=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],f=4,m=1;m<c;m++){var p=i[l>>>24]^r[u>>>16&255]^o[d>>>8&255]^s[255&h]^n[f++],y=i[u>>>24]^r[d>>>16&255]^o[h>>>8&255]^s[255&l]^n[f++],b=i[d>>>24]^r[h>>>16&255]^o[l>>>8&255]^s[255&u]^n[f++],v=i[h>>>24]^r[l>>>16&255]^o[u>>>8&255]^s[255&d]^n[f++];l=p,u=y,d=b,h=v}p=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^n[f++],y=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^n[f++],b=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^n[f++],v=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^n[f++],e[t]=p,e[t+1]=y,e[t+2]=b,e[t+3]=v},keySize:8});t.AES=n._createHelper(p)}(),e.AES}(M.exports)}(qr);var no=qr.exports,io={exports:{}};!function(e,t){e.exports=function(e){return e.HmacSHA256}(M.exports)}(io);var ro=io.exports;function oo(e){for(var t=e.length;--t>=0;)e[t]=0}var so=256,ao=286,co=30,lo=15,uo=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ho=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),fo=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),mo=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),po=new Array(576);oo(po);var yo=new Array(60);oo(yo);var bo=new Array(512);oo(bo);var vo=new Array(256);oo(vo);var go=new Array(29);oo(go);var Zo,wo,Xo,xo=new Array(co);function ko(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function Lo(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}oo(xo);var Go=function(e){return e<256?bo[e]:bo[256+(e>>>7)]},So=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Wo=function(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,So(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Yo=function(e,t,n){Wo(e,n[2*t],n[2*t+1])},Co=function(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Ro=function(e,t,n){var i,r,o=new Array(16),s=0;for(i=1;i<=lo;i++)o[i]=s=s+n[i-1]<<1;for(r=0;r<=t;r++){var a=e[2*r+1];0!==a&&(e[2*r]=Co(o[a]++,a))}},Vo=function(e){var t;for(t=0;t<ao;t++)e.dyn_ltree[2*t]=0;for(t=0;t<co;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Io=function(e){e.bi_valid>8?So(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},To=function(e,t,n,i){var r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]},Ko=function(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&To(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!To(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},Po=function(e,t,n){var i,r,o,s,a=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],r=e.pending_buf[e.l_buf+a],a++,0===i?Yo(e,r,t):(o=vo[r],Yo(e,o+so+1,t),0!==(s=uo[o])&&(r-=go[o],Wo(e,r,s)),i--,o=Go(i),Yo(e,o,n),0!==(s=ho[o])&&(i-=xo[o],Wo(e,i,s)))}while(a<e.last_lit);Yo(e,256,t)},Ho=function(e,t){var n,i,r,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(r=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[r]=0,e.opt_len--,a&&(e.static_len-=s[2*r+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)Ko(e,o,n);r=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ko(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,o[2*r]=o[2*n]+o[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,o[2*n+1]=o[2*i+1]=r,e.heap[1]=r++,Ko(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,o,s,a,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,p=0;for(o=0;o<=lo;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=c[2*c[2*(i=e.heap[n])+1]+1]+1)>m&&(o=m,p++),c[2*i+1]=o,i>l||(e.bl_count[o]++,s=0,i>=f&&(s=h[i-f]),a=c[2*i],e.opt_len+=a*(o+s),d&&(e.static_len+=a*(u[2*i+1]+s)));if(0!==p){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,p-=2}while(p>0);for(o=m;0!==o;o--)for(i=e.bl_count[o];0!==i;)(r=e.heap[--n])>l||(c[2*r+1]!==o&&(e.opt_len+=(o-c[2*r+1])*c[2*r],c[2*r+1]=o),i--)}}(e,t),Ro(o,l,e.bl_count)},Mo=function(e,t,n){var i,r,o=-1,s=t[1],a=0,c=7,l=4;for(0===s&&(c=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=t[2*(i+1)+1],++a<c&&r===s||(a<l?e.bl_tree[2*r]+=a:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=r,0===s?(c=138,l=3):r===s?(c=6,l=3):(c=7,l=4))},No=function(e,t,n){var i,r,o=-1,s=t[1],a=0,c=7,l=4;for(0===s&&(c=138,l=3),i=0;i<=n;i++)if(r=s,s=t[2*(i+1)+1],!(++a<c&&r===s)){if(a<l)do{Yo(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==o&&(Yo(e,r,e.bl_tree),a--),Yo(e,16,e.bl_tree),Wo(e,a-3,2)):a<=10?(Yo(e,17,e.bl_tree),Wo(e,a-3,3)):(Yo(e,18,e.bl_tree),Wo(e,a-11,7));a=0,o=r,0===s?(c=138,l=3):r===s?(c=6,l=3):(c=7,l=4)}},Fo=!1,zo=function(e,t,n,i){Wo(e,0+(i?1:0),3),function(e,t,n,i){Io(e),i&&(So(e,n),So(e,~n)),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n}(e,t,n,!0)},jo={_tr_init:function(e){Fo||(!function(){var e,t,n,i,r,o=new Array(16);for(n=0,i=0;i<28;i++)for(go[i]=n,e=0;e<1<<uo[i];e++)vo[n++]=i;for(vo[n-1]=i,r=0,i=0;i<16;i++)for(xo[i]=r,e=0;e<1<<ho[i];e++)bo[r++]=i;for(r>>=7;i<co;i++)for(xo[i]=r<<7,e=0;e<1<<ho[i]-7;e++)bo[256+r++]=i;for(t=0;t<=lo;t++)o[t]=0;for(e=0;e<=143;)po[2*e+1]=8,e++,o[8]++;for(;e<=255;)po[2*e+1]=9,e++,o[9]++;for(;e<=279;)po[2*e+1]=7,e++,o[7]++;for(;e<=287;)po[2*e+1]=8,e++,o[8]++;for(Ro(po,287,o),e=0;e<co;e++)yo[2*e+1]=5,yo[2*e]=Co(e,5);Zo=new ko(po,uo,257,ao,lo),wo=new ko(yo,ho,0,co,lo),Xo=new ko(new Array(0),fo,0,19,7)}(),Fo=!0),e.l_desc=new Lo(e.dyn_ltree,Zo),e.d_desc=new Lo(e.dyn_dtree,wo),e.bl_desc=new Lo(e.bl_tree,Xo),e.bi_buf=0,e.bi_valid=0,Vo(e)},_tr_stored_block:zo,_tr_flush_block:function(e,t,n,i){var r,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<so;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Ho(e,e.l_desc),Ho(e,e.d_desc),s=function(e){var t;for(Mo(e,e.dyn_ltree,e.l_desc.max_code),Mo(e,e.dyn_dtree,e.d_desc.max_code),Ho(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*mo[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!==t?zo(e,t,n,i):4===e.strategy||o===r?(Wo(e,2+(i?1:0),3),Po(e,po,yo)):(Wo(e,4+(i?1:0),3),function(e,t,n,i){var r;for(Wo(e,t-257,5),Wo(e,n-1,5),Wo(e,i-4,4),r=0;r<i;r++)Wo(e,e.bl_tree[2*mo[r]+1],3);No(e,e.dyn_ltree,t-1),No(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Po(e,e.dyn_ltree,e.dyn_dtree)),Vo(e),i&&Io(e)},_tr_tally:function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(vo[n]+so+1)]++,e.dyn_dtree[2*Go(t)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){Wo(e,2,3),Yo(e,256,po),function(e){16===e.bi_valid?(So(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},Eo=function(e,t,n,i){for(var r=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(r=r+t[i++]|0)|0}while(--s);r%=65521,o%=65521}return r|o<<16|0},_o=new Uint32Array(function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}()),Jo=function(e,t,n,i){var r=_o,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},Qo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Uo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Do=jo._tr_init,Oo=jo._tr_stored_block,Bo=jo._tr_flush_block,Ao=jo._tr_tally,qo=jo._tr_align,$o=Uo.Z_NO_FLUSH,es=Uo.Z_PARTIAL_FLUSH,ts=Uo.Z_FULL_FLUSH,ns=Uo.Z_FINISH,is=Uo.Z_BLOCK,rs=Uo.Z_OK,os=Uo.Z_STREAM_END,ss=Uo.Z_STREAM_ERROR,as=Uo.Z_DATA_ERROR,cs=Uo.Z_BUF_ERROR,ls=Uo.Z_DEFAULT_COMPRESSION,us=Uo.Z_FILTERED,ds=Uo.Z_HUFFMAN_ONLY,hs=Uo.Z_RLE,fs=Uo.Z_FIXED,ms=Uo.Z_DEFAULT_STRATEGY,ps=Uo.Z_UNKNOWN,ys=Uo.Z_DEFLATED,bs=258,vs=262,gs=103,Zs=113,ws=666,Xs=function(e,t){return e.msg=Qo[t],t},xs=function(e){return(e<<1)-(e>4?9:0)},ks=function(e){for(var t=e.length;--t>=0;)e[t]=0},Ls=function(e,t,n){return(t<<e.hash_shift^n)&e.hash_mask},Gs=function(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Ss=function(e,t){Bo(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Gs(e.strm)},Ws=function(e,t){e.pending_buf[e.pending++]=t},Ys=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Cs=function(e,t){var n,i,r=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,c=e.strstart>e.w_size-vs?e.strstart-(e.w_size-vs):0,l=e.window,u=e.w_mask,d=e.prev,h=e.strstart+bs,f=l[o+s-1],m=l[o+s];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(l[(n=t)+s]===m&&l[n+s-1]===f&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<h);if(i=bs-(h-o),o=h-bs,i>s){if(e.match_start=t,s=i,i>=a)break;f=l[o+s-1],m=l[o+s]}}}while((t=d[t&u])>c&&0!=--r);return s<=e.lookahead?s:e.lookahead},Rs=function(e){var t,n,i,r,o,s,a,c,l,u,d=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-vs)){e.window.set(e.window.subarray(d,d+d),0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=d?i-d:0}while(--n);t=n=d;do{i=e.prev[--t],e.prev[t]=i>=d?i-d:0}while(--n);r+=d}if(0===e.strm.avail_in)break;if(s=e.strm,a=e.window,c=e.strstart+e.lookahead,l=r,u=void 0,(u=s.avail_in)>l&&(u=l),n=0===u?0:(s.avail_in-=u,a.set(s.input.subarray(s.next_in,s.next_in+u),c),1===s.state.wrap?s.adler=Eo(s.adler,a,u,c):2===s.state.wrap&&(s.adler=Jo(s.adler,a,u,c)),s.next_in+=u,s.total_in+=u,u),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Ls(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Ls(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<vs&&0!==e.strm.avail_in)},Vs=function(e,t){for(var n,i;;){if(e.lookahead<vs){if(Rs(e),e.lookahead<vs&&t===$o)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ls(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-vs&&(e.match_length=Cs(e,n)),e.match_length>=3)if(i=Ao(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ls(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ls(e,e.ins_h,e.window[e.strstart+1]);else i=Ao(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Ss(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ns?(Ss(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ss(e,!1),0===e.strm.avail_out)?1:2},Is=function(e,t){for(var n,i,r;;){if(e.lookahead<vs){if(Rs(e),e.lookahead<vs&&t===$o)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ls(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-vs&&(e.match_length=Cs(e,n),e.match_length<=5&&(e.strategy===us||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=Ao(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=Ls(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Ss(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=Ao(e,0,e.window[e.strstart-1]))&&Ss(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Ao(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ns?(Ss(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ss(e,!1),0===e.strm.avail_out)?1:2};function Ts(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}var Ks=[new Ts(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Rs(e),0===e.lookahead&&t===$o)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,Ss(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-vs&&(Ss(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ns?(Ss(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(Ss(e,!1),e.strm.avail_out),1)})),new Ts(4,4,8,4,Vs),new Ts(4,5,16,8,Vs),new Ts(4,6,32,32,Vs),new Ts(4,4,16,16,Is),new Ts(8,16,32,32,Is),new Ts(8,16,128,128,Is),new Ts(8,32,128,256,Is),new Ts(32,128,258,1024,Is),new Ts(32,258,258,4096,Is)];function Ps(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ys,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),ks(this.dyn_ltree),ks(this.dyn_dtree),ks(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),ks(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),ks(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Hs=function(e){if(!e||!e.state)return Xs(e,ss);e.total_in=e.total_out=0,e.data_type=ps;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:Zs,e.adler=2===t.wrap?0:1,t.last_flush=$o,Do(t),rs},Ms=function(e){var t,n=Hs(e);return n===rs&&((t=e.state).window_size=2*t.w_size,ks(t.head),t.max_lazy_match=Ks[t.level].max_lazy,t.good_match=Ks[t.level].good_length,t.nice_match=Ks[t.level].nice_length,t.max_chain_length=Ks[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n},Ns=function(e,t,n,i,r,o){if(!e)return ss;var s=1;if(t===ls&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||n!==ys||i<8||i>15||t<0||t>9||o<0||o>fs)return Xs(e,ss);8===i&&(i=9);var a=new Ps;return e.state=a,a.strm=e,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=n,Ms(e)},Fs={deflateInit:function(e,t){return Ns(e,t,ys,15,8,ms)},deflateInit2:Ns,deflateReset:Ms,deflateResetKeep:Hs,deflateSetHeader:function(e,t){return e&&e.state?2!==e.state.wrap?ss:(e.state.gzhead=t,rs):ss},deflate:function(e,t){var n,i;if(!e||!e.state||t>is||t<0)return e?Xs(e,ss):ss;var r=e.state;if(!e.output||!e.input&&0!==e.avail_in||r.status===ws&&t!==ns)return Xs(e,0===e.avail_out?cs:ss);r.strm=e;var o=r.last_flush;if(r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,Ws(r,31),Ws(r,139),Ws(r,8),r.gzhead?(Ws(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ws(r,255&r.gzhead.time),Ws(r,r.gzhead.time>>8&255),Ws(r,r.gzhead.time>>16&255),Ws(r,r.gzhead.time>>24&255),Ws(r,9===r.level?2:r.strategy>=ds||r.level<2?4:0),Ws(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Ws(r,255&r.gzhead.extra.length),Ws(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Jo(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Ws(r,0),Ws(r,0),Ws(r,0),Ws(r,0),Ws(r,0),Ws(r,9===r.level?2:r.strategy>=ds||r.level<2?4:0),Ws(r,3),r.status=Zs);else{var s=ys+(r.w_bits-8<<4)<<8;s|=(r.strategy>=ds||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=Zs,Ys(r,s),0!==r.strstart&&(Ys(r,e.adler>>>16),Ys(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>n&&(e.adler=Jo(e.adler,r.pending_buf,r.pending-n,n)),Gs(e),n=r.pending,r.pending!==r.pending_buf_size));)Ws(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=Jo(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=Jo(e.adler,r.pending_buf,r.pending-n,n)),Gs(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Ws(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>n&&(e.adler=Jo(e.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=Jo(e.adler,r.pending_buf,r.pending-n,n)),Gs(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Ws(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>n&&(e.adler=Jo(e.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.status=gs)}else r.status=gs;if(r.status===gs&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Gs(e),r.pending+2<=r.pending_buf_size&&(Ws(r,255&e.adler),Ws(r,e.adler>>8&255),e.adler=0,r.status=Zs)):r.status=Zs),0!==r.pending){if(Gs(e),0===e.avail_out)return r.last_flush=-1,rs}else if(0===e.avail_in&&xs(t)<=xs(o)&&t!==ns)return Xs(e,cs);if(r.status===ws&&0!==e.avail_in)return Xs(e,cs);if(0!==e.avail_in||0!==r.lookahead||t!==$o&&r.status!==ws){var a=r.strategy===ds?function(e,t){for(var n;;){if(0===e.lookahead&&(Rs(e),0===e.lookahead)){if(t===$o)return 1;break}if(e.match_length=0,n=Ao(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ss(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ns?(Ss(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ss(e,!1),0===e.strm.avail_out)?1:2}(r,t):r.strategy===hs?function(e,t){for(var n,i,r,o,s=e.window;;){if(e.lookahead<=bs){if(Rs(e),e.lookahead<=bs&&t===$o)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=s[r=e.strstart-1])===s[++r]&&i===s[++r]&&i===s[++r]){o=e.strstart+bs;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);e.match_length=bs-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Ao(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Ao(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ss(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ns?(Ss(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ss(e,!1),0===e.strm.avail_out)?1:2}(r,t):Ks[r.level].func(r,t);if(3!==a&&4!==a||(r.status=ws),1===a||3===a)return 0===e.avail_out&&(r.last_flush=-1),rs;if(2===a&&(t===es?qo(r):t!==is&&(Oo(r,0,0,!1),t===ts&&(ks(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Gs(e),0===e.avail_out))return r.last_flush=-1,rs}return t!==ns?rs:r.wrap<=0?os:(2===r.wrap?(Ws(r,255&e.adler),Ws(r,e.adler>>8&255),Ws(r,e.adler>>16&255),Ws(r,e.adler>>24&255),Ws(r,255&e.total_in),Ws(r,e.total_in>>8&255),Ws(r,e.total_in>>16&255),Ws(r,e.total_in>>24&255)):(Ys(r,e.adler>>>16),Ys(r,65535&e.adler)),Gs(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?rs:os)},deflateEnd:function(e){if(!e||!e.state)return ss;var t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==gs&&t!==Zs&&t!==ws?Xs(e,ss):(e.state=null,t===Zs?Xs(e,as):rs)},deflateSetDictionary:function(e,t){var n=t.length;if(!e||!e.state)return ss;var i=e.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return ss;if(1===r&&(e.adler=Eo(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(ks(i.head),i.strstart=0,i.block_start=0,i.insert=0);var o=new Uint8Array(i.w_size);o.set(t.subarray(n-i.w_size,n),0),t=o,n=i.w_size}var s=e.avail_in,a=e.next_in,c=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Rs(i);i.lookahead>=3;){var l=i.strstart,u=i.lookahead-2;do{i.ins_h=Ls(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++}while(--u);i.strstart=l,i.lookahead=2,Rs(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=a,e.input=c,e.avail_in=s,i.wrap=r,rs},deflateInfo:"pako deflate (from Nodeca project)"},zs=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},js=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!==i(n))throw new TypeError(n+"must be non-object");for(var r in n)zs(n,r)&&(e[r]=n[r])}}return e},Es=function(e){for(var t=0,n=0,i=e.length;n<i;n++)t+=e[n].length;for(var r=new Uint8Array(t),o=0,s=0,a=e.length;o<a;o++){var c=e[o];r.set(c,s),s+=c.length}return r},_s=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){_s=!1}for(var Js=new Uint8Array(256),Qs=0;Qs<256;Qs++)Js[Qs]=Qs>=252?6:Qs>=248?5:Qs>=240?4:Qs>=224?3:Qs>=192?2:1;Js[254]=Js[254]=1;var Us=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,n,i,r,o,s=e.length,a=0;for(r=0;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},Ds=function(e,t){var n,i,r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var o=new Array(2*r);for(i=0,n=0;n<r;){var s=e[n++];if(s<128)o[i++]=s;else{var a=Js[s];if(a>4)o[i++]=65533,n+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&n<r;)s=s<<6|63&e[n++],a--;a>1?o[i++]=65533:s<65536?o[i++]=s:(s-=65536,o[i++]=55296|s>>10&1023,o[i++]=56320|1023&s)}}}return function(e,t){if(t<65534&&e.subarray&&_s)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}(o,i)},Os=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Js[e[n]]>t?n:t};var Bs=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},As=Object.prototype.toString,qs=Uo.Z_NO_FLUSH,$s=Uo.Z_SYNC_FLUSH,ea=Uo.Z_FULL_FLUSH,ta=Uo.Z_FINISH,na=Uo.Z_OK,ia=Uo.Z_STREAM_END,ra=Uo.Z_DEFAULT_COMPRESSION,oa=Uo.Z_DEFAULT_STRATEGY,sa=Uo.Z_DEFLATED;function aa(e){this.options=js({level:ra,method:sa,chunkSize:16384,windowBits:15,memLevel:8,strategy:oa},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bs,this.strm.avail_out=0;var n=Fs.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==na)throw new Error(Qo[n]);if(t.header&&Fs.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?Us(t.dictionary):"[object ArrayBuffer]"===As.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=Fs.deflateSetDictionary(this.strm,i))!==na)throw new Error(Qo[n]);this._dict_set=!0}}function ca(e,t){var n=new aa(t);if(n.push(e,!0),n.err)throw n.msg||Qo[n.err];return n.result}aa.prototype.push=function(e,t){var n,i,r=this.strm,o=this.options.chunkSize;if(this.ended)return!1;for(i=t===~~t?t:!0===t?ta:qs,"string"==typeof e?r.input=Us(e):"[object ArrayBuffer]"===As.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),(i===$s||i===ea)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if((n=Fs.deflate(r,i))===ia)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=Fs.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===na;if(0!==r.avail_out){if(i>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},aa.prototype.onData=function(e){this.chunks.push(e)},aa.prototype.onEnd=function(e){e===na&&(this.result=Es(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var la={Deflate:aa,deflate:ca,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ca(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ca(e,t)},constants:Uo},ua=function(e,t){var n,i,r,o,s,a,c,l,u,d,h,f,m,p,y,b,v,g,Z,w,X,x,k,L,G=e.state;n=e.next_in,k=e.input,i=n+(e.avail_in-5),r=e.next_out,L=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),a=G.dmax,c=G.wsize,l=G.whave,u=G.wnext,d=G.window,h=G.hold,f=G.bits,m=G.lencode,p=G.distcode,y=(1<<G.lenbits)-1,b=(1<<G.distbits)-1;e:do{f<15&&(h+=k[n++]<<f,f+=8,h+=k[n++]<<f,f+=8),v=m[h&y];t:for(;;){if(h>>>=g=v>>>24,f-=g,0===(g=v>>>16&255))L[r++]=65535&v;else{if(!(16&g)){if(0==(64&g)){v=m[(65535&v)+(h&(1<<g)-1)];continue t}if(32&g){G.mode=12;break e}e.msg="invalid literal/length code",G.mode=30;break e}Z=65535&v,(g&=15)&&(f<g&&(h+=k[n++]<<f,f+=8),Z+=h&(1<<g)-1,h>>>=g,f-=g),f<15&&(h+=k[n++]<<f,f+=8,h+=k[n++]<<f,f+=8),v=p[h&b];n:for(;;){if(h>>>=g=v>>>24,f-=g,!(16&(g=v>>>16&255))){if(0==(64&g)){v=p[(65535&v)+(h&(1<<g)-1)];continue n}e.msg="invalid distance code",G.mode=30;break e}if(w=65535&v,f<(g&=15)&&(h+=k[n++]<<f,(f+=8)<g&&(h+=k[n++]<<f,f+=8)),(w+=h&(1<<g)-1)>a){e.msg="invalid distance too far back",G.mode=30;break e}if(h>>>=g,f-=g,w>(g=r-o)){if((g=w-g)>l&&G.sane){e.msg="invalid distance too far back",G.mode=30;break e}if(X=0,x=d,0===u){if(X+=c-g,g<Z){Z-=g;do{L[r++]=d[X++]}while(--g);X=r-w,x=L}}else if(u<g){if(X+=c+u-g,(g-=u)<Z){Z-=g;do{L[r++]=d[X++]}while(--g);if(X=0,u<Z){Z-=g=u;do{L[r++]=d[X++]}while(--g);X=r-w,x=L}}}else if(X+=u-g,g<Z){Z-=g;do{L[r++]=d[X++]}while(--g);X=r-w,x=L}for(;Z>2;)L[r++]=x[X++],L[r++]=x[X++],L[r++]=x[X++],Z-=3;Z&&(L[r++]=x[X++],Z>1&&(L[r++]=x[X++]))}else{X=r-w;do{L[r++]=L[X++],L[r++]=L[X++],L[r++]=L[X++],Z-=3}while(Z>2);Z&&(L[r++]=L[X++],Z>1&&(L[r++]=L[X++]))}break}}break}}while(n<i&&r<s);n-=Z=f>>3,h&=(1<<(f-=Z<<3))-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<s?s-r+257:257-(r-s),G.hold=h,G.bits=f},da=15,ha=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),fa=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ma=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),pa=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ya=function(e,t,n,i,r,o,s,a){var c,l,u,d,h,f,m,p,y,b=a.bits,v=0,g=0,Z=0,w=0,X=0,x=0,k=0,L=0,G=0,S=0,W=null,Y=0,C=new Uint16Array(16),R=new Uint16Array(16),V=null,I=0;for(v=0;v<=da;v++)C[v]=0;for(g=0;g<i;g++)C[t[n+g]]++;for(X=b,w=da;w>=1&&0===C[w];w--);if(X>w&&(X=w),0===w)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(Z=1;Z<w&&0===C[Z];Z++);for(X<Z&&(X=Z),L=1,v=1;v<=da;v++)if(L<<=1,(L-=C[v])<0)return-1;if(L>0&&(0===e||1!==w))return-1;for(R[1]=0,v=1;v<da;v++)R[v+1]=R[v]+C[v];for(g=0;g<i;g++)0!==t[n+g]&&(s[R[t[n+g]]++]=g);if(0===e?(W=V=s,f=19):1===e?(W=ha,Y-=257,V=fa,I-=257,f=256):(W=ma,V=pa,f=-1),S=0,g=0,v=Z,h=o,x=X,k=0,u=-1,d=(G=1<<X)-1,1===e&&G>852||2===e&&G>592)return 1;for(;;){m=v-k,s[g]<f?(p=0,y=s[g]):s[g]>f?(p=V[I+s[g]],y=W[Y+s[g]]):(p=96,y=0),c=1<<v-k,Z=l=1<<x;do{r[h+(S>>k)+(l-=c)]=m<<24|p<<16|y|0}while(0!==l);for(c=1<<v-1;S&c;)c>>=1;if(0!==c?(S&=c-1,S+=c):S=0,g++,0==--C[v]){if(v===w)break;v=t[n+s[g]]}if(v>X&&(S&d)!==u){for(0===k&&(k=X),h+=Z,L=1<<(x=v-k);x+k<w&&!((L-=C[x+k])<=0);)x++,L<<=1;if(G+=1<<x,1===e&&G>852||2===e&&G>592)return 1;r[u=S&d]=X<<24|x<<16|h-o|0}}return 0!==S&&(r[h+S]=v-k<<24|64<<16|0),a.bits=X,0},ba=Uo.Z_FINISH,va=Uo.Z_BLOCK,ga=Uo.Z_TREES,Za=Uo.Z_OK,wa=Uo.Z_STREAM_END,Xa=Uo.Z_NEED_DICT,xa=Uo.Z_STREAM_ERROR,ka=Uo.Z_DATA_ERROR,La=Uo.Z_MEM_ERROR,Ga=Uo.Z_BUF_ERROR,Sa=Uo.Z_DEFLATED,Wa=12,Ya=30,Ca=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function Ra(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Va,Ia,Ta=function(e){if(!e||!e.state)return xa;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Za},Ka=function(e){if(!e||!e.state)return xa;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ta(e)},Pa=function(e,t){var n;if(!e||!e.state)return xa;var i=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?xa:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,Ka(e))},Ha=function(e,t){if(!e)return xa;var n=new Ra;e.state=n,n.window=null;var i=Pa(e,t);return i!==Za&&(e.state=null),i},Ma=!0,Na=function(e){if(Ma){Va=new Int32Array(512),Ia=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ya(1,e.lens,0,288,Va,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ya(2,e.lens,0,32,Ia,0,e.work,{bits:5}),Ma=!1}e.lencode=Va,e.lenbits=9,e.distcode=Ia,e.distbits=5},Fa=function(e,t,n,i){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):((r=o.wsize-o.wnext)>i&&(r=i),o.window.set(t.subarray(n-i,n-i+r),o.wnext),(i-=r)?(o.window.set(t.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0},za={inflateReset:Ka,inflateReset2:Pa,inflateResetKeep:Ta,inflateInit:function(e){return Ha(e,15)},inflateInit2:Ha,inflate:function(e,t){var n,i,r,o,s,a,c,l,u,d,h,f,m,p,y,b,v,g,Z,w,X,x,k,L,G=0,S=new Uint8Array(4),W=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return xa;(n=e.state).mode===Wa&&(n.mode=13),s=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,l=n.hold,u=n.bits,d=a,h=c,x=Za;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(2&n.wrap&&35615===l){n.check=0,S[0]=255&l,S[1]=l>>>8&255,n.check=Jo(n.check,S,2,0),l=0,u=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=Ya;break}if((15&l)!==Sa){e.msg="unknown compression method",n.mode=Ya;break}if(u-=4,X=8+(15&(l>>>=4)),0===n.wbits)n.wbits=X;else if(X>n.wbits){e.msg="invalid window size",n.mode=Ya;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&l?10:Wa,l=0,u=0;break;case 2:for(;u<16;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(n.flags=l,(255&n.flags)!==Sa){e.msg="unknown compression method",n.mode=Ya;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Ya;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&(S[0]=255&l,S[1]=l>>>8&255,n.check=Jo(n.check,S,2,0)),l=0,u=0,n.mode=3;case 3:for(;u<32;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}n.head&&(n.head.time=l),512&n.flags&&(S[0]=255&l,S[1]=l>>>8&255,S[2]=l>>>16&255,S[3]=l>>>24&255,n.check=Jo(n.check,S,4,0)),l=0,u=0,n.mode=4;case 4:for(;u<16;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&(S[0]=255&l,S[1]=l>>>8&255,n.check=Jo(n.check,S,2,0)),l=0,u=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&(S[0]=255&l,S[1]=l>>>8&255,n.check=Jo(n.check,S,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((f=n.length)>a&&(f=a),f&&(n.head&&(X=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(o,o+f),X)),512&n.flags&&(n.check=Jo(n.check,i,f,o)),a-=f,o+=f,n.length-=f),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===a)break e;f=0;do{X=i[o+f++],n.head&&X&&n.length<65536&&(n.head.name+=String.fromCharCode(X))}while(X&&f<a);if(512&n.flags&&(n.check=Jo(n.check,i,f,o)),a-=f,o+=f,X)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===a)break e;f=0;do{X=i[o+f++],n.head&&X&&n.length<65536&&(n.head.comment+=String.fromCharCode(X))}while(X&&f<a);if(512&n.flags&&(n.check=Jo(n.check,i,f,o)),a-=f,o+=f,X)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Ya;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Wa;break;case 10:for(;u<32;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}e.adler=n.check=Ca(l),l=0,u=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=u,Xa;e.adler=n.check=1,n.mode=Wa;case Wa:if(t===va||t===ga)break e;case 13:if(n.last){l>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}switch(n.last=1&l,u-=1,3&(l>>>=1)){case 0:n.mode=14;break;case 1:if(Na(n),n.mode=20,t===ga){l>>>=2,u-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=Ya}l>>>=2,u-=2;break;case 14:for(l>>>=7&u,u-=7&u;u<32;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Ya;break}if(n.length=65535&l,l=0,u=0,n.mode=15,t===ga)break e;case 15:n.mode=16;case 16:if(f=n.length){if(f>a&&(f=a),f>c&&(f=c),0===f)break e;r.set(i.subarray(o,o+f),s),a-=f,o+=f,c-=f,s+=f,n.length-=f;break}n.mode=Wa;break;case 17:for(;u<14;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(n.nlen=257+(31&l),l>>>=5,u-=5,n.ndist=1+(31&l),l>>>=5,u-=5,n.ncode=4+(15&l),l>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Ya;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}n.lens[W[n.have++]]=7&l,l>>>=3,u-=3}for(;n.have<19;)n.lens[W[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},x=ya(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,x){e.msg="invalid code lengths set",n.mode=Ya;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;b=(G=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,v=65535&G,!((y=G>>>24)<=u);){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(v<16)l>>>=y,u-=y,n.lens[n.have++]=v;else{if(16===v){for(L=y+2;u<L;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(l>>>=y,u-=y,0===n.have){e.msg="invalid bit length repeat",n.mode=Ya;break}X=n.lens[n.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===v){for(L=y+3;u<L;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}u-=y,X=0,f=3+(7&(l>>>=y)),l>>>=3,u-=3}else{for(L=y+7;u<L;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}u-=y,X=0,f=11+(127&(l>>>=y)),l>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Ya;break}for(;f--;)n.lens[n.have++]=X}}if(n.mode===Ya)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Ya;break}if(n.lenbits=9,k={bits:n.lenbits},x=ya(1,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,x){e.msg="invalid literal/lengths set",n.mode=Ya;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},x=ya(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,x){e.msg="invalid distances set",n.mode=Ya;break}if(n.mode=20,t===ga)break e;case 20:n.mode=21;case 21:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=u,ua(e,h),s=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,i=e.input,a=e.avail_in,l=n.hold,u=n.bits,n.mode===Wa&&(n.back=-1);break}for(n.back=0;b=(G=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,v=65535&G,!((y=G>>>24)<=u);){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(b&&0==(240&b)){for(g=y,Z=b,w=v;b=(G=n.lencode[w+((l&(1<<g+Z)-1)>>g)])>>>16&255,v=65535&G,!(g+(y=G>>>24)<=u);){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}l>>>=g,u-=g,n.back+=g}if(l>>>=y,u-=y,n.back+=y,n.length=v,0===b){n.mode=26;break}if(32&b){n.back=-1,n.mode=Wa;break}if(64&b){e.msg="invalid literal/length code",n.mode=Ya;break}n.extra=15&b,n.mode=22;case 22:if(n.extra){for(L=n.extra;u<L;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;b=(G=n.distcode[l&(1<<n.distbits)-1])>>>16&255,v=65535&G,!((y=G>>>24)<=u);){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(0==(240&b)){for(g=y,Z=b,w=v;b=(G=n.distcode[w+((l&(1<<g+Z)-1)>>g)])>>>16&255,v=65535&G,!(g+(y=G>>>24)<=u);){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}l>>>=g,u-=g,n.back+=g}if(l>>>=y,u-=y,n.back+=y,64&b){e.msg="invalid distance code",n.mode=Ya;break}n.offset=v,n.extra=15&b,n.mode=24;case 24:if(n.extra){for(L=n.extra;u<L;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Ya;break}n.mode=25;case 25:if(0===c)break e;if(f=h-c,n.offset>f){if((f=n.offset-f)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Ya;break}f>n.wnext?(f-=n.wnext,m=n.wsize-f):m=n.wnext-f,f>n.length&&(f=n.length),p=n.window}else p=r,m=s-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do{r[s++]=p[m++]}while(--f);0===n.length&&(n.mode=21);break;case 26:if(0===c)break e;r[s++]=n.length,c--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===a)break e;a--,l|=i[o++]<<u,u+=8}if(h-=c,e.total_out+=h,n.total+=h,h&&(e.adler=n.check=n.flags?Jo(n.check,r,h,s-h):Eo(n.check,r,h,s-h)),h=c,(n.flags?l:Ca(l))!==n.check){e.msg="incorrect data check",n.mode=Ya;break}l=0,u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===a)break e;a--,l+=i[o++]<<u,u+=8}if(l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Ya;break}l=0,u=0}n.mode=29;case 29:x=wa;break e;case Ya:x=ka;break e;case 31:return La;case 32:default:return xa}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,n.hold=l,n.bits=u,(n.wsize||h!==e.avail_out&&n.mode<Ya&&(n.mode<27||t!==ba))&&Fa(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,n.wrap&&h&&(e.adler=n.check=n.flags?Jo(n.check,r,h,e.next_out-h):Eo(n.check,r,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Wa?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===h||t===ba)&&x===Za&&(x=Ga),x},inflateEnd:function(e){if(!e||!e.state)return xa;var t=e.state;return t.window&&(t.window=null),e.state=null,Za},inflateGetHeader:function(e,t){if(!e||!e.state)return xa;var n=e.state;return 0==(2&n.wrap)?xa:(n.head=t,t.done=!1,Za)},inflateSetDictionary:function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?xa:11===n.mode&&Eo(1,t,i,0)!==n.check?ka:Fa(e,t,i,i)?(n.mode=31,La):(n.havedict=1,Za):xa},inflateInfo:"pako inflate (from Nodeca project)"};var ja=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Ea=Object.prototype.toString,_a=Uo.Z_NO_FLUSH,Ja=Uo.Z_FINISH,Qa=Uo.Z_OK,Ua=Uo.Z_STREAM_END,Da=Uo.Z_NEED_DICT,Oa=Uo.Z_STREAM_ERROR,Ba=Uo.Z_DATA_ERROR,Aa=Uo.Z_MEM_ERROR;function qa(e){this.options=js({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bs,this.strm.avail_out=0;var n=za.inflateInit2(this.strm,t.windowBits);if(n!==Qa)throw new Error(Qo[n]);if(this.header=new ja,za.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Us(t.dictionary):"[object ArrayBuffer]"===Ea.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=za.inflateSetDictionary(this.strm,t.dictionary))!==Qa))throw new Error(Qo[n])}function $a(e,t){var n=new qa(t);if(n.push(e),n.err)throw n.msg||Qo[n.err];return n.result}qa.prototype.push=function(e,t){var n,i,r,o=this.strm,s=this.options.chunkSize,a=this.options.dictionary;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Ja:_a,"[object ArrayBuffer]"===Ea.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;;){for(0===o.avail_out&&(o.output=new Uint8Array(s),o.next_out=0,o.avail_out=s),(n=za.inflate(o,i))===Da&&a&&((n=za.inflateSetDictionary(o,a))===Qa?n=za.inflate(o,i):n===Ba&&(n=Da));o.avail_in>0&&n===Ua&&o.state.wrap>0&&0!==e[o.next_in];)za.inflateReset(o),n=za.inflate(o,i);switch(n){case Oa:case Ba:case Da:case Aa:return this.onEnd(n),this.ended=!0,!1}if(r=o.avail_out,o.next_out&&(0===o.avail_out||n===Ua))if("string"===this.options.to){var c=Os(o.output,o.next_out),l=o.next_out-c,u=Ds(o.output,c);o.next_out=l,o.avail_out=s-l,l&&o.output.set(o.output.subarray(c,c+l),0),this.onData(u)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(n!==Qa||0!==r){if(n===Ua)return n=za.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===o.avail_in)break}}return!0},qa.prototype.onData=function(e){this.chunks.push(e)},qa.prototype.onEnd=function(e){e===Qa&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Es(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ec={Inflate:qa,inflate:$a,inflateRaw:function(e,t){return(t=t||{}).raw=!0,$a(e,t)},ungzip:$a,constants:Uo},tc={Deflate:la.Deflate,deflate:la.deflate,deflateRaw:la.deflateRaw,gzip:la.gzip,Inflate:ec.Inflate,inflate:ec.inflate,inflateRaw:ec.inflateRaw,ungzip:ec.ungzip,constants:Uo};function nc(e,t,n){var i=void 0===t?null:t,r=function(e,t){var n=atob(e);if(t){for(var i=new Uint8Array(n.length),r=0,o=n.length;r<o;++r)i[r]=n.charCodeAt(r);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}(e,void 0!==n&&n),o=r.indexOf("\n",10)+1,s=r.substring(o)+(i?"\/\/# sourceMappingURL="+i:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}var ic,rc,oc,sc,ac=(ic="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwovKioKICogQ29weXJpZ2h0IENyb3F1ZXQgQ29ycG9yYXRpb24gMjAyMQogKiBCdW5kbGUgb2YgQGNyb3F1ZXQvY3JvcXVldAogKiBEYXRlOiAyMDIxLTEwLTIxCiAqIFZlcnNpb246IDEuMC41CiAqLwoKIWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHQoZSl7cmV0dXJuKHQ9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmInN5bWJvbCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmdC5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmdCE9PVN5bWJvbC5wcm90b3R5cGU/InN5bWJvbCI6dHlwZW9mIHR9KShlKX1mdW5jdGlvbiBlKHQsZSxyLG4sYSxpLG8pe3RyeXt2YXIgcz10W2ldKG8pLGM9cy52YWx1ZX1jYXRjaCh0KXtyZXR1cm4gdm9pZCByKHQpfXMuZG9uZT9lKGMpOlByb21pc2UucmVzb2x2ZShjKS50aGVuKG4sYSl9ZnVuY3Rpb24gcih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcj10aGlzLG49YXJndW1lbnRzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24oYSxpKXt2YXIgbz10LmFwcGx5KHIsbik7ZnVuY3Rpb24gcyh0KXtlKG8sYSxpLHMsYywibmV4dCIsdCl9ZnVuY3Rpb24gYyh0KXtlKG8sYSxpLHMsYywidGhyb3ciLHQpfXModm9pZCAwKX0pKX19ZnVuY3Rpb24gbih0LGUpeyhudWxsPT1lfHxlPnQubGVuZ3RoKSYmKGU9dC5sZW5ndGgpO2Zvcih2YXIgcj0wLG49bmV3IEFycmF5KGUpO3I8ZTtyKyspbltyXT10W3JdO3JldHVybiBufWZ1bmN0aW9uIGEodCxlKXt2YXIgcj0idW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmdFtTeW1ib2wuaXRlcmF0b3JdfHx0WyJAQGl0ZXJhdG9yIl07aWYoIXIpe2lmKEFycmF5LmlzQXJyYXkodCl8fChyPWZ1bmN0aW9uKHQsZSl7aWYodCl7aWYoInN0cmluZyI9PXR5cGVvZiB0KXJldHVybiBuKHQsZSk7dmFyIHI9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpLnNsaWNlKDgsLTEpO3JldHVybiJPYmplY3QiPT09ciYmdC5jb25zdHJ1Y3RvciYmKHI9dC5jb25zdHJ1Y3Rvci5uYW1lKSwiTWFwIj09PXJ8fCJTZXQiPT09cj9BcnJheS5mcm9tKHQpOiJBcmd1bWVudHMiPT09cnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qocik/bih0LGUpOnZvaWQgMH19KHQpKXx8ZSYmdCYmIm51bWJlciI9PXR5cGVvZiB0Lmxlbmd0aCl7ciYmKHQ9cik7dmFyIGE9MCxpPWZ1bmN0aW9uKCl7fTtyZXR1cm57czppLG46ZnVuY3Rpb24oKXtyZXR1cm4gYT49dC5sZW5ndGg/e2RvbmU6ITB9Ontkb25lOiExLHZhbHVlOnRbYSsrXX19LGU6ZnVuY3Rpb24odCl7dGhyb3cgdH0sZjppfX10aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIil9dmFyIG8scz0hMCxjPSExO3JldHVybntzOmZ1bmN0aW9uKCl7cj1yLmNhbGwodCl9LG46ZnVuY3Rpb24oKXt2YXIgdD1yLm5leHQoKTtyZXR1cm4gcz10LmRvbmUsdH0sZTpmdW5jdGlvbih0KXtjPSEwLG89dH0sZjpmdW5jdGlvbigpe3RyeXtzfHxudWxsPT1yLnJldHVybnx8ci5yZXR1cm4oKX1maW5hbGx5e2lmKGMpdGhyb3cgb319fX12YXIgaT0idW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbFRoaXM/Z2xvYmFsVGhpczoidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6InVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOiJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZj9zZWxmOnt9OyFmdW5jdGlvbihlKXt2YXIgcj1mdW5jdGlvbihlKXt2YXIgcixuPU9iamVjdC5wcm90b3R5cGUsYT1uLmhhc093blByb3BlcnR5LGk9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbD9TeW1ib2w6e30sbz1pLml0ZXJhdG9yfHwiQEBpdGVyYXRvciIscz1pLmFzeW5jSXRlcmF0b3J8fCJAQGFzeW5jSXRlcmF0b3IiLGM9aS50b1N0cmluZ1RhZ3x8IkBAdG9TdHJpbmdUYWciO2Z1bmN0aW9uIGgodCxlLHIpe3JldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHt2YWx1ZTpyLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSksdFtlXX10cnl7aCh7fSwiIil9Y2F0Y2godCl7aD1mdW5jdGlvbih0LGUscil7cmV0dXJuIHRbZV09cn19ZnVuY3Rpb24gbCh0LGUscixuKXt2YXIgYT1lJiZlLnByb3RvdHlwZSBpbnN0YW5jZW9mIHY/ZTp2LGk9T2JqZWN0LmNyZWF0ZShhLnByb3RvdHlwZSksbz1uZXcgUihufHxbXSk7cmV0dXJuIGkuX2ludm9rZT1mdW5jdGlvbih0LGUscil7dmFyIG49ZjtyZXR1cm4gZnVuY3Rpb24oYSxpKXtpZihuPT09Xyl0aHJvdyBuZXcgRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmciKTtpZihuPT09cCl7aWYoInRocm93Ij09PWEpdGhyb3cgaTtyZXR1cm4gTCgpfWZvcihyLm1ldGhvZD1hLHIuYXJnPWk7Oyl7dmFyIG89ci5kZWxlZ2F0ZTtpZihvKXt2YXIgcz1TKG8scik7aWYocyl7aWYocz09PWcpY29udGludWU7cmV0dXJuIHN9fWlmKCJuZXh0Ij09PXIubWV0aG9kKXIuc2VudD1yLl9zZW50PXIuYXJnO2Vsc2UgaWYoInRocm93Ij09PXIubWV0aG9kKXtpZihuPT09Zil0aHJvdyBuPXAsci5hcmc7ci5kaXNwYXRjaEV4Y2VwdGlvbihyLmFyZyl9ZWxzZSJyZXR1cm4iPT09ci5tZXRob2QmJnIuYWJydXB0KCJyZXR1cm4iLHIuYXJnKTtuPV87dmFyIGM9dSh0LGUscik7aWYoIm5vcm1hbCI9PT1jLnR5cGUpe2lmKG49ci5kb25lP3A6ZCxjLmFyZz09PWcpY29udGludWU7cmV0dXJue3ZhbHVlOmMuYXJnLGRvbmU6ci5kb25lfX0idGhyb3ciPT09Yy50eXBlJiYobj1wLHIubWV0aG9kPSJ0aHJvdyIsci5hcmc9Yy5hcmcpfX19KHQscixvKSxpfWZ1bmN0aW9uIHUodCxlLHIpe3RyeXtyZXR1cm57dHlwZToibm9ybWFsIixhcmc6dC5jYWxsKGUscil9fWNhdGNoKHQpe3JldHVybnt0eXBlOiJ0aHJvdyIsYXJnOnR9fX1lLndyYXA9bDt2YXIgZj0ic3VzcGVuZGVkU3RhcnQiLGQ9InN1c3BlbmRlZFlpZWxkIixfPSJleGVjdXRpbmciLHA9ImNvbXBsZXRlZCIsZz17fTtmdW5jdGlvbiB2KCl7fWZ1bmN0aW9uIHkoKXt9ZnVuY3Rpb24gdygpe312YXIgbT17fTtoKG0sbywoZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pKTt2YXIgYj1PYmplY3QuZ2V0UHJvdG90eXBlT2YseD1iJiZiKGIoRChbXSkpKTt4JiZ4IT09biYmYS5jYWxsKHgsbykmJihtPXgpO3ZhciBrPXcucHJvdG90eXBlPXYucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobSk7ZnVuY3Rpb24geih0KXtbIm5leHQiLCJ0aHJvdyIsInJldHVybiJdLmZvckVhY2goKGZ1bmN0aW9uKGUpe2godCxlLChmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5faW52b2tlKGUsdCl9KSl9KSl9ZnVuY3Rpb24gQShlLHIpe2Z1bmN0aW9uIG4oaSxvLHMsYyl7dmFyIGg9dShlW2ldLGUsbyk7aWYoInRocm93IiE9PWgudHlwZSl7dmFyIGw9aC5hcmcsZj1sLnZhbHVlO3JldHVybiBmJiYib2JqZWN0Ij09PXQoZikmJmEuY2FsbChmLCJfX2F3YWl0Iik/ci5yZXNvbHZlKGYuX19hd2FpdCkudGhlbigoZnVuY3Rpb24odCl7bigibmV4dCIsdCxzLGMpfSksKGZ1bmN0aW9uKHQpe24oInRocm93Iix0LHMsYyl9KSk6ci5yZXNvbHZlKGYpLnRoZW4oKGZ1bmN0aW9uKHQpe2wudmFsdWU9dCxzKGwpfSksKGZ1bmN0aW9uKHQpe3JldHVybiBuKCJ0aHJvdyIsdCxzLGMpfSkpfWMoaC5hcmcpfXZhciBpO3RoaXMuX2ludm9rZT1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGEoKXtyZXR1cm4gbmV3IHIoKGZ1bmN0aW9uKHIsYSl7bih0LGUscixhKX0pKX1yZXR1cm4gaT1pP2kudGhlbihhLGEpOmEoKX19ZnVuY3Rpb24gUyh0LGUpe3ZhciBuPXQuaXRlcmF0b3JbZS5tZXRob2RdO2lmKG49PT1yKXtpZihlLmRlbGVnYXRlPW51bGwsInRocm93Ij09PWUubWV0aG9kKXtpZih0Lml0ZXJhdG9yLnJldHVybiYmKGUubWV0aG9kPSJyZXR1cm4iLGUuYXJnPXIsUyh0LGUpLCJ0aHJvdyI9PT1lLm1ldGhvZCkpcmV0dXJuIGc7ZS5tZXRob2Q9InRocm93IixlLmFyZz1uZXcgVHlwZUVycm9yKCJUaGUgaXRlcmF0b3IgZG9lcyBub3QgcHJvdmlkZSBhICd0aHJvdycgbWV0aG9kIil9cmV0dXJuIGd9dmFyIGE9dShuLHQuaXRlcmF0b3IsZS5hcmcpO2lmKCJ0aHJvdyI9PT1hLnR5cGUpcmV0dXJuIGUubWV0aG9kPSJ0aHJvdyIsZS5hcmc9YS5hcmcsZS5kZWxlZ2F0ZT1udWxsLGc7dmFyIGk9YS5hcmc7cmV0dXJuIGk/aS5kb25lPyhlW3QucmVzdWx0TmFtZV09aS52YWx1ZSxlLm5leHQ9dC5uZXh0TG9jLCJyZXR1cm4iIT09ZS5tZXRob2QmJihlLm1ldGhvZD0ibmV4dCIsZS5hcmc9ciksZS5kZWxlZ2F0ZT1udWxsLGcpOmk6KGUubWV0aG9kPSJ0aHJvdyIsZS5hcmc9bmV3IFR5cGVFcnJvcigiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3QiKSxlLmRlbGVnYXRlPW51bGwsZyl9ZnVuY3Rpb24gRSh0KXt2YXIgZT17dHJ5TG9jOnRbMF19OzEgaW4gdCYmKGUuY2F0Y2hMb2M9dFsxXSksMiBpbiB0JiYoZS5maW5hbGx5TG9jPXRbMl0sZS5hZnRlckxvYz10WzNdKSx0aGlzLnRyeUVudHJpZXMucHVzaChlKX1mdW5jdGlvbiBCKHQpe3ZhciBlPXQuY29tcGxldGlvbnx8e307ZS50eXBlPSJub3JtYWwiLGRlbGV0ZSBlLmFyZyx0LmNvbXBsZXRpb249ZX1mdW5jdGlvbiBSKHQpe3RoaXMudHJ5RW50cmllcz1be3RyeUxvYzoicm9vdCJ9XSx0LmZvckVhY2goRSx0aGlzKSx0aGlzLnJlc2V0KCEwKX1mdW5jdGlvbiBEKHQpe2lmKHQpe3ZhciBlPXRbb107aWYoZSlyZXR1cm4gZS5jYWxsKHQpO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiB0Lm5leHQpcmV0dXJuIHQ7aWYoIWlzTmFOKHQubGVuZ3RoKSl7dmFyIG49LTEsaT1mdW5jdGlvbiBlKCl7Zm9yKDsrK248dC5sZW5ndGg7KWlmKGEuY2FsbCh0LG4pKXJldHVybiBlLnZhbHVlPXRbbl0sZS5kb25lPSExLGU7cmV0dXJuIGUudmFsdWU9cixlLmRvbmU9ITAsZX07cmV0dXJuIGkubmV4dD1pfX1yZXR1cm57bmV4dDpMfX1mdW5jdGlvbiBMKCl7cmV0dXJue3ZhbHVlOnIsZG9uZTohMH19cmV0dXJuIHkucHJvdG90eXBlPXcsaChrLCJjb25zdHJ1Y3RvciIsdyksaCh3LCJjb25zdHJ1Y3RvciIseSkseS5kaXNwbGF5TmFtZT1oKHcsYywiR2VuZXJhdG9yRnVuY3Rpb24iKSxlLmlzR2VuZXJhdG9yRnVuY3Rpb249ZnVuY3Rpb24odCl7dmFyIGU9ImZ1bmN0aW9uIj09dHlwZW9mIHQmJnQuY29uc3RydWN0b3I7cmV0dXJuISFlJiYoZT09PXl8fCJHZW5lcmF0b3JGdW5jdGlvbiI9PT0oZS5kaXNwbGF5TmFtZXx8ZS5uYW1lKSl9LGUubWFyaz1mdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZih0LHcpOih0Ll9fcHJvdG9fXz13LGgodCxjLCJHZW5lcmF0b3JGdW5jdGlvbiIpKSx0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGspLHR9LGUuYXdyYXA9ZnVuY3Rpb24odCl7cmV0dXJue19fYXdhaXQ6dH19LHooQS5wcm90b3R5cGUpLGgoQS5wcm90b3R5cGUscywoZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pKSxlLkFzeW5jSXRlcmF0b3I9QSxlLmFzeW5jPWZ1bmN0aW9uKHQscixuLGEsaSl7dm9pZCAwPT09aSYmKGk9UHJvbWlzZSk7dmFyIG89bmV3IEEobCh0LHIsbixhKSxpKTtyZXR1cm4gZS5pc0dlbmVyYXRvckZ1bmN0aW9uKHIpP286by5uZXh0KCkudGhlbigoZnVuY3Rpb24odCl7cmV0dXJuIHQuZG9uZT90LnZhbHVlOm8ubmV4dCgpfSkpfSx6KGspLGgoayxjLCJHZW5lcmF0b3IiKSxoKGssbywoZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pKSxoKGssInRvU3RyaW5nIiwoZnVuY3Rpb24oKXtyZXR1cm4iW29iamVjdCBHZW5lcmF0b3JdIn0pKSxlLmtleXM9ZnVuY3Rpb24odCl7dmFyIGU9W107Zm9yKHZhciByIGluIHQpZS5wdXNoKHIpO3JldHVybiBlLnJldmVyc2UoKSxmdW5jdGlvbiByKCl7Zm9yKDtlLmxlbmd0aDspe3ZhciBuPWUucG9wKCk7aWYobiBpbiB0KXJldHVybiByLnZhbHVlPW4sci5kb25lPSExLHJ9cmV0dXJuIHIuZG9uZT0hMCxyfX0sZS52YWx1ZXM9RCxSLnByb3RvdHlwZT17Y29uc3RydWN0b3I6UixyZXNldDpmdW5jdGlvbih0KXtpZih0aGlzLnByZXY9MCx0aGlzLm5leHQ9MCx0aGlzLnNlbnQ9dGhpcy5fc2VudD1yLHRoaXMuZG9uZT0hMSx0aGlzLmRlbGVnYXRlPW51bGwsdGhpcy5tZXRob2Q9Im5leHQiLHRoaXMuYXJnPXIsdGhpcy50cnlFbnRyaWVzLmZvckVhY2goQiksIXQpZm9yKHZhciBlIGluIHRoaXMpInQiPT09ZS5jaGFyQXQoMCkmJmEuY2FsbCh0aGlzLGUpJiYhaXNOYU4oK2Uuc2xpY2UoMSkpJiYodGhpc1tlXT1yKX0sc3RvcDpmdW5jdGlvbigpe3RoaXMuZG9uZT0hMDt2YXIgdD10aGlzLnRyeUVudHJpZXNbMF0uY29tcGxldGlvbjtpZigidGhyb3ciPT09dC50eXBlKXRocm93IHQuYXJnO3JldHVybiB0aGlzLnJ2YWx9LGRpc3BhdGNoRXhjZXB0aW9uOmZ1bmN0aW9uKHQpe2lmKHRoaXMuZG9uZSl0aHJvdyB0O3ZhciBlPXRoaXM7ZnVuY3Rpb24gbihuLGEpe3JldHVybiBzLnR5cGU9InRocm93IixzLmFyZz10LGUubmV4dD1uLGEmJihlLm1ldGhvZD0ibmV4dCIsZS5hcmc9ciksISFhfWZvcih2YXIgaT10aGlzLnRyeUVudHJpZXMubGVuZ3RoLTE7aT49MDstLWkpe3ZhciBvPXRoaXMudHJ5RW50cmllc1tpXSxzPW8uY29tcGxldGlvbjtpZigicm9vdCI9PT1vLnRyeUxvYylyZXR1cm4gbigiZW5kIik7aWYoby50cnlMb2M8PXRoaXMucHJldil7dmFyIGM9YS5jYWxsKG8sImNhdGNoTG9jIiksaD1hLmNhbGwobywiZmluYWxseUxvYyIpO2lmKGMmJmgpe2lmKHRoaXMucHJldjxvLmNhdGNoTG9jKXJldHVybiBuKG8uY2F0Y2hMb2MsITApO2lmKHRoaXMucHJldjxvLmZpbmFsbHlMb2MpcmV0dXJuIG4oby5maW5hbGx5TG9jKX1lbHNlIGlmKGMpe2lmKHRoaXMucHJldjxvLmNhdGNoTG9jKXJldHVybiBuKG8uY2F0Y2hMb2MsITApfWVsc2V7aWYoIWgpdGhyb3cgbmV3IEVycm9yKCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseSIpO2lmKHRoaXMucHJldjxvLmZpbmFsbHlMb2MpcmV0dXJuIG4oby5maW5hbGx5TG9jKX19fX0sYWJydXB0OmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPXRoaXMudHJ5RW50cmllcy5sZW5ndGgtMTtyPj0wOy0tcil7dmFyIG49dGhpcy50cnlFbnRyaWVzW3JdO2lmKG4udHJ5TG9jPD10aGlzLnByZXYmJmEuY2FsbChuLCJmaW5hbGx5TG9jIikmJnRoaXMucHJldjxuLmZpbmFsbHlMb2Mpe3ZhciBpPW47YnJlYWt9fWkmJigiYnJlYWsiPT09dHx8ImNvbnRpbnVlIj09PXQpJiZpLnRyeUxvYzw9ZSYmZTw9aS5maW5hbGx5TG9jJiYoaT1udWxsKTt2YXIgbz1pP2kuY29tcGxldGlvbjp7fTtyZXR1cm4gby50eXBlPXQsby5hcmc9ZSxpPyh0aGlzLm1ldGhvZD0ibmV4dCIsdGhpcy5uZXh0PWkuZmluYWxseUxvYyxnKTp0aGlzLmNvbXBsZXRlKG8pfSxjb21wbGV0ZTpmdW5jdGlvbih0LGUpe2lmKCJ0aHJvdyI9PT10LnR5cGUpdGhyb3cgdC5hcmc7cmV0dXJuImJyZWFrIj09PXQudHlwZXx8ImNvbnRpbnVlIj09PXQudHlwZT90aGlzLm5leHQ9dC5hcmc6InJldHVybiI9PT10LnR5cGU/KHRoaXMucnZhbD10aGlzLmFyZz10LmFyZyx0aGlzLm1ldGhvZD0icmV0dXJuIix0aGlzLm5leHQ9ImVuZCIpOiJub3JtYWwiPT09dC50eXBlJiZlJiYodGhpcy5uZXh0PWUpLGd9LGZpbmlzaDpmdW5jdGlvbih0KXtmb3IodmFyIGU9dGhpcy50cnlFbnRyaWVzLmxlbmd0aC0xO2U+PTA7LS1lKXt2YXIgcj10aGlzLnRyeUVudHJpZXNbZV07aWYoci5maW5hbGx5TG9jPT09dClyZXR1cm4gdGhpcy5jb21wbGV0ZShyLmNvbXBsZXRpb24sci5hZnRlckxvYyksQihyKSxnfX0sY2F0Y2g6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMudHJ5RW50cmllcy5sZW5ndGgtMTtlPj0wOy0tZSl7dmFyIHI9dGhpcy50cnlFbnRyaWVzW2VdO2lmKHIudHJ5TG9jPT09dCl7dmFyIG49ci5jb21wbGV0aW9uO2lmKCJ0aHJvdyI9PT1uLnR5cGUpe3ZhciBhPW4uYXJnO0Iocil9cmV0dXJuIGF9fXRocm93IG5ldyBFcnJvcigiaWxsZWdhbCBjYXRjaCBhdHRlbXB0Iil9LGRlbGVnYXRlWWllbGQ6ZnVuY3Rpb24odCxlLG4pe3JldHVybiB0aGlzLmRlbGVnYXRlPXtpdGVyYXRvcjpEKHQpLHJlc3VsdE5hbWU6ZSxuZXh0TG9jOm59LCJuZXh0Ij09PXRoaXMubWV0aG9kJiYodGhpcy5hcmc9ciksZ319LGV9KGUuZXhwb3J0cyk7dHJ5e2dsb2JhbFRoaXMucmVnZW5lcmF0b3JSdW50aW1lPXJ9Y2F0Y2goZSl7Im9iamVjdCI9PT0oInVuZGVmaW5lZCI9PXR5cGVvZiBnbG9iYWxUaGlzPyJ1bmRlZmluZWQiOnQoZ2xvYmFsVGhpcykpP2dsb2JhbFRoaXMucmVnZW5lcmF0b3JSdW50aW1lPXI6RnVuY3Rpb24oInIiLCJyZWdlbmVyYXRvclJ1bnRpbWUgPSByIikocil9fSh7ZXhwb3J0czp7fX0pO3ZhciBvPXtleHBvcnRzOnt9fTsoZnVuY3Rpb24oZSl7dmFyIHI9NCxuPTAsYT0xLGk9MjtmdW5jdGlvbiBvKHQpe2Zvcih2YXIgZT10Lmxlbmd0aDstLWU+PTA7KXRbZV09MH12YXIgcz0wLGM9MSxoPTIsbD0zLHU9MjU4LGY9MjksZD0yNTYsXz1kKzErZixwPTMwLGc9MTksdj0yKl8rMSx5PTE1LHc9MTYsbT03LGI9MjU2LHg9MTYsaz0xNyx6PTE4LEE9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwxLDEsMSwxLDIsMiwyLDIsMywzLDMsMyw0LDQsNCw0LDUsNSw1LDUsMF0pLFM9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMSwxLDIsMiwzLDMsNCw0LDUsNSw2LDYsNyw3LDgsOCw5LDksMTAsMTAsMTEsMTEsMTIsMTIsMTMsMTNdKSxFPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDIsMyw3XSksQj1uZXcgVWludDhBcnJheShbMTYsMTcsMTgsMCw4LDcsOSw2LDEwLDUsMTEsNCwxMiwzLDEzLDIsMTQsMSwxNV0pLFI9NTEyLEQ9bmV3IEFycmF5KDIqKF8rMikpO28oRCk7dmFyIEw9bmV3IEFycmF5KDIqcCk7byhMKTt2YXIgTz1uZXcgQXJyYXkoUik7byhPKTt2YXIgVT1uZXcgQXJyYXkodS1sKzEpO28oVSk7dmFyIEM9bmV3IEFycmF5KGYpO28oQyk7dmFyIEYsVCxILFo9bmV3IEFycmF5KHApO2Z1bmN0aW9uIE0odCxlLHIsbixhKXt0aGlzLnN0YXRpY190cmVlPXQsdGhpcy5leHRyYV9iaXRzPWUsdGhpcy5leHRyYV9iYXNlPXIsdGhpcy5lbGVtcz1uLHRoaXMubWF4X2xlbmd0aD1hLHRoaXMuaGFzX3N0cmVlPXQmJnQubGVuZ3RofWZ1bmN0aW9uIEkodCxlKXt0aGlzLmR5bl90cmVlPXQsdGhpcy5tYXhfY29kZT0wLHRoaXMuc3RhdF9kZXNjPWV9byhaKTt2YXIgTj1mdW5jdGlvbih0KXtyZXR1cm4gdDwyNTY/T1t0XTpPWzI1NisodD4+PjcpXX0sUD1mdW5jdGlvbih0LGUpe3QucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPTI1NSZlLHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPWU+Pj44JjI1NX0saj1mdW5jdGlvbih0LGUscil7dC5iaV92YWxpZD53LXI/KHQuYmlfYnVmfD1lPDx0LmJpX3ZhbGlkJjY1NTM1LFAodCx0LmJpX2J1ZiksdC5iaV9idWY9ZT4+dy10LmJpX3ZhbGlkLHQuYmlfdmFsaWQrPXItdyk6KHQuYmlfYnVmfD1lPDx0LmJpX3ZhbGlkJjY1NTM1LHQuYmlfdmFsaWQrPXIpfSxLPWZ1bmN0aW9uKHQsZSxyKXtqKHQsclsyKmVdLHJbMiplKzFdKX0sWD1mdW5jdGlvbih0LGUpe3ZhciByPTA7ZG97cnw9MSZ0LHQ+Pj49MSxyPDw9MX13aGlsZSgtLWU+MCk7cmV0dXJuIHI+Pj4xfSxxPWZ1bmN0aW9uKHQpezE2PT09dC5iaV92YWxpZD8oUCh0LHQuYmlfYnVmKSx0LmJpX2J1Zj0wLHQuYmlfdmFsaWQ9MCk6dC5iaV92YWxpZD49OCYmKHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPTI1NSZ0LmJpX2J1Zix0LmJpX2J1Zj4+PTgsdC5iaV92YWxpZC09OCl9LEc9ZnVuY3Rpb24odCxlKXt2YXIgcixuLGEsaSxvLHMsYz1lLmR5bl90cmVlLGg9ZS5tYXhfY29kZSxsPWUuc3RhdF9kZXNjLnN0YXRpY190cmVlLHU9ZS5zdGF0X2Rlc2MuaGFzX3N0cmVlLGY9ZS5zdGF0X2Rlc2MuZXh0cmFfYml0cyxkPWUuc3RhdF9kZXNjLmV4dHJhX2Jhc2UsXz1lLnN0YXRfZGVzYy5tYXhfbGVuZ3RoLHA9MDtmb3IoaT0wO2k8PXk7aSsrKXQuYmxfY291bnRbaV09MDtmb3IoY1syKnQuaGVhcFt0LmhlYXBfbWF4XSsxXT0wLHI9dC5oZWFwX21heCsxO3I8djtyKyspKGk9Y1syKmNbMioobj10LmhlYXBbcl0pKzFdKzFdKzEpPl8mJihpPV8scCsrKSxjWzIqbisxXT1pLG4+aHx8KHQuYmxfY291bnRbaV0rKyxvPTAsbj49ZCYmKG89ZltuLWRdKSxzPWNbMipuXSx0Lm9wdF9sZW4rPXMqKGkrbyksdSYmKHQuc3RhdGljX2xlbis9cyoobFsyKm4rMV0rbykpKTtpZigwIT09cCl7ZG97Zm9yKGk9Xy0xOzA9PT10LmJsX2NvdW50W2ldOylpLS07dC5ibF9jb3VudFtpXS0tLHQuYmxfY291bnRbaSsxXSs9Mix0LmJsX2NvdW50W19dLS0scC09Mn13aGlsZShwPjApO2ZvcihpPV87MCE9PWk7aS0tKWZvcihuPXQuYmxfY291bnRbaV07MCE9PW47KShhPXQuaGVhcFstLXJdKT5ofHwoY1syKmErMV0hPT1pJiYodC5vcHRfbGVuKz0oaS1jWzIqYSsxXSkqY1syKmFdLGNbMiphKzFdPWkpLG4tLSl9fSxXPWZ1bmN0aW9uKHQsZSxyKXt2YXIgbixhLGk9bmV3IEFycmF5KHkrMSksbz0wO2ZvcihuPTE7bjw9eTtuKyspaVtuXT1vPW8rcltuLTFdPDwxO2ZvcihhPTA7YTw9ZTthKyspe3ZhciBzPXRbMiphKzFdOzAhPT1zJiYodFsyKmFdPVgoaVtzXSsrLHMpKX19LFk9ZnVuY3Rpb24oKXt2YXIgdCxlLHIsbixhLGk9bmV3IEFycmF5KHkrMSk7Zm9yKHI9MCxuPTA7bjxmLTE7bisrKWZvcihDW25dPXIsdD0wO3Q8MTw8QVtuXTt0KyspVVtyKytdPW47Zm9yKFVbci0xXT1uLGE9MCxuPTA7bjwxNjtuKyspZm9yKFpbbl09YSx0PTA7dDwxPDxTW25dO3QrKylPW2ErK109bjtmb3IoYT4+PTc7bjxwO24rKylmb3IoWltuXT1hPDw3LHQ9MDt0PDE8PFNbbl0tNzt0KyspT1syNTYrYSsrXT1uO2ZvcihlPTA7ZTw9eTtlKyspaVtlXT0wO2Zvcih0PTA7dDw9MTQzOylEWzIqdCsxXT04LHQrKyxpWzhdKys7Zm9yKDt0PD0yNTU7KURbMip0KzFdPTksdCsrLGlbOV0rKztmb3IoO3Q8PTI3OTspRFsyKnQrMV09Nyx0KyssaVs3XSsrO2Zvcig7dDw9Mjg3OylEWzIqdCsxXT04LHQrKyxpWzhdKys7Zm9yKFcoRCxfKzEsaSksdD0wO3Q8cDt0KyspTFsyKnQrMV09NSxMWzIqdF09WCh0LDUpO0Y9bmV3IE0oRCxBLGQrMSxfLHkpLFQ9bmV3IE0oTCxTLDAscCx5KSxIPW5ldyBNKG5ldyBBcnJheSgwKSxFLDAsZyxtKX0sVj1mdW5jdGlvbih0KXt2YXIgZTtmb3IoZT0wO2U8XztlKyspdC5keW5fbHRyZWVbMiplXT0wO2ZvcihlPTA7ZTxwO2UrKyl0LmR5bl9kdHJlZVsyKmVdPTA7Zm9yKGU9MDtlPGc7ZSsrKXQuYmxfdHJlZVsyKmVdPTA7dC5keW5fbHRyZWVbMipiXT0xLHQub3B0X2xlbj10LnN0YXRpY19sZW49MCx0Lmxhc3RfbGl0PXQubWF0Y2hlcz0wfSwkPWZ1bmN0aW9uKHQpe3QuYmlfdmFsaWQ+OD9QKHQsdC5iaV9idWYpOnQuYmlfdmFsaWQ+MCYmKHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPXQuYmlfYnVmKSx0LmJpX2J1Zj0wLHQuYmlfdmFsaWQ9MH0sUT1mdW5jdGlvbih0LGUscixuKXskKHQpLG4mJihQKHQsciksUCh0LH5yKSksdC5wZW5kaW5nX2J1Zi5zZXQodC53aW5kb3cuc3ViYXJyYXkoZSxlK3IpLHQucGVuZGluZyksdC5wZW5kaW5nKz1yfSxKPWZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBhPTIqZSxpPTIqcjtyZXR1cm4gdFthXTx0W2ldfHx0W2FdPT09dFtpXSYmbltlXTw9bltyXX0sdHQ9ZnVuY3Rpb24odCxlLHIpe2Zvcih2YXIgbj10LmhlYXBbcl0sYT1yPDwxO2E8PXQuaGVhcF9sZW4mJihhPHQuaGVhcF9sZW4mJkooZSx0LmhlYXBbYSsxXSx0LmhlYXBbYV0sdC5kZXB0aCkmJmErKywhSihlLG4sdC5oZWFwW2FdLHQuZGVwdGgpKTspdC5oZWFwW3JdPXQuaGVhcFthXSxyPWEsYTw8PTE7dC5oZWFwW3JdPW59LGV0PWZ1bmN0aW9uKHQsZSxyKXt2YXIgbixhLGksbyxzPTA7aWYoMCE9PXQubGFzdF9saXQpZG97bj10LnBlbmRpbmdfYnVmW3QuZF9idWYrMipzXTw8OHx0LnBlbmRpbmdfYnVmW3QuZF9idWYrMipzKzFdLGE9dC5wZW5kaW5nX2J1Zlt0LmxfYnVmK3NdLHMrKywwPT09bj9LKHQsYSxlKTooaT1VW2FdLEsodCxpK2QrMSxlKSwwIT09KG89QVtpXSkmJihhLT1DW2ldLGoodCxhLG8pKSxuLS0saT1OKG4pLEsodCxpLHIpLDAhPT0obz1TW2ldKSYmKG4tPVpbaV0saih0LG4sbykpKX13aGlsZShzPHQubGFzdF9saXQpO0sodCxiLGUpfSxydD1mdW5jdGlvbih0LGUpe3ZhciByLG4sYSxpPWUuZHluX3RyZWUsbz1lLnN0YXRfZGVzYy5zdGF0aWNfdHJlZSxzPWUuc3RhdF9kZXNjLmhhc19zdHJlZSxjPWUuc3RhdF9kZXNjLmVsZW1zLGg9LTE7Zm9yKHQuaGVhcF9sZW49MCx0LmhlYXBfbWF4PXYscj0wO3I8YztyKyspMCE9PWlbMipyXT8odC5oZWFwWysrdC5oZWFwX2xlbl09aD1yLHQuZGVwdGhbcl09MCk6aVsyKnIrMV09MDtmb3IoO3QuaGVhcF9sZW48MjspaVsyKihhPXQuaGVhcFsrK3QuaGVhcF9sZW5dPWg8Mj8rK2g6MCldPTEsdC5kZXB0aFthXT0wLHQub3B0X2xlbi0tLHMmJih0LnN0YXRpY19sZW4tPW9bMiphKzFdKTtmb3IoZS5tYXhfY29kZT1oLHI9dC5oZWFwX2xlbj4+MTtyPj0xO3ItLSl0dCh0LGkscik7YT1jO2Rve3I9dC5oZWFwWzFdLHQuaGVhcFsxXT10LmhlYXBbdC5oZWFwX2xlbi0tXSx0dCh0LGksMSksbj10LmhlYXBbMV0sdC5oZWFwWy0tdC5oZWFwX21heF09cix0LmhlYXBbLS10LmhlYXBfbWF4XT1uLGlbMiphXT1pWzIqcl0raVsyKm5dLHQuZGVwdGhbYV09KHQuZGVwdGhbcl0+PXQuZGVwdGhbbl0/dC5kZXB0aFtyXTp0LmRlcHRoW25dKSsxLGlbMipyKzFdPWlbMipuKzFdPWEsdC5oZWFwWzFdPWErKyx0dCh0LGksMSl9d2hpbGUodC5oZWFwX2xlbj49Mik7dC5oZWFwWy0tdC5oZWFwX21heF09dC5oZWFwWzFdLEcodCxlKSxXKGksaCx0LmJsX2NvdW50KX0sbnQ9ZnVuY3Rpb24odCxlLHIpe3ZhciBuLGEsaT0tMSxvPWVbMV0scz0wLGM9NyxoPTQ7Zm9yKDA9PT1vJiYoYz0xMzgsaD0zKSxlWzIqKHIrMSkrMV09NjU1MzUsbj0wO248PXI7bisrKWE9byxvPWVbMioobisxKSsxXSwrK3M8YyYmYT09PW98fChzPGg/dC5ibF90cmVlWzIqYV0rPXM6MCE9PWE/KGEhPT1pJiZ0LmJsX3RyZWVbMiphXSsrLHQuYmxfdHJlZVsyKnhdKyspOnM8PTEwP3QuYmxfdHJlZVsyKmtdKys6dC5ibF90cmVlWzIqel0rKyxzPTAsaT1hLDA9PT1vPyhjPTEzOCxoPTMpOmE9PT1vPyhjPTYsaD0zKTooYz03LGg9NCkpfSxhdD1mdW5jdGlvbih0LGUscil7dmFyIG4sYSxpPS0xLG89ZVsxXSxzPTAsYz03LGg9NDtmb3IoMD09PW8mJihjPTEzOCxoPTMpLG49MDtuPD1yO24rKylpZihhPW8sbz1lWzIqKG4rMSkrMV0sISgrK3M8YyYmYT09PW8pKXtpZihzPGgpZG97Syh0LGEsdC5ibF90cmVlKX13aGlsZSgwIT0tLXMpO2Vsc2UgMCE9PWE/KGEhPT1pJiYoSyh0LGEsdC5ibF90cmVlKSxzLS0pLEsodCx4LHQuYmxfdHJlZSksaih0LHMtMywyKSk6czw9MTA/KEsodCxrLHQuYmxfdHJlZSksaih0LHMtMywzKSk6KEsodCx6LHQuYmxfdHJlZSksaih0LHMtMTEsNykpO3M9MCxpPWEsMD09PW8/KGM9MTM4LGg9Myk6YT09PW8/KGM9NixoPTMpOihjPTcsaD00KX19LGl0PWZ1bmN0aW9uKHQpe3ZhciBlO2ZvcihudCh0LHQuZHluX2x0cmVlLHQubF9kZXNjLm1heF9jb2RlKSxudCh0LHQuZHluX2R0cmVlLHQuZF9kZXNjLm1heF9jb2RlKSxydCh0LHQuYmxfZGVzYyksZT1nLTE7ZT49MyYmMD09PXQuYmxfdHJlZVsyKkJbZV0rMV07ZS0tKTtyZXR1cm4gdC5vcHRfbGVuKz0zKihlKzEpKzUrNSs0LGV9LG90PWZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBhO2ZvcihqKHQsZS0yNTcsNSksaih0LHItMSw1KSxqKHQsbi00LDQpLGE9MDthPG47YSsrKWoodCx0LmJsX3RyZWVbMipCW2FdKzFdLDMpO2F0KHQsdC5keW5fbHRyZWUsZS0xKSxhdCh0LHQuZHluX2R0cmVlLHItMSl9LHN0PWZ1bmN0aW9uKHQpe3ZhciBlLHI9NDA5MzYyNDQ0Nztmb3IoZT0wO2U8PTMxO2UrKyxyPj4+PTEpaWYoMSZyJiYwIT09dC5keW5fbHRyZWVbMiplXSlyZXR1cm4gbjtpZigwIT09dC5keW5fbHRyZWVbMThdfHwwIT09dC5keW5fbHRyZWVbMjBdfHwwIT09dC5keW5fbHRyZWVbMjZdKXJldHVybiBhO2ZvcihlPTMyO2U8ZDtlKyspaWYoMCE9PXQuZHluX2x0cmVlWzIqZV0pcmV0dXJuIGE7cmV0dXJuIG59LGN0PSExLGh0PWZ1bmN0aW9uKHQsZSxyLG4pe2oodCwoczw8MSkrKG4/MTowKSwzKSxRKHQsZSxyLCEwKX0sbHQ9ZnVuY3Rpb24odCxlLG4sYSl7dmFyIG8scyxsPTA7dC5sZXZlbD4wPyh0LnN0cm0uZGF0YV90eXBlPT09aSYmKHQuc3RybS5kYXRhX3R5cGU9c3QodCkpLHJ0KHQsdC5sX2Rlc2MpLHJ0KHQsdC5kX2Rlc2MpLGw9aXQodCksbz10Lm9wdF9sZW4rMys3Pj4+Mywocz10LnN0YXRpY19sZW4rMys3Pj4+Myk8PW8mJihvPXMpKTpvPXM9bis1LG4rNDw9byYmLTEhPT1lP2h0KHQsZSxuLGEpOnQuc3RyYXRlZ3k9PT1yfHxzPT09bz8oaih0LChjPDwxKSsoYT8xOjApLDMpLGV0KHQsRCxMKSk6KGoodCwoaDw8MSkrKGE/MTowKSwzKSxvdCh0LHQubF9kZXNjLm1heF9jb2RlKzEsdC5kX2Rlc2MubWF4X2NvZGUrMSxsKzEpLGV0KHQsdC5keW5fbHRyZWUsdC5keW5fZHRyZWUpKSxWKHQpLGEmJiQodCl9LHV0PXtfdHJfaW5pdDpmdW5jdGlvbih0KXtjdHx8KFkoKSxjdD0hMCksdC5sX2Rlc2M9bmV3IEkodC5keW5fbHRyZWUsRiksdC5kX2Rlc2M9bmV3IEkodC5keW5fZHRyZWUsVCksdC5ibF9kZXNjPW5ldyBJKHQuYmxfdHJlZSxIKSx0LmJpX2J1Zj0wLHQuYmlfdmFsaWQ9MCxWKHQpfSxfdHJfc3RvcmVkX2Jsb2NrOmh0LF90cl9mbHVzaF9ibG9jazpsdCxfdHJfdGFsbHk6ZnVuY3Rpb24odCxlLHIpe3JldHVybiB0LnBlbmRpbmdfYnVmW3QuZF9idWYrMip0Lmxhc3RfbGl0XT1lPj4+OCYyNTUsdC5wZW5kaW5nX2J1Zlt0LmRfYnVmKzIqdC5sYXN0X2xpdCsxXT0yNTUmZSx0LnBlbmRpbmdfYnVmW3QubF9idWYrdC5sYXN0X2xpdF09MjU1JnIsdC5sYXN0X2xpdCsrLDA9PT1lP3QuZHluX2x0cmVlWzIqcl0rKzoodC5tYXRjaGVzKyssZS0tLHQuZHluX2x0cmVlWzIqKFVbcl0rZCsxKV0rKyx0LmR5bl9kdHJlZVsyKk4oZSldKyspLHQubGFzdF9saXQ9PT10LmxpdF9idWZzaXplLTF9LF90cl9hbGlnbjpmdW5jdGlvbih0KXtqKHQsYzw8MSwzKSxLKHQsYixEKSxxKHQpfX0sZnQ9ZnVuY3Rpb24odCxlLHIsbil7Zm9yKHZhciBhPTY1NTM1JnR8MCxpPXQ+Pj4xNiY2NTUzNXwwLG89MDswIT09cjspe3ItPW89cj4yZTM/MmUzOnI7ZG97aT1pKyhhPWErZVtuKytdfDApfDB9d2hpbGUoLS1vKTthJT02NTUyMSxpJT02NTUyMX1yZXR1cm4gYXxpPDwxNnwwfSxkdD1uZXcgVWludDMyQXJyYXkoZnVuY3Rpb24oKXtmb3IodmFyIHQsZT1bXSxyPTA7cjwyNTY7cisrKXt0PXI7Zm9yKHZhciBuPTA7bjw4O24rKyl0PTEmdD8zOTg4MjkyMzg0XnQ+Pj4xOnQ+Pj4xO2Vbcl09dH1yZXR1cm4gZX0oKSksX3Q9ZnVuY3Rpb24odCxlLHIsbil7dmFyIGE9ZHQsaT1uK3I7dF49LTE7Zm9yKHZhciBvPW47bzxpO28rKyl0PXQ+Pj44XmFbMjU1Jih0XmVbb10pXTtyZXR1cm4tMV50fSxwdD17MjoibmVlZCBkaWN0aW9uYXJ5IiwxOiJzdHJlYW0gZW5kIiwwOiIiLCItMSI6ImZpbGUgZXJyb3IiLCItMiI6InN0cmVhbSBlcnJvciIsIi0zIjoiZGF0YSBlcnJvciIsIi00IjoiaW5zdWZmaWNpZW50IG1lbW9yeSIsIi01IjoiYnVmZmVyIGVycm9yIiwiLTYiOiJpbmNvbXBhdGlibGUgdmVyc2lvbiJ9LGd0PXtaX05PX0ZMVVNIOjAsWl9QQVJUSUFMX0ZMVVNIOjEsWl9TWU5DX0ZMVVNIOjIsWl9GVUxMX0ZMVVNIOjMsWl9GSU5JU0g6NCxaX0JMT0NLOjUsWl9UUkVFUzo2LFpfT0s6MCxaX1NUUkVBTV9FTkQ6MSxaX05FRURfRElDVDoyLFpfRVJSTk86LTEsWl9TVFJFQU1fRVJST1I6LTIsWl9EQVRBX0VSUk9SOi0zLFpfTUVNX0VSUk9SOi00LFpfQlVGX0VSUk9SOi01LFpfTk9fQ09NUFJFU1NJT046MCxaX0JFU1RfU1BFRUQ6MSxaX0JFU1RfQ09NUFJFU1NJT046OSxaX0RFRkFVTFRfQ09NUFJFU1NJT046LTEsWl9GSUxURVJFRDoxLFpfSFVGRk1BTl9PTkxZOjIsWl9STEU6MyxaX0ZJWEVEOjQsWl9ERUZBVUxUX1NUUkFURUdZOjAsWl9CSU5BUlk6MCxaX1RFWFQ6MSxaX1VOS05PV046MixaX0RFRkxBVEVEOjh9LHZ0PXV0Ll90cl9pbml0LHl0PXV0Ll90cl9zdG9yZWRfYmxvY2ssd3Q9dXQuX3RyX2ZsdXNoX2Jsb2NrLG10PXV0Ll90cl90YWxseSxidD11dC5fdHJfYWxpZ24seHQ9Z3QuWl9OT19GTFVTSCxrdD1ndC5aX1BBUlRJQUxfRkxVU0gsenQ9Z3QuWl9GVUxMX0ZMVVNILEF0PWd0LlpfRklOSVNILFN0PWd0LlpfQkxPQ0ssRXQ9Z3QuWl9PSyxCdD1ndC5aX1NUUkVBTV9FTkQsUnQ9Z3QuWl9TVFJFQU1fRVJST1IsRHQ9Z3QuWl9EQVRBX0VSUk9SLEx0PWd0LlpfQlVGX0VSUk9SLE90PWd0LlpfREVGQVVMVF9DT01QUkVTU0lPTixVdD1ndC5aX0ZJTFRFUkVELEN0PWd0LlpfSFVGRk1BTl9PTkxZLEZ0PWd0LlpfUkxFLFR0PWd0LlpfRklYRUQsSHQ9Z3QuWl9ERUZBVUxUX1NUUkFURUdZLFp0PWd0LlpfVU5LTk9XTixNdD1ndC5aX0RFRkxBVEVELEl0PTksTnQ9MTUsUHQ9OCxqdD0yODYsS3Q9MzAsWHQ9MTkscXQ9MipqdCsxLEd0PTE1LFd0PTMsWXQ9MjU4LFZ0PVl0K1d0KzEsJHQ9MzIsUXQ9NDIsSnQ9NjksdGU9NzMsZWU9OTEscmU9MTAzLG5lPTExMyxhZT02NjYsaWU9MSxvZT0yLHNlPTMsY2U9NCxoZT0zLGxlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQubXNnPXB0W2VdLGV9LHVlPWZ1bmN0aW9uKHQpe3JldHVybih0PDwxKS0odD40Pzk6MCl9LGZlPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10Lmxlbmd0aDstLWU+PTA7KXRbZV09MH0sZGU9ZnVuY3Rpb24odCxlLHIpe3JldHVybihlPDx0Lmhhc2hfc2hpZnRecikmdC5oYXNoX21hc2t9LF9lPWZ1bmN0aW9uKHQpe3ZhciBlPXQuc3RhdGUscj1lLnBlbmRpbmc7cj50LmF2YWlsX291dCYmKHI9dC5hdmFpbF9vdXQpLDAhPT1yJiYodC5vdXRwdXQuc2V0KGUucGVuZGluZ19idWYuc3ViYXJyYXkoZS5wZW5kaW5nX291dCxlLnBlbmRpbmdfb3V0K3IpLHQubmV4dF9vdXQpLHQubmV4dF9vdXQrPXIsZS5wZW5kaW5nX291dCs9cix0LnRvdGFsX291dCs9cix0LmF2YWlsX291dC09cixlLnBlbmRpbmctPXIsMD09PWUucGVuZGluZyYmKGUucGVuZGluZ19vdXQ9MCkpfSxwZT1mdW5jdGlvbih0LGUpe3d0KHQsdC5ibG9ja19zdGFydD49MD90LmJsb2NrX3N0YXJ0Oi0xLHQuc3Ryc3RhcnQtdC5ibG9ja19zdGFydCxlKSx0LmJsb2NrX3N0YXJ0PXQuc3Ryc3RhcnQsX2UodC5zdHJtKX0sZ2U9ZnVuY3Rpb24odCxlKXt0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT1lfSx2ZT1mdW5jdGlvbih0LGUpe3QucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPWU+Pj44JjI1NSx0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmZX0seWU9ZnVuY3Rpb24odCxlLHIsbil7dmFyIGE9dC5hdmFpbF9pbjtyZXR1cm4gYT5uJiYoYT1uKSwwPT09YT8wOih0LmF2YWlsX2luLT1hLGUuc2V0KHQuaW5wdXQuc3ViYXJyYXkodC5uZXh0X2luLHQubmV4dF9pbithKSxyKSwxPT09dC5zdGF0ZS53cmFwP3QuYWRsZXI9ZnQodC5hZGxlcixlLGEscik6Mj09PXQuc3RhdGUud3JhcCYmKHQuYWRsZXI9X3QodC5hZGxlcixlLGEscikpLHQubmV4dF9pbis9YSx0LnRvdGFsX2luKz1hLGEpfSx3ZT1mdW5jdGlvbih0LGUpe3ZhciByLG4sYT10Lm1heF9jaGFpbl9sZW5ndGgsaT10LnN0cnN0YXJ0LG89dC5wcmV2X2xlbmd0aCxzPXQubmljZV9tYXRjaCxjPXQuc3Ryc3RhcnQ+dC53X3NpemUtVnQ/dC5zdHJzdGFydC0odC53X3NpemUtVnQpOjAsaD10LndpbmRvdyxsPXQud19tYXNrLHU9dC5wcmV2LGY9dC5zdHJzdGFydCtZdCxkPWhbaStvLTFdLF89aFtpK29dO3QucHJldl9sZW5ndGg+PXQuZ29vZF9tYXRjaCYmKGE+Pj0yKSxzPnQubG9va2FoZWFkJiYocz10Lmxvb2thaGVhZCk7ZG97aWYoaFsocj1lKStvXT09PV8mJmhbcitvLTFdPT09ZCYmaFtyXT09PWhbaV0mJmhbKytyXT09PWhbaSsxXSl7aSs9MixyKys7ZG97fXdoaWxlKGhbKytpXT09PWhbKytyXSYmaFsrK2ldPT09aFsrK3JdJiZoWysraV09PT1oWysrcl0mJmhbKytpXT09PWhbKytyXSYmaFsrK2ldPT09aFsrK3JdJiZoWysraV09PT1oWysrcl0mJmhbKytpXT09PWhbKytyXSYmaFsrK2ldPT09aFsrK3JdJiZpPGYpO2lmKG49WXQtKGYtaSksaT1mLVl0LG4+byl7aWYodC5tYXRjaF9zdGFydD1lLG89bixuPj1zKWJyZWFrO2Q9aFtpK28tMV0sXz1oW2krb119fX13aGlsZSgoZT11W2UmbF0pPmMmJjAhPS0tYSk7cmV0dXJuIG88PXQubG9va2FoZWFkP286dC5sb29rYWhlYWR9LG1lPWZ1bmN0aW9uKHQpe3ZhciBlLHIsbixhLGksbz10Lndfc2l6ZTtkb3tpZihhPXQud2luZG93X3NpemUtdC5sb29rYWhlYWQtdC5zdHJzdGFydCx0LnN0cnN0YXJ0Pj1vKyhvLVZ0KSl7dC53aW5kb3cuc2V0KHQud2luZG93LnN1YmFycmF5KG8sbytvKSwwKSx0Lm1hdGNoX3N0YXJ0LT1vLHQuc3Ryc3RhcnQtPW8sdC5ibG9ja19zdGFydC09byxlPXI9dC5oYXNoX3NpemU7ZG97bj10LmhlYWRbLS1lXSx0LmhlYWRbZV09bj49bz9uLW86MH13aGlsZSgtLXIpO2U9cj1vO2Rve249dC5wcmV2Wy0tZV0sdC5wcmV2W2VdPW4+PW8/bi1vOjB9d2hpbGUoLS1yKTthKz1vfWlmKDA9PT10LnN0cm0uYXZhaWxfaW4pYnJlYWs7aWYocj15ZSh0LnN0cm0sdC53aW5kb3csdC5zdHJzdGFydCt0Lmxvb2thaGVhZCxhKSx0Lmxvb2thaGVhZCs9cix0Lmxvb2thaGVhZCt0Lmluc2VydD49V3QpZm9yKGk9dC5zdHJzdGFydC10Lmluc2VydCx0Lmluc19oPXQud2luZG93W2ldLHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W2krMV0pO3QuaW5zZXJ0JiYodC5pbnNfaD1kZSh0LHQuaW5zX2gsdC53aW5kb3dbaStXdC0xXSksdC5wcmV2W2kmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09aSxpKyssdC5pbnNlcnQtLSwhKHQubG9va2FoZWFkK3QuaW5zZXJ0PFd0KSk7KTt9d2hpbGUodC5sb29rYWhlYWQ8VnQmJjAhPT10LnN0cm0uYXZhaWxfaW4pfSxiZT1mdW5jdGlvbih0LGUpe2Zvcih2YXIgcixuOzspe2lmKHQubG9va2FoZWFkPFZ0KXtpZihtZSh0KSx0Lmxvb2thaGVhZDxWdCYmZT09PXh0KXJldHVybiBpZTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9aWYocj0wLHQubG9va2FoZWFkPj1XdCYmKHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W3Quc3Ryc3RhcnQrV3QtMV0pLHI9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydCksMCE9PXImJnQuc3Ryc3RhcnQtcjw9dC53X3NpemUtVnQmJih0Lm1hdGNoX2xlbmd0aD13ZSh0LHIpKSx0Lm1hdGNoX2xlbmd0aD49V3QpaWYobj1tdCh0LHQuc3Ryc3RhcnQtdC5tYXRjaF9zdGFydCx0Lm1hdGNoX2xlbmd0aC1XdCksdC5sb29rYWhlYWQtPXQubWF0Y2hfbGVuZ3RoLHQubWF0Y2hfbGVuZ3RoPD10Lm1heF9sYXp5X21hdGNoJiZ0Lmxvb2thaGVhZD49V3Qpe3QubWF0Y2hfbGVuZ3RoLS07ZG97dC5zdHJzdGFydCsrLHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W3Quc3Ryc3RhcnQrV3QtMV0pLHI9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydH13aGlsZSgwIT0tLXQubWF0Y2hfbGVuZ3RoKTt0LnN0cnN0YXJ0Kyt9ZWxzZSB0LnN0cnN0YXJ0Kz10Lm1hdGNoX2xlbmd0aCx0Lm1hdGNoX2xlbmd0aD0wLHQuaW5zX2g9dC53aW5kb3dbdC5zdHJzdGFydF0sdC5pbnNfaD1kZSh0LHQuaW5zX2gsdC53aW5kb3dbdC5zdHJzdGFydCsxXSk7ZWxzZSBuPW10KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0XSksdC5sb29rYWhlYWQtLSx0LnN0cnN0YXJ0Kys7aWYobiYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gaWV9cmV0dXJuIHQuaW5zZXJ0PXQuc3Ryc3RhcnQ8V3QtMT90LnN0cnN0YXJ0Old0LTEsZT09PUF0PyhwZSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9zZTpjZSk6dC5sYXN0X2xpdCYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9pZTpvZX0seGU9ZnVuY3Rpb24odCxlKXtmb3IodmFyIHIsbixhOzspe2lmKHQubG9va2FoZWFkPFZ0KXtpZihtZSh0KSx0Lmxvb2thaGVhZDxWdCYmZT09PXh0KXJldHVybiBpZTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9aWYocj0wLHQubG9va2FoZWFkPj1XdCYmKHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W3Quc3Ryc3RhcnQrV3QtMV0pLHI9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydCksdC5wcmV2X2xlbmd0aD10Lm1hdGNoX2xlbmd0aCx0LnByZXZfbWF0Y2g9dC5tYXRjaF9zdGFydCx0Lm1hdGNoX2xlbmd0aD1XdC0xLDAhPT1yJiZ0LnByZXZfbGVuZ3RoPHQubWF4X2xhenlfbWF0Y2gmJnQuc3Ryc3RhcnQtcjw9dC53X3NpemUtVnQmJih0Lm1hdGNoX2xlbmd0aD13ZSh0LHIpLHQubWF0Y2hfbGVuZ3RoPD01JiYodC5zdHJhdGVneT09PVV0fHx0Lm1hdGNoX2xlbmd0aD09PVd0JiZ0LnN0cnN0YXJ0LXQubWF0Y2hfc3RhcnQ+NDA5NikmJih0Lm1hdGNoX2xlbmd0aD1XdC0xKSksdC5wcmV2X2xlbmd0aD49V3QmJnQubWF0Y2hfbGVuZ3RoPD10LnByZXZfbGVuZ3RoKXthPXQuc3Ryc3RhcnQrdC5sb29rYWhlYWQtV3Qsbj1tdCh0LHQuc3Ryc3RhcnQtMS10LnByZXZfbWF0Y2gsdC5wcmV2X2xlbmd0aC1XdCksdC5sb29rYWhlYWQtPXQucHJldl9sZW5ndGgtMSx0LnByZXZfbGVuZ3RoLT0yO2RveysrdC5zdHJzdGFydDw9YSYmKHQuaW5zX2g9ZGUodCx0Lmluc19oLHQud2luZG93W3Quc3Ryc3RhcnQrV3QtMV0pLHI9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydCl9d2hpbGUoMCE9LS10LnByZXZfbGVuZ3RoKTtpZih0Lm1hdGNoX2F2YWlsYWJsZT0wLHQubWF0Y2hfbGVuZ3RoPVd0LTEsdC5zdHJzdGFydCsrLG4mJihwZSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIGllfWVsc2UgaWYodC5tYXRjaF9hdmFpbGFibGUpe2lmKChuPW10KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0LTFdKSkmJnBlKHQsITEpLHQuc3Ryc3RhcnQrKyx0Lmxvb2thaGVhZC0tLDA9PT10LnN0cm0uYXZhaWxfb3V0KXJldHVybiBpZX1lbHNlIHQubWF0Y2hfYXZhaWxhYmxlPTEsdC5zdHJzdGFydCsrLHQubG9va2FoZWFkLS19cmV0dXJuIHQubWF0Y2hfYXZhaWxhYmxlJiYobj1tdCh0LDAsdC53aW5kb3dbdC5zdHJzdGFydC0xXSksdC5tYXRjaF9hdmFpbGFibGU9MCksdC5pbnNlcnQ9dC5zdHJzdGFydDxXdC0xP3Quc3Ryc3RhcnQ6V3QtMSxlPT09QXQ/KHBlKHQsITApLDA9PT10LnN0cm0uYXZhaWxfb3V0P3NlOmNlKTp0Lmxhc3RfbGl0JiYocGUodCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpP2llOm9lfSxrZT1mdW5jdGlvbih0LGUpe2Zvcih2YXIgcixuLGEsaSxvPXQud2luZG93Ozspe2lmKHQubG9va2FoZWFkPD1ZdCl7aWYobWUodCksdC5sb29rYWhlYWQ8PVl0JiZlPT09eHQpcmV0dXJuIGllO2lmKDA9PT10Lmxvb2thaGVhZClicmVha31pZih0Lm1hdGNoX2xlbmd0aD0wLHQubG9va2FoZWFkPj1XdCYmdC5zdHJzdGFydD4wJiYobj1vW2E9dC5zdHJzdGFydC0xXSk9PT1vWysrYV0mJm49PT1vWysrYV0mJm49PT1vWysrYV0pe2k9dC5zdHJzdGFydCtZdDtkb3t9d2hpbGUobj09PW9bKythXSYmbj09PW9bKythXSYmbj09PW9bKythXSYmbj09PW9bKythXSYmbj09PW9bKythXSYmbj09PW9bKythXSYmbj09PW9bKythXSYmbj09PW9bKythXSYmYTxpKTt0Lm1hdGNoX2xlbmd0aD1ZdC0oaS1hKSx0Lm1hdGNoX2xlbmd0aD50Lmxvb2thaGVhZCYmKHQubWF0Y2hfbGVuZ3RoPXQubG9va2FoZWFkKX1pZih0Lm1hdGNoX2xlbmd0aD49V3Q/KHI9bXQodCwxLHQubWF0Y2hfbGVuZ3RoLVd0KSx0Lmxvb2thaGVhZC09dC5tYXRjaF9sZW5ndGgsdC5zdHJzdGFydCs9dC5tYXRjaF9sZW5ndGgsdC5tYXRjaF9sZW5ndGg9MCk6KHI9bXQodCwwLHQud2luZG93W3Quc3Ryc3RhcnRdKSx0Lmxvb2thaGVhZC0tLHQuc3Ryc3RhcnQrKyksciYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gaWV9cmV0dXJuIHQuaW5zZXJ0PTAsZT09PUF0PyhwZSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9zZTpjZSk6dC5sYXN0X2xpdCYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT9pZTpvZX0semU9ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI7Oyl7aWYoMD09PXQubG9va2FoZWFkJiYobWUodCksMD09PXQubG9va2FoZWFkKSl7aWYoZT09PXh0KXJldHVybiBpZTticmVha31pZih0Lm1hdGNoX2xlbmd0aD0wLHI9bXQodCwwLHQud2luZG93W3Quc3Ryc3RhcnRdKSx0Lmxvb2thaGVhZC0tLHQuc3Ryc3RhcnQrKyxyJiYocGUodCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpKXJldHVybiBpZX1yZXR1cm4gdC5pbnNlcnQ9MCxlPT09QXQ/KHBlKHQsITApLDA9PT10LnN0cm0uYXZhaWxfb3V0P3NlOmNlKTp0Lmxhc3RfbGl0JiYocGUodCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpP2llOm9lfTtmdW5jdGlvbiBBZSh0LGUscixuLGEpe3RoaXMuZ29vZF9sZW5ndGg9dCx0aGlzLm1heF9sYXp5PWUsdGhpcy5uaWNlX2xlbmd0aD1yLHRoaXMubWF4X2NoYWluPW4sdGhpcy5mdW5jPWF9dmFyIFNlPVtuZXcgQWUoMCwwLDAsMCwoZnVuY3Rpb24odCxlKXt2YXIgcj02NTUzNTtmb3Iocj50LnBlbmRpbmdfYnVmX3NpemUtNSYmKHI9dC5wZW5kaW5nX2J1Zl9zaXplLTUpOzspe2lmKHQubG9va2FoZWFkPD0xKXtpZihtZSh0KSwwPT09dC5sb29rYWhlYWQmJmU9PT14dClyZXR1cm4gaWU7aWYoMD09PXQubG9va2FoZWFkKWJyZWFrfXQuc3Ryc3RhcnQrPXQubG9va2FoZWFkLHQubG9va2FoZWFkPTA7dmFyIG49dC5ibG9ja19zdGFydCtyO2lmKCgwPT09dC5zdHJzdGFydHx8dC5zdHJzdGFydD49bikmJih0Lmxvb2thaGVhZD10LnN0cnN0YXJ0LW4sdC5zdHJzdGFydD1uLHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gaWU7aWYodC5zdHJzdGFydC10LmJsb2NrX3N0YXJ0Pj10Lndfc2l6ZS1WdCYmKHBlKHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gaWV9cmV0dXJuIHQuaW5zZXJ0PTAsZT09PUF0PyhwZSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD9zZTpjZSk6KHQuc3Ryc3RhcnQ+dC5ibG9ja19zdGFydCYmKHBlKHQsITEpLHQuc3RybS5hdmFpbF9vdXQpLGllKX0pKSxuZXcgQWUoNCw0LDgsNCxiZSksbmV3IEFlKDQsNSwxNiw4LGJlKSxuZXcgQWUoNCw2LDMyLDMyLGJlKSxuZXcgQWUoNCw0LDE2LDE2LHhlKSxuZXcgQWUoOCwxNiwzMiwzMix4ZSksbmV3IEFlKDgsMTYsMTI4LDEyOCx4ZSksbmV3IEFlKDgsMzIsMTI4LDI1Nix4ZSksbmV3IEFlKDMyLDEyOCwyNTgsMTAyNCx4ZSksbmV3IEFlKDMyLDI1OCwyNTgsNDA5Nix4ZSldLEVlPWZ1bmN0aW9uKHQpe3Qud2luZG93X3NpemU9Mip0Lndfc2l6ZSxmZSh0LmhlYWQpLHQubWF4X2xhenlfbWF0Y2g9U2VbdC5sZXZlbF0ubWF4X2xhenksdC5nb29kX21hdGNoPVNlW3QubGV2ZWxdLmdvb2RfbGVuZ3RoLHQubmljZV9tYXRjaD1TZVt0LmxldmVsXS5uaWNlX2xlbmd0aCx0Lm1heF9jaGFpbl9sZW5ndGg9U2VbdC5sZXZlbF0ubWF4X2NoYWluLHQuc3Ryc3RhcnQ9MCx0LmJsb2NrX3N0YXJ0PTAsdC5sb29rYWhlYWQ9MCx0Lmluc2VydD0wLHQubWF0Y2hfbGVuZ3RoPXQucHJldl9sZW5ndGg9V3QtMSx0Lm1hdGNoX2F2YWlsYWJsZT0wLHQuaW5zX2g9MH07ZnVuY3Rpb24gQmUoKXt0aGlzLnN0cm09bnVsbCx0aGlzLnN0YXR1cz0wLHRoaXMucGVuZGluZ19idWY9bnVsbCx0aGlzLnBlbmRpbmdfYnVmX3NpemU9MCx0aGlzLnBlbmRpbmdfb3V0PTAsdGhpcy5wZW5kaW5nPTAsdGhpcy53cmFwPTAsdGhpcy5nemhlYWQ9bnVsbCx0aGlzLmd6aW5kZXg9MCx0aGlzLm1ldGhvZD1NdCx0aGlzLmxhc3RfZmx1c2g9LTEsdGhpcy53X3NpemU9MCx0aGlzLndfYml0cz0wLHRoaXMud19tYXNrPTAsdGhpcy53aW5kb3c9bnVsbCx0aGlzLndpbmRvd19zaXplPTAsdGhpcy5wcmV2PW51bGwsdGhpcy5oZWFkPW51bGwsdGhpcy5pbnNfaD0wLHRoaXMuaGFzaF9zaXplPTAsdGhpcy5oYXNoX2JpdHM9MCx0aGlzLmhhc2hfbWFzaz0wLHRoaXMuaGFzaF9zaGlmdD0wLHRoaXMuYmxvY2tfc3RhcnQ9MCx0aGlzLm1hdGNoX2xlbmd0aD0wLHRoaXMucHJldl9tYXRjaD0wLHRoaXMubWF0Y2hfYXZhaWxhYmxlPTAsdGhpcy5zdHJzdGFydD0wLHRoaXMubWF0Y2hfc3RhcnQ9MCx0aGlzLmxvb2thaGVhZD0wLHRoaXMucHJldl9sZW5ndGg9MCx0aGlzLm1heF9jaGFpbl9sZW5ndGg9MCx0aGlzLm1heF9sYXp5X21hdGNoPTAsdGhpcy5sZXZlbD0wLHRoaXMuc3RyYXRlZ3k9MCx0aGlzLmdvb2RfbWF0Y2g9MCx0aGlzLm5pY2VfbWF0Y2g9MCx0aGlzLmR5bl9sdHJlZT1uZXcgVWludDE2QXJyYXkoMipxdCksdGhpcy5keW5fZHRyZWU9bmV3IFVpbnQxNkFycmF5KDIqKDIqS3QrMSkpLHRoaXMuYmxfdHJlZT1uZXcgVWludDE2QXJyYXkoMiooMipYdCsxKSksZmUodGhpcy5keW5fbHRyZWUpLGZlKHRoaXMuZHluX2R0cmVlKSxmZSh0aGlzLmJsX3RyZWUpLHRoaXMubF9kZXNjPW51bGwsdGhpcy5kX2Rlc2M9bnVsbCx0aGlzLmJsX2Rlc2M9bnVsbCx0aGlzLmJsX2NvdW50PW5ldyBVaW50MTZBcnJheShHdCsxKSx0aGlzLmhlYXA9bmV3IFVpbnQxNkFycmF5KDIqanQrMSksZmUodGhpcy5oZWFwKSx0aGlzLmhlYXBfbGVuPTAsdGhpcy5oZWFwX21heD0wLHRoaXMuZGVwdGg9bmV3IFVpbnQxNkFycmF5KDIqanQrMSksZmUodGhpcy5kZXB0aCksdGhpcy5sX2J1Zj0wLHRoaXMubGl0X2J1ZnNpemU9MCx0aGlzLmxhc3RfbGl0PTAsdGhpcy5kX2J1Zj0wLHRoaXMub3B0X2xlbj0wLHRoaXMuc3RhdGljX2xlbj0wLHRoaXMubWF0Y2hlcz0wLHRoaXMuaW5zZXJ0PTAsdGhpcy5iaV9idWY9MCx0aGlzLmJpX3ZhbGlkPTB9dmFyIFJlPWZ1bmN0aW9uKHQpe2lmKCF0fHwhdC5zdGF0ZSlyZXR1cm4gbGUodCxSdCk7dC50b3RhbF9pbj10LnRvdGFsX291dD0wLHQuZGF0YV90eXBlPVp0O3ZhciBlPXQuc3RhdGU7cmV0dXJuIGUucGVuZGluZz0wLGUucGVuZGluZ19vdXQ9MCxlLndyYXA8MCYmKGUud3JhcD0tZS53cmFwKSxlLnN0YXR1cz1lLndyYXA/UXQ6bmUsdC5hZGxlcj0yPT09ZS53cmFwPzA6MSxlLmxhc3RfZmx1c2g9eHQsdnQoZSksRXR9LERlPWZ1bmN0aW9uKHQpe3ZhciBlPVJlKHQpO3JldHVybiBlPT09RXQmJkVlKHQuc3RhdGUpLGV9LExlPWZ1bmN0aW9uKHQsZSxyLG4sYSxpKXtpZighdClyZXR1cm4gUnQ7dmFyIG89MTtpZihlPT09T3QmJihlPTYpLG48MD8obz0wLG49LW4pOm4+MTUmJihvPTIsbi09MTYpLGE8MXx8YT5JdHx8ciE9PU10fHxuPDh8fG4+MTV8fGU8MHx8ZT45fHxpPDB8fGk+VHQpcmV0dXJuIGxlKHQsUnQpOzg9PT1uJiYobj05KTt2YXIgcz1uZXcgQmU7cmV0dXJuIHQuc3RhdGU9cyxzLnN0cm09dCxzLndyYXA9byxzLmd6aGVhZD1udWxsLHMud19iaXRzPW4scy53X3NpemU9MTw8cy53X2JpdHMscy53X21hc2s9cy53X3NpemUtMSxzLmhhc2hfYml0cz1hKzcscy5oYXNoX3NpemU9MTw8cy5oYXNoX2JpdHMscy5oYXNoX21hc2s9cy5oYXNoX3NpemUtMSxzLmhhc2hfc2hpZnQ9fn4oKHMuaGFzaF9iaXRzK1d0LTEpL1d0KSxzLndpbmRvdz1uZXcgVWludDhBcnJheSgyKnMud19zaXplKSxzLmhlYWQ9bmV3IFVpbnQxNkFycmF5KHMuaGFzaF9zaXplKSxzLnByZXY9bmV3IFVpbnQxNkFycmF5KHMud19zaXplKSxzLmxpdF9idWZzaXplPTE8PGErNixzLnBlbmRpbmdfYnVmX3NpemU9NCpzLmxpdF9idWZzaXplLHMucGVuZGluZ19idWY9bmV3IFVpbnQ4QXJyYXkocy5wZW5kaW5nX2J1Zl9zaXplKSxzLmRfYnVmPTEqcy5saXRfYnVmc2l6ZSxzLmxfYnVmPTMqcy5saXRfYnVmc2l6ZSxzLmxldmVsPWUscy5zdHJhdGVneT1pLHMubWV0aG9kPXIsRGUodCl9LE9lPXtkZWZsYXRlSW5pdDpmdW5jdGlvbih0LGUpe3JldHVybiBMZSh0LGUsTXQsTnQsUHQsSHQpfSxkZWZsYXRlSW5pdDI6TGUsZGVmbGF0ZVJlc2V0OkRlLGRlZmxhdGVSZXNldEtlZXA6UmUsZGVmbGF0ZVNldEhlYWRlcjpmdW5jdGlvbih0LGUpe3JldHVybiB0JiZ0LnN0YXRlPzIhPT10LnN0YXRlLndyYXA/UnQ6KHQuc3RhdGUuZ3poZWFkPWUsRXQpOlJ0fSxkZWZsYXRlOmZ1bmN0aW9uKHQsZSl7dmFyIHIsbjtpZighdHx8IXQuc3RhdGV8fGU+U3R8fGU8MClyZXR1cm4gdD9sZSh0LFJ0KTpSdDt2YXIgYT10LnN0YXRlO2lmKCF0Lm91dHB1dHx8IXQuaW5wdXQmJjAhPT10LmF2YWlsX2lufHxhLnN0YXR1cz09PWFlJiZlIT09QXQpcmV0dXJuIGxlKHQsMD09PXQuYXZhaWxfb3V0P0x0OlJ0KTthLnN0cm09dDt2YXIgaT1hLmxhc3RfZmx1c2g7aWYoYS5sYXN0X2ZsdXNoPWUsYS5zdGF0dXM9PT1RdClpZigyPT09YS53cmFwKXQuYWRsZXI9MCxnZShhLDMxKSxnZShhLDEzOSksZ2UoYSw4KSxhLmd6aGVhZD8oZ2UoYSwoYS5nemhlYWQudGV4dD8xOjApKyhhLmd6aGVhZC5oY3JjPzI6MCkrKGEuZ3poZWFkLmV4dHJhPzQ6MCkrKGEuZ3poZWFkLm5hbWU/ODowKSsoYS5nemhlYWQuY29tbWVudD8xNjowKSksZ2UoYSwyNTUmYS5nemhlYWQudGltZSksZ2UoYSxhLmd6aGVhZC50aW1lPj44JjI1NSksZ2UoYSxhLmd6aGVhZC50aW1lPj4xNiYyNTUpLGdlKGEsYS5nemhlYWQudGltZT4+MjQmMjU1KSxnZShhLDk9PT1hLmxldmVsPzI6YS5zdHJhdGVneT49Q3R8fGEubGV2ZWw8Mj80OjApLGdlKGEsMjU1JmEuZ3poZWFkLm9zKSxhLmd6aGVhZC5leHRyYSYmYS5nemhlYWQuZXh0cmEubGVuZ3RoJiYoZ2UoYSwyNTUmYS5nemhlYWQuZXh0cmEubGVuZ3RoKSxnZShhLGEuZ3poZWFkLmV4dHJhLmxlbmd0aD4+OCYyNTUpKSxhLmd6aGVhZC5oY3JjJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLDApKSxhLmd6aW5kZXg9MCxhLnN0YXR1cz1KdCk6KGdlKGEsMCksZ2UoYSwwKSxnZShhLDApLGdlKGEsMCksZ2UoYSwwKSxnZShhLDk9PT1hLmxldmVsPzI6YS5zdHJhdGVneT49Q3R8fGEubGV2ZWw8Mj80OjApLGdlKGEsaGUpLGEuc3RhdHVzPW5lKTtlbHNle3ZhciBvPU10KyhhLndfYml0cy04PDw0KTw8ODtvfD0oYS5zdHJhdGVneT49Q3R8fGEubGV2ZWw8Mj8wOmEubGV2ZWw8Nj8xOjY9PT1hLmxldmVsPzI6Myk8PDYsMCE9PWEuc3Ryc3RhcnQmJihvfD0kdCksbys9MzEtbyUzMSxhLnN0YXR1cz1uZSx2ZShhLG8pLDAhPT1hLnN0cnN0YXJ0JiYodmUoYSx0LmFkbGVyPj4+MTYpLHZlKGEsNjU1MzUmdC5hZGxlcikpLHQuYWRsZXI9MX1pZihhLnN0YXR1cz09PUp0KWlmKGEuZ3poZWFkLmV4dHJhKXtmb3Iocj1hLnBlbmRpbmc7YS5nemluZGV4PCg2NTUzNSZhLmd6aGVhZC5leHRyYS5sZW5ndGgpJiYoYS5wZW5kaW5nIT09YS5wZW5kaW5nX2J1Zl9zaXplfHwoYS5nemhlYWQuaGNyYyYmYS5wZW5kaW5nPnImJih0LmFkbGVyPV90KHQuYWRsZXIsYS5wZW5kaW5nX2J1ZixhLnBlbmRpbmctcixyKSksX2UodCkscj1hLnBlbmRpbmcsYS5wZW5kaW5nIT09YS5wZW5kaW5nX2J1Zl9zaXplKSk7KWdlKGEsMjU1JmEuZ3poZWFkLmV4dHJhW2EuZ3ppbmRleF0pLGEuZ3ppbmRleCsrO2EuZ3poZWFkLmhjcmMmJmEucGVuZGluZz5yJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLXIscikpLGEuZ3ppbmRleD09PWEuZ3poZWFkLmV4dHJhLmxlbmd0aCYmKGEuZ3ppbmRleD0wLGEuc3RhdHVzPXRlKX1lbHNlIGEuc3RhdHVzPXRlO2lmKGEuc3RhdHVzPT09dGUpaWYoYS5nemhlYWQubmFtZSl7cj1hLnBlbmRpbmc7ZG97aWYoYS5wZW5kaW5nPT09YS5wZW5kaW5nX2J1Zl9zaXplJiYoYS5nemhlYWQuaGNyYyYmYS5wZW5kaW5nPnImJih0LmFkbGVyPV90KHQuYWRsZXIsYS5wZW5kaW5nX2J1ZixhLnBlbmRpbmctcixyKSksX2UodCkscj1hLnBlbmRpbmcsYS5wZW5kaW5nPT09YS5wZW5kaW5nX2J1Zl9zaXplKSl7bj0xO2JyZWFrfW49YS5nemluZGV4PGEuZ3poZWFkLm5hbWUubGVuZ3RoPzI1NSZhLmd6aGVhZC5uYW1lLmNoYXJDb2RlQXQoYS5nemluZGV4KyspOjAsZ2UoYSxuKX13aGlsZSgwIT09bik7YS5nemhlYWQuaGNyYyYmYS5wZW5kaW5nPnImJih0LmFkbGVyPV90KHQuYWRsZXIsYS5wZW5kaW5nX2J1ZixhLnBlbmRpbmctcixyKSksMD09PW4mJihhLmd6aW5kZXg9MCxhLnN0YXR1cz1lZSl9ZWxzZSBhLnN0YXR1cz1lZTtpZihhLnN0YXR1cz09PWVlKWlmKGEuZ3poZWFkLmNvbW1lbnQpe3I9YS5wZW5kaW5nO2Rve2lmKGEucGVuZGluZz09PWEucGVuZGluZ19idWZfc2l6ZSYmKGEuZ3poZWFkLmhjcmMmJmEucGVuZGluZz5yJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLXIscikpLF9lKHQpLHI9YS5wZW5kaW5nLGEucGVuZGluZz09PWEucGVuZGluZ19idWZfc2l6ZSkpe249MTticmVha31uPWEuZ3ppbmRleDxhLmd6aGVhZC5jb21tZW50Lmxlbmd0aD8yNTUmYS5nemhlYWQuY29tbWVudC5jaGFyQ29kZUF0KGEuZ3ppbmRleCsrKTowLGdlKGEsbil9d2hpbGUoMCE9PW4pO2EuZ3poZWFkLmhjcmMmJmEucGVuZGluZz5yJiYodC5hZGxlcj1fdCh0LmFkbGVyLGEucGVuZGluZ19idWYsYS5wZW5kaW5nLXIscikpLDA9PT1uJiYoYS5zdGF0dXM9cmUpfWVsc2UgYS5zdGF0dXM9cmU7aWYoYS5zdGF0dXM9PT1yZSYmKGEuZ3poZWFkLmhjcmM/KGEucGVuZGluZysyPmEucGVuZGluZ19idWZfc2l6ZSYmX2UodCksYS5wZW5kaW5nKzI8PWEucGVuZGluZ19idWZfc2l6ZSYmKGdlKGEsMjU1JnQuYWRsZXIpLGdlKGEsdC5hZGxlcj4+OCYyNTUpLHQuYWRsZXI9MCxhLnN0YXR1cz1uZSkpOmEuc3RhdHVzPW5lKSwwIT09YS5wZW5kaW5nKXtpZihfZSh0KSwwPT09dC5hdmFpbF9vdXQpcmV0dXJuIGEubGFzdF9mbHVzaD0tMSxFdH1lbHNlIGlmKDA9PT10LmF2YWlsX2luJiZ1ZShlKTw9dWUoaSkmJmUhPT1BdClyZXR1cm4gbGUodCxMdCk7aWYoYS5zdGF0dXM9PT1hZSYmMCE9PXQuYXZhaWxfaW4pcmV0dXJuIGxlKHQsTHQpO2lmKDAhPT10LmF2YWlsX2lufHwwIT09YS5sb29rYWhlYWR8fGUhPT14dCYmYS5zdGF0dXMhPT1hZSl7dmFyIHM9YS5zdHJhdGVneT09PUN0P3plKGEsZSk6YS5zdHJhdGVneT09PUZ0P2tlKGEsZSk6U2VbYS5sZXZlbF0uZnVuYyhhLGUpO2lmKHMhPT1zZSYmcyE9PWNlfHwoYS5zdGF0dXM9YWUpLHM9PT1pZXx8cz09PXNlKXJldHVybiAwPT09dC5hdmFpbF9vdXQmJihhLmxhc3RfZmx1c2g9LTEpLEV0O2lmKHM9PT1vZSYmKGU9PT1rdD9idChhKTplIT09U3QmJih5dChhLDAsMCwhMSksZT09PXp0JiYoZmUoYS5oZWFkKSwwPT09YS5sb29rYWhlYWQmJihhLnN0cnN0YXJ0PTAsYS5ibG9ja19zdGFydD0wLGEuaW5zZXJ0PTApKSksX2UodCksMD09PXQuYXZhaWxfb3V0KSlyZXR1cm4gYS5sYXN0X2ZsdXNoPS0xLEV0fXJldHVybiBlIT09QXQ/RXQ6YS53cmFwPD0wP0J0OigyPT09YS53cmFwPyhnZShhLDI1NSZ0LmFkbGVyKSxnZShhLHQuYWRsZXI+PjgmMjU1KSxnZShhLHQuYWRsZXI+PjE2JjI1NSksZ2UoYSx0LmFkbGVyPj4yNCYyNTUpLGdlKGEsMjU1JnQudG90YWxfaW4pLGdlKGEsdC50b3RhbF9pbj4+OCYyNTUpLGdlKGEsdC50b3RhbF9pbj4+MTYmMjU1KSxnZShhLHQudG90YWxfaW4+PjI0JjI1NSkpOih2ZShhLHQuYWRsZXI+Pj4xNiksdmUoYSw2NTUzNSZ0LmFkbGVyKSksX2UodCksYS53cmFwPjAmJihhLndyYXA9LWEud3JhcCksMCE9PWEucGVuZGluZz9FdDpCdCl9LGRlZmxhdGVFbmQ6ZnVuY3Rpb24odCl7aWYoIXR8fCF0LnN0YXRlKXJldHVybiBSdDt2YXIgZT10LnN0YXRlLnN0YXR1cztyZXR1cm4gZSE9PVF0JiZlIT09SnQmJmUhPT10ZSYmZSE9PWVlJiZlIT09cmUmJmUhPT1uZSYmZSE9PWFlP2xlKHQsUnQpOih0LnN0YXRlPW51bGwsZT09PW5lP2xlKHQsRHQpOkV0KX0sZGVmbGF0ZVNldERpY3Rpb25hcnk6ZnVuY3Rpb24odCxlKXt2YXIgcj1lLmxlbmd0aDtpZighdHx8IXQuc3RhdGUpcmV0dXJuIFJ0O3ZhciBuPXQuc3RhdGUsYT1uLndyYXA7aWYoMj09PWF8fDE9PT1hJiZuLnN0YXR1cyE9PVF0fHxuLmxvb2thaGVhZClyZXR1cm4gUnQ7aWYoMT09PWEmJih0LmFkbGVyPWZ0KHQuYWRsZXIsZSxyLDApKSxuLndyYXA9MCxyPj1uLndfc2l6ZSl7MD09PWEmJihmZShuLmhlYWQpLG4uc3Ryc3RhcnQ9MCxuLmJsb2NrX3N0YXJ0PTAsbi5pbnNlcnQ9MCk7dmFyIGk9bmV3IFVpbnQ4QXJyYXkobi53X3NpemUpO2kuc2V0KGUuc3ViYXJyYXkoci1uLndfc2l6ZSxyKSwwKSxlPWkscj1uLndfc2l6ZX12YXIgbz10LmF2YWlsX2luLHM9dC5uZXh0X2luLGM9dC5pbnB1dDtmb3IodC5hdmFpbF9pbj1yLHQubmV4dF9pbj0wLHQuaW5wdXQ9ZSxtZShuKTtuLmxvb2thaGVhZD49V3Q7KXt2YXIgaD1uLnN0cnN0YXJ0LGw9bi5sb29rYWhlYWQtKFd0LTEpO2Rve24uaW5zX2g9ZGUobixuLmluc19oLG4ud2luZG93W2grV3QtMV0pLG4ucHJldltoJm4ud19tYXNrXT1uLmhlYWRbbi5pbnNfaF0sbi5oZWFkW24uaW5zX2hdPWgsaCsrfXdoaWxlKC0tbCk7bi5zdHJzdGFydD1oLG4ubG9va2FoZWFkPVd0LTEsbWUobil9cmV0dXJuIG4uc3Ryc3RhcnQrPW4ubG9va2FoZWFkLG4uYmxvY2tfc3RhcnQ9bi5zdHJzdGFydCxuLmluc2VydD1uLmxvb2thaGVhZCxuLmxvb2thaGVhZD0wLG4ubWF0Y2hfbGVuZ3RoPW4ucHJldl9sZW5ndGg9V3QtMSxuLm1hdGNoX2F2YWlsYWJsZT0wLHQubmV4dF9pbj1zLHQuaW5wdXQ9Yyx0LmF2YWlsX2luPW8sbi53cmFwPWEsRXR9LGRlZmxhdGVJbmZvOiJwYWtvIGRlZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpIn0sVWU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9LENlPXthc3NpZ246ZnVuY3Rpb24oZSl7Zm9yKHZhciByPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKTtyLmxlbmd0aDspe3ZhciBuPXIuc2hpZnQoKTtpZihuKXtpZigib2JqZWN0IiE9PXQobikpdGhyb3cgbmV3IFR5cGVFcnJvcihuKyJtdXN0IGJlIG5vbi1vYmplY3QiKTtmb3IodmFyIGEgaW4gbilVZShuLGEpJiYoZVthXT1uW2FdKX19cmV0dXJuIGV9LGZsYXR0ZW5DaHVua3M6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAscj0wLG49dC5sZW5ndGg7cjxuO3IrKyllKz10W3JdLmxlbmd0aDtmb3IodmFyIGE9bmV3IFVpbnQ4QXJyYXkoZSksaT0wLG89MCxzPXQubGVuZ3RoO2k8cztpKyspe3ZhciBjPXRbaV07YS5zZXQoYyxvKSxvKz1jLmxlbmd0aH1yZXR1cm4gYX19LEZlPSEwO3RyeXtTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoMSkpfWNhdGNoKHQpe0ZlPSExfWZvcih2YXIgVGU9bmV3IFVpbnQ4QXJyYXkoMjU2KSxIZT0wO0hlPDI1NjtIZSsrKVRlW0hlXT1IZT49MjUyPzY6SGU+PTI0OD81OkhlPj0yNDA/NDpIZT49MjI0PzM6SGU+PTE5Mj8yOjE7VGVbMjU0XT1UZVsyNTRdPTE7dmFyIFplPWZ1bmN0aW9uKHQsZSl7aWYoZTw2NTUzNCYmdC5zdWJhcnJheSYmRmUpcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCx0Lmxlbmd0aD09PWU/dDp0LnN1YmFycmF5KDAsZSkpO2Zvcih2YXIgcj0iIixuPTA7bjxlO24rKylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRbbl0pO3JldHVybiByfSxNZT17c3RyaW5nMmJ1ZjpmdW5jdGlvbih0KXtpZigiZnVuY3Rpb24iPT10eXBlb2YgVGV4dEVuY29kZXImJlRleHRFbmNvZGVyLnByb3RvdHlwZS5lbmNvZGUpcmV0dXJuKG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKHQpO3ZhciBlLHIsbixhLGksbz10Lmxlbmd0aCxzPTA7Zm9yKGE9MDthPG87YSsrKTU1Mjk2PT0oNjQ1MTImKHI9dC5jaGFyQ29kZUF0KGEpKSkmJmErMTxvJiY1NjMyMD09KDY0NTEyJihuPXQuY2hhckNvZGVBdChhKzEpKSkmJihyPTY1NTM2KyhyLTU1Mjk2PDwxMCkrKG4tNTYzMjApLGErKykscys9cjwxMjg/MTpyPDIwNDg/MjpyPDY1NTM2PzM6NDtmb3IoZT1uZXcgVWludDhBcnJheShzKSxpPTAsYT0wO2k8czthKyspNTUyOTY9PSg2NDUxMiYocj10LmNoYXJDb2RlQXQoYSkpKSYmYSsxPG8mJjU2MzIwPT0oNjQ1MTImKG49dC5jaGFyQ29kZUF0KGErMSkpKSYmKHI9NjU1MzYrKHItNTUyOTY8PDEwKSsobi01NjMyMCksYSsrKSxyPDEyOD9lW2krK109cjpyPDIwNDg/KGVbaSsrXT0xOTJ8cj4+PjYsZVtpKytdPTEyOHw2MyZyKTpyPDY1NTM2PyhlW2krK109MjI0fHI+Pj4xMixlW2krK109MTI4fHI+Pj42JjYzLGVbaSsrXT0xMjh8NjMmcik6KGVbaSsrXT0yNDB8cj4+PjE4LGVbaSsrXT0xMjh8cj4+PjEyJjYzLGVbaSsrXT0xMjh8cj4+PjYmNjMsZVtpKytdPTEyOHw2MyZyKTtyZXR1cm4gZX0sYnVmMnN0cmluZzpmdW5jdGlvbih0LGUpe3ZhciByLG4sYT1lfHx0Lmxlbmd0aDtpZigiZnVuY3Rpb24iPT10eXBlb2YgVGV4dERlY29kZXImJlRleHREZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUpcmV0dXJuKG5ldyBUZXh0RGVjb2RlcikuZGVjb2RlKHQuc3ViYXJyYXkoMCxlKSk7dmFyIGk9bmV3IEFycmF5KDIqYSk7Zm9yKG49MCxyPTA7cjxhOyl7dmFyIG89dFtyKytdO2lmKG88MTI4KWlbbisrXT1vO2Vsc2V7dmFyIHM9VGVbb107aWYocz40KWlbbisrXT02NTUzMyxyKz1zLTE7ZWxzZXtmb3IobyY9Mj09PXM/MzE6Mz09PXM/MTU6NztzPjEmJnI8YTspbz1vPDw2fDYzJnRbcisrXSxzLS07cz4xP2lbbisrXT02NTUzMzpvPDY1NTM2P2lbbisrXT1vOihvLT02NTUzNixpW24rK109NTUyOTZ8bz4+MTAmMTAyMyxpW24rK109NTYzMjB8MTAyMyZvKX19fXJldHVybiBaZShpLG4pfSx1dGY4Ym9yZGVyOmZ1bmN0aW9uKHQsZSl7KGU9ZXx8dC5sZW5ndGgpPnQubGVuZ3RoJiYoZT10Lmxlbmd0aCk7Zm9yKHZhciByPWUtMTtyPj0wJiYxMjg9PSgxOTImdFtyXSk7KXItLTtyZXR1cm4gcjwwfHwwPT09cj9lOnIrVGVbdFtyXV0+ZT9yOmV9fTtmdW5jdGlvbiBJZSgpe3RoaXMuaW5wdXQ9bnVsbCx0aGlzLm5leHRfaW49MCx0aGlzLmF2YWlsX2luPTAsdGhpcy50b3RhbF9pbj0wLHRoaXMub3V0cHV0PW51bGwsdGhpcy5uZXh0X291dD0wLHRoaXMuYXZhaWxfb3V0PTAsdGhpcy50b3RhbF9vdXQ9MCx0aGlzLm1zZz0iIix0aGlzLnN0YXRlPW51bGwsdGhpcy5kYXRhX3R5cGU9Mix0aGlzLmFkbGVyPTB9dmFyIE5lPUllLFBlPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsamU9Z3QuWl9OT19GTFVTSCxLZT1ndC5aX1NZTkNfRkxVU0gsWGU9Z3QuWl9GVUxMX0ZMVVNILHFlPWd0LlpfRklOSVNILEdlPWd0LlpfT0ssV2U9Z3QuWl9TVFJFQU1fRU5ELFllPWd0LlpfREVGQVVMVF9DT01QUkVTU0lPTixWZT1ndC5aX0RFRkFVTFRfU1RSQVRFR1ksJGU9Z3QuWl9ERUZMQVRFRDtmdW5jdGlvbiBRZSh0KXt0aGlzLm9wdGlvbnM9Q2UuYXNzaWduKHtsZXZlbDpZZSxtZXRob2Q6JGUsY2h1bmtTaXplOjE2Mzg0LHdpbmRvd0JpdHM6MTUsbWVtTGV2ZWw6OCxzdHJhdGVneTpWZX0sdHx8e30pO3ZhciBlPXRoaXMub3B0aW9ucztlLnJhdyYmZS53aW5kb3dCaXRzPjA/ZS53aW5kb3dCaXRzPS1lLndpbmRvd0JpdHM6ZS5nemlwJiZlLndpbmRvd0JpdHM+MCYmZS53aW5kb3dCaXRzPDE2JiYoZS53aW5kb3dCaXRzKz0xNiksdGhpcy5lcnI9MCx0aGlzLm1zZz0iIix0aGlzLmVuZGVkPSExLHRoaXMuY2h1bmtzPVtdLHRoaXMuc3RybT1uZXcgTmUsdGhpcy5zdHJtLmF2YWlsX291dD0wO3ZhciByPU9lLmRlZmxhdGVJbml0Mih0aGlzLnN0cm0sZS5sZXZlbCxlLm1ldGhvZCxlLndpbmRvd0JpdHMsZS5tZW1MZXZlbCxlLnN0cmF0ZWd5KTtpZihyIT09R2UpdGhyb3cgbmV3IEVycm9yKHB0W3JdKTtpZihlLmhlYWRlciYmT2UuZGVmbGF0ZVNldEhlYWRlcih0aGlzLnN0cm0sZS5oZWFkZXIpLGUuZGljdGlvbmFyeSl7dmFyIG47aWYobj0ic3RyaW5nIj09dHlwZW9mIGUuZGljdGlvbmFyeT9NZS5zdHJpbmcyYnVmKGUuZGljdGlvbmFyeSk6IltvYmplY3QgQXJyYXlCdWZmZXJdIj09PVBlLmNhbGwoZS5kaWN0aW9uYXJ5KT9uZXcgVWludDhBcnJheShlLmRpY3Rpb25hcnkpOmUuZGljdGlvbmFyeSwocj1PZS5kZWZsYXRlU2V0RGljdGlvbmFyeSh0aGlzLnN0cm0sbikpIT09R2UpdGhyb3cgbmV3IEVycm9yKHB0W3JdKTt0aGlzLl9kaWN0X3NldD0hMH19ZnVuY3Rpb24gSmUodCxlKXt2YXIgcj1uZXcgUWUoZSk7aWYoci5wdXNoKHQsITApLHIuZXJyKXRocm93IHIubXNnfHxwdFtyLmVycl07cmV0dXJuIHIucmVzdWx0fWZ1bmN0aW9uIHRyKHQsZSl7cmV0dXJuKGU9ZXx8e30pLnJhdz0hMCxKZSh0LGUpfWZ1bmN0aW9uIGVyKHQsZSl7cmV0dXJuKGU9ZXx8e30pLmd6aXA9ITAsSmUodCxlKX1RZS5wcm90b3R5cGUucHVzaD1mdW5jdGlvbih0LGUpe3ZhciByLG4sYT10aGlzLnN0cm0saT10aGlzLm9wdGlvbnMuY2h1bmtTaXplO2lmKHRoaXMuZW5kZWQpcmV0dXJuITE7Zm9yKG49ZT09PX5+ZT9lOiEwPT09ZT9xZTpqZSwic3RyaW5nIj09dHlwZW9mIHQ/YS5pbnB1dD1NZS5zdHJpbmcyYnVmKHQpOiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT1QZS5jYWxsKHQpP2EuaW5wdXQ9bmV3IFVpbnQ4QXJyYXkodCk6YS5pbnB1dD10LGEubmV4dF9pbj0wLGEuYXZhaWxfaW49YS5pbnB1dC5sZW5ndGg7OylpZigwPT09YS5hdmFpbF9vdXQmJihhLm91dHB1dD1uZXcgVWludDhBcnJheShpKSxhLm5leHRfb3V0PTAsYS5hdmFpbF9vdXQ9aSksKG49PT1LZXx8bj09PVhlKSYmYS5hdmFpbF9vdXQ8PTYpdGhpcy5vbkRhdGEoYS5vdXRwdXQuc3ViYXJyYXkoMCxhLm5leHRfb3V0KSksYS5hdmFpbF9vdXQ9MDtlbHNle2lmKChyPU9lLmRlZmxhdGUoYSxuKSk9PT1XZSlyZXR1cm4gYS5uZXh0X291dD4wJiZ0aGlzLm9uRGF0YShhLm91dHB1dC5zdWJhcnJheSgwLGEubmV4dF9vdXQpKSxyPU9lLmRlZmxhdGVFbmQodGhpcy5zdHJtKSx0aGlzLm9uRW5kKHIpLHRoaXMuZW5kZWQ9ITAscj09PUdlO2lmKDAhPT1hLmF2YWlsX291dCl7aWYobj4wJiZhLm5leHRfb3V0PjApdGhpcy5vbkRhdGEoYS5vdXRwdXQuc3ViYXJyYXkoMCxhLm5leHRfb3V0KSksYS5hdmFpbF9vdXQ9MDtlbHNlIGlmKDA9PT1hLmF2YWlsX2luKWJyZWFrfWVsc2UgdGhpcy5vbkRhdGEoYS5vdXRwdXQpfXJldHVybiEwfSxRZS5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKHQpe3RoaXMuY2h1bmtzLnB1c2godCl9LFFlLnByb3RvdHlwZS5vbkVuZD1mdW5jdGlvbih0KXt0PT09R2UmJih0aGlzLnJlc3VsdD1DZS5mbGF0dGVuQ2h1bmtzKHRoaXMuY2h1bmtzKSksdGhpcy5jaHVua3M9W10sdGhpcy5lcnI9dCx0aGlzLm1zZz10aGlzLnN0cm0ubXNnfTt2YXIgcnI9UWUsbnI9SmUsYXI9dHIsaXI9ZXIsb3I9Z3Qsc3I9e0RlZmxhdGU6cnIsZGVmbGF0ZTpucixkZWZsYXRlUmF3OmFyLGd6aXA6aXIsY29uc3RhbnRzOm9yfTtlLkRlZmxhdGU9cnIsZS5jb25zdGFudHM9b3IsZS5kZWZhdWx0PXNyLGUuZGVmbGF0ZT1ucixlLmRlZmxhdGVSYXc9YXIsZS5nemlwPWlyLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KX0pKG8uZXhwb3J0cyk7dmFyIHMsYz17ZXhwb3J0czp7fX0saD17ZXhwb3J0czp7fX07aC5leHBvcnRzPXM9c3x8ZnVuY3Rpb24odCxlKXt2YXIgcjtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93LmNyeXB0byYmKHI9d2luZG93LmNyeXB0byksInVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmJiZzZWxmLmNyeXB0byYmKHI9c2VsZi5jcnlwdG8pLCJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsVGhpcyYmZ2xvYmFsVGhpcy5jcnlwdG8mJihyPWdsb2JhbFRoaXMuY3J5cHRvKSwhciYmInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5tc0NyeXB0byYmKHI9d2luZG93Lm1zQ3J5cHRvKSwhciYmdm9pZCAwIT09aSYmaS5jcnlwdG8mJihyPWkuY3J5cHRvKSwhcil0cnl7cj1yZXF1aXJlKCJjcnlwdG8iKX1jYXRjaCh0KXt9dmFyIG49ZnVuY3Rpb24oKXtpZihyKXtpZigiZnVuY3Rpb24iPT10eXBlb2Ygci5nZXRSYW5kb21WYWx1ZXMpdHJ5e3JldHVybiByLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDMyQXJyYXkoMSkpWzBdfWNhdGNoKHQpe31pZigiZnVuY3Rpb24iPT10eXBlb2Ygci5yYW5kb21CeXRlcyl0cnl7cmV0dXJuIHIucmFuZG9tQnl0ZXMoNCkucmVhZEludDMyTEUoKX1jYXRjaCh0KXt9fXRocm93IG5ldyBFcnJvcigiTmF0aXZlIGNyeXB0byBtb2R1bGUgY291bGQgbm90IGJlIHVzZWQgdG8gZ2V0IHNlY3VyZSByYW5kb20gbnVtYmVyLiIpfSxhPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHI7cmV0dXJuIHQucHJvdG90eXBlPWUscj1uZXcgdCx0LnByb3RvdHlwZT1udWxsLHJ9fSgpLG89e30scz1vLmxpYj17fSxjPXMuQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKHQpe3ZhciBlPWEodGhpcyk7cmV0dXJuIHQmJmUubWl4SW4odCksZS5oYXNPd25Qcm9wZXJ0eSgiaW5pdCIpJiZ0aGlzLmluaXQhPT1lLmluaXR8fChlLmluaXQ9ZnVuY3Rpb24oKXtlLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLGUuaW5pdC5wcm90b3R5cGU9ZSxlLiRzdXBlcj10aGlzLGV9LGNyZWF0ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZXh0ZW5kKCk7cmV0dXJuIHQuaW5pdC5hcHBseSh0LGFyZ3VtZW50cyksdH0saW5pdDpmdW5jdGlvbigpe30sbWl4SW46ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXNbZV09dFtlXSk7dC5oYXNPd25Qcm9wZXJ0eSgidG9TdHJpbmciKSYmKHRoaXMudG9TdHJpbmc9dC50b1N0cmluZyl9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5pdC5wcm90b3R5cGUuZXh0ZW5kKHRoaXMpfX0saD1zLldvcmRBcnJheT1jLmV4dGVuZCh7aW5pdDpmdW5jdGlvbih0LHIpe3Q9dGhpcy53b3Jkcz10fHxbXSx0aGlzLnNpZ0J5dGVzPXIhPWU/cjo0KnQubGVuZ3RofSx0b1N0cmluZzpmdW5jdGlvbih0KXtyZXR1cm4odHx8dSkuc3RyaW5naWZ5KHRoaXMpfSxjb25jYXQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy53b3JkcyxyPXQud29yZHMsbj10aGlzLnNpZ0J5dGVzLGE9dC5zaWdCeXRlcztpZih0aGlzLmNsYW1wKCksbiU0KWZvcih2YXIgaT0wO2k8YTtpKyspe3ZhciBvPXJbaT4+PjJdPj4+MjQtaSU0KjgmMjU1O2VbbitpPj4+Ml18PW88PDI0LShuK2kpJTQqOH1lbHNlIGZvcih2YXIgcz0wO3M8YTtzKz00KWVbbitzPj4+Ml09cltzPj4+Ml07cmV0dXJuIHRoaXMuc2lnQnl0ZXMrPWEsdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLndvcmRzLHI9dGhpcy5zaWdCeXRlcztlW3I+Pj4yXSY9NDI5NDk2NzI5NTw8MzItciU0KjgsZS5sZW5ndGg9dC5jZWlsKHIvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9Yy5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0LndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksdH0scmFuZG9tOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxyPTA7cjx0O3IrPTQpZS5wdXNoKG4oKSk7cmV0dXJuIG5ldyBoLmluaXQoZSx0KX19KSxsPW8uZW5jPXt9LHU9bC5IZXg9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMsbj1bXSxhPTA7YTxyO2ErKyl7dmFyIGk9ZVthPj4+Ml0+Pj4yNC1hJTQqOCYyNTU7bi5wdXNoKChpPj4+NCkudG9TdHJpbmcoMTYpKSxuLnB1c2goKDE1JmkpLnRvU3RyaW5nKDE2KSl9cmV0dXJuIG4uam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10Lmxlbmd0aCxyPVtdLG49MDtuPGU7bis9MilyW24+Pj4zXXw9cGFyc2VJbnQodC5zdWJzdHIobiwyKSwxNik8PDI0LW4lOCo0O3JldHVybiBuZXcgaC5pbml0KHIsZS8yKX19LGY9bC5MYXRpbjE9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMsbj1bXSxhPTA7YTxyO2ErKyl7dmFyIGk9ZVthPj4+Ml0+Pj4yNC1hJTQqOCYyNTU7bi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoaSkpfXJldHVybiBuLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5sZW5ndGgscj1bXSxuPTA7bjxlO24rKylyW24+Pj4yXXw9KDI1NSZ0LmNoYXJDb2RlQXQobikpPDwyNC1uJTQqODtyZXR1cm4gbmV3IGguaW5pdChyLGUpfX0sZD1sLlV0Zjg9e3N0cmluZ2lmeTpmdW5jdGlvbih0KXt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoZi5zdHJpbmdpZnkodCkpKX1jYXRjaCh0KXt0aHJvdyBuZXcgRXJyb3IoIk1hbGZvcm1lZCBVVEYtOCBkYXRhIil9fSxwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gZi5wYXJzZSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQodCkpKX19LF89cy5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPWMuZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IGguaW5pdCx0aGlzLl9uRGF0YUJ5dGVzPTB9LF9hcHBlbmQ6ZnVuY3Rpb24odCl7InN0cmluZyI9PXR5cGVvZiB0JiYodD1kLnBhcnNlKHQpKSx0aGlzLl9kYXRhLmNvbmNhdCh0KSx0aGlzLl9uRGF0YUJ5dGVzKz10LnNpZ0J5dGVzfSxfcHJvY2VzczpmdW5jdGlvbihlKXt2YXIgcixuPXRoaXMuX2RhdGEsYT1uLndvcmRzLGk9bi5zaWdCeXRlcyxvPXRoaXMuYmxvY2tTaXplLHM9aS8oNCpvKSxjPShzPWU/dC5jZWlsKHMpOnQubWF4KCgwfHMpLXRoaXMuX21pbkJ1ZmZlclNpemUsMCkpKm8sbD10Lm1pbig0KmMsaSk7aWYoYyl7Zm9yKHZhciB1PTA7dTxjO3UrPW8pdGhpcy5fZG9Qcm9jZXNzQmxvY2soYSx1KTtyPWEuc3BsaWNlKDAsYyksbi5zaWdCeXRlcy09bH1yZXR1cm4gbmV3IGguaW5pdChyLGwpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PWMuY2xvbmUuY2FsbCh0aGlzKTtyZXR1cm4gdC5fZGF0YT10aGlzLl9kYXRhLmNsb25lKCksdH0sX21pbkJ1ZmZlclNpemU6MH0pO3MuSGFzaGVyPV8uZXh0ZW5kKHtjZmc6Yy5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKHQpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZCh0KSx0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7Xy5yZXNldC5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX0sdXBkYXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9hcHBlbmQodCksdGhpcy5fcHJvY2VzcygpLHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzLl9hcHBlbmQodCksdGhpcy5fZG9GaW5hbGl6ZSgpfSxibG9ja1NpemU6MTYsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxyKXtyZXR1cm4gbmV3IHQuaW5pdChyKS5maW5hbGl6ZShlKX19LF9jcmVhdGVIbWFjSGVscGVyOmZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLHIpe3JldHVybiBuZXcgcC5ITUFDLmluaXQodCxyKS5maW5hbGl6ZShlKX19fSk7dmFyIHA9by5hbGdvPXt9O3JldHVybiBvfShNYXRoKSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZT10LHI9ZS5saWIuV29yZEFycmF5O2Z1bmN0aW9uIG4odCxlLG4pe2Zvcih2YXIgYT1bXSxpPTAsbz0wO288ZTtvKyspaWYobyU0KXt2YXIgcz1uW3QuY2hhckNvZGVBdChvLTEpXTw8byU0KjJ8blt0LmNoYXJDb2RlQXQobyldPj4+Ni1vJTQqMjthW2k+Pj4yXXw9czw8MjQtaSU0KjgsaSsrfXJldHVybiByLmNyZWF0ZShhLGkpfWUuZW5jLkJhc2U2ND17c3RyaW5naWZ5OmZ1bmN0aW9uKHQpe3ZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLG49dGhpcy5fbWFwO3QuY2xhbXAoKTtmb3IodmFyIGE9W10saT0wO2k8cjtpKz0zKWZvcih2YXIgbz0oZVtpPj4+Ml0+Pj4yNC1pJTQqOCYyNTUpPDwxNnwoZVtpKzE+Pj4yXT4+PjI0LShpKzEpJTQqOCYyNTUpPDw4fGVbaSsyPj4+Ml0+Pj4yNC0oaSsyKSU0KjgmMjU1LHM9MDtzPDQmJmkrLjc1KnM8cjtzKyspYS5wdXNoKG4uY2hhckF0KG8+Pj42KigzLXMpJjYzKSk7dmFyIGM9bi5jaGFyQXQoNjQpO2lmKGMpZm9yKDthLmxlbmd0aCU0OylhLnB1c2goYyk7cmV0dXJuIGEuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKHQpe3ZhciBlPXQubGVuZ3RoLHI9dGhpcy5fbWFwLGE9dGhpcy5fcmV2ZXJzZU1hcDtpZighYSl7YT10aGlzLl9yZXZlcnNlTWFwPVtdO2Zvcih2YXIgaT0wO2k8ci5sZW5ndGg7aSsrKWFbci5jaGFyQ29kZUF0KGkpXT1pfXZhciBvPXIuY2hhckF0KDY0KTtpZihvKXt2YXIgcz10LmluZGV4T2Yobyk7LTEhPT1zJiYoZT1zKX1yZXR1cm4gbih0LGUsYSl9LF9tYXA6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89In19KCksdC5lbmMuQmFzZTY0fShoLmV4cG9ydHMpfShjKTt2YXIgbD1jLmV4cG9ydHMsdT17ZXhwb3J0czp7fX0sZj17ZXhwb3J0czp7fX07IWZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgcj10LG49ci5saWIsYT1uLldvcmRBcnJheSxpPW4uSGFzaGVyLG89ci5hbGdvLHM9W107IWZ1bmN0aW9uKCl7Zm9yKHZhciB0PTA7dDw2NDt0Kyspc1t0XT00Mjk0OTY3Mjk2KmUuYWJzKGUuc2luKHQrMSkpfDB9KCk7dmFyIGM9by5NRDU9aS5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgYS5pbml0KFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPTA7cjwxNjtyKyspe3ZhciBuPWUrcixhPXRbbl07dFtuXT0xNjcxMTkzNSYoYTw8OHxhPj4+MjQpfDQyNzgyNTUzNjAmKGE8PDI0fGE+Pj44KX12YXIgaT10aGlzLl9oYXNoLndvcmRzLG89dFtlKzBdLGM9dFtlKzFdLGQ9dFtlKzJdLF89dFtlKzNdLHA9dFtlKzRdLGc9dFtlKzVdLHY9dFtlKzZdLHk9dFtlKzddLHc9dFtlKzhdLG09dFtlKzldLGI9dFtlKzEwXSx4PXRbZSsxMV0saz10W2UrMTJdLHo9dFtlKzEzXSxBPXRbZSsxNF0sUz10W2UrMTVdLEU9aVswXSxCPWlbMV0sUj1pWzJdLEQ9aVszXTtFPWgoRSxCLFIsRCxvLDcsc1swXSksRD1oKEQsRSxCLFIsYywxMixzWzFdKSxSPWgoUixELEUsQixkLDE3LHNbMl0pLEI9aChCLFIsRCxFLF8sMjIsc1szXSksRT1oKEUsQixSLEQscCw3LHNbNF0pLEQ9aChELEUsQixSLGcsMTIsc1s1XSksUj1oKFIsRCxFLEIsdiwxNyxzWzZdKSxCPWgoQixSLEQsRSx5LDIyLHNbN10pLEU9aChFLEIsUixELHcsNyxzWzhdKSxEPWgoRCxFLEIsUixtLDEyLHNbOV0pLFI9aChSLEQsRSxCLGIsMTcsc1sxMF0pLEI9aChCLFIsRCxFLHgsMjIsc1sxMV0pLEU9aChFLEIsUixELGssNyxzWzEyXSksRD1oKEQsRSxCLFIseiwxMixzWzEzXSksUj1oKFIsRCxFLEIsQSwxNyxzWzE0XSksRT1sKEUsQj1oKEIsUixELEUsUywyMixzWzE1XSksUixELGMsNSxzWzE2XSksRD1sKEQsRSxCLFIsdiw5LHNbMTddKSxSPWwoUixELEUsQix4LDE0LHNbMThdKSxCPWwoQixSLEQsRSxvLDIwLHNbMTldKSxFPWwoRSxCLFIsRCxnLDUsc1syMF0pLEQ9bChELEUsQixSLGIsOSxzWzIxXSksUj1sKFIsRCxFLEIsUywxNCxzWzIyXSksQj1sKEIsUixELEUscCwyMCxzWzIzXSksRT1sKEUsQixSLEQsbSw1LHNbMjRdKSxEPWwoRCxFLEIsUixBLDksc1syNV0pLFI9bChSLEQsRSxCLF8sMTQsc1syNl0pLEI9bChCLFIsRCxFLHcsMjAsc1syN10pLEU9bChFLEIsUixELHosNSxzWzI4XSksRD1sKEQsRSxCLFIsZCw5LHNbMjldKSxSPWwoUixELEUsQix5LDE0LHNbMzBdKSxFPXUoRSxCPWwoQixSLEQsRSxrLDIwLHNbMzFdKSxSLEQsZyw0LHNbMzJdKSxEPXUoRCxFLEIsUix3LDExLHNbMzNdKSxSPXUoUixELEUsQix4LDE2LHNbMzRdKSxCPXUoQixSLEQsRSxBLDIzLHNbMzVdKSxFPXUoRSxCLFIsRCxjLDQsc1szNl0pLEQ9dShELEUsQixSLHAsMTEsc1szN10pLFI9dShSLEQsRSxCLHksMTYsc1szOF0pLEI9dShCLFIsRCxFLGIsMjMsc1szOV0pLEU9dShFLEIsUixELHosNCxzWzQwXSksRD11KEQsRSxCLFIsbywxMSxzWzQxXSksUj11KFIsRCxFLEIsXywxNixzWzQyXSksQj11KEIsUixELEUsdiwyMyxzWzQzXSksRT11KEUsQixSLEQsbSw0LHNbNDRdKSxEPXUoRCxFLEIsUixrLDExLHNbNDVdKSxSPXUoUixELEUsQixTLDE2LHNbNDZdKSxFPWYoRSxCPXUoQixSLEQsRSxkLDIzLHNbNDddKSxSLEQsbyw2LHNbNDhdKSxEPWYoRCxFLEIsUix5LDEwLHNbNDldKSxSPWYoUixELEUsQixBLDE1LHNbNTBdKSxCPWYoQixSLEQsRSxnLDIxLHNbNTFdKSxFPWYoRSxCLFIsRCxrLDYsc1s1Ml0pLEQ9ZihELEUsQixSLF8sMTAsc1s1M10pLFI9ZihSLEQsRSxCLGIsMTUsc1s1NF0pLEI9ZihCLFIsRCxFLGMsMjEsc1s1NV0pLEU9ZihFLEIsUixELHcsNixzWzU2XSksRD1mKEQsRSxCLFIsUywxMCxzWzU3XSksUj1mKFIsRCxFLEIsdiwxNSxzWzU4XSksQj1mKEIsUixELEUseiwyMSxzWzU5XSksRT1mKEUsQixSLEQscCw2LHNbNjBdKSxEPWYoRCxFLEIsUix4LDEwLHNbNjFdKSxSPWYoUixELEUsQixkLDE1LHNbNjJdKSxCPWYoQixSLEQsRSxtLDIxLHNbNjNdKSxpWzBdPWlbMF0rRXwwLGlbMV09aVsxXStCfDAsaVsyXT1pWzJdK1J8MCxpWzNdPWlbM10rRHwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEscj10LndvcmRzLG49OCp0aGlzLl9uRGF0YUJ5dGVzLGE9OCp0LnNpZ0J5dGVzO3JbYT4+PjVdfD0xMjg8PDI0LWElMzI7dmFyIGk9ZS5mbG9vcihuLzQyOTQ5NjcyOTYpLG89bjtyWzE1KyhhKzY0Pj4+OTw8NCldPTE2NzExOTM1JihpPDw4fGk+Pj4yNCl8NDI3ODI1NTM2MCYoaTw8MjR8aT4+PjgpLHJbMTQrKGErNjQ+Pj45PDw0KV09MTY3MTE5MzUmKG88PDh8bz4+PjI0KXw0Mjc4MjU1MzYwJihvPDwyNHxvPj4+OCksdC5zaWdCeXRlcz00KihyLmxlbmd0aCsxKSx0aGlzLl9wcm9jZXNzKCk7Zm9yKHZhciBzPXRoaXMuX2hhc2gsYz1zLndvcmRzLGg9MDtoPDQ7aCsrKXt2YXIgbD1jW2hdO2NbaF09MTY3MTE5MzUmKGw8PDh8bD4+PjI0KXw0Mjc4MjU1MzYwJihsPDwyNHxsPj4+OCl9cmV0dXJuIHN9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9aS5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0Ll9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSx0fX0pO2Z1bmN0aW9uIGgodCxlLHIsbixhLGksbyl7dmFyIHM9dCsoZSZyfH5lJm4pK2ErbztyZXR1cm4oczw8aXxzPj4+MzItaSkrZX1mdW5jdGlvbiBsKHQsZSxyLG4sYSxpLG8pe3ZhciBzPXQrKGUmbnxyJn5uKSthK287cmV0dXJuKHM8PGl8cz4+PjMyLWkpK2V9ZnVuY3Rpb24gdSh0LGUscixuLGEsaSxvKXt2YXIgcz10KyhlXnJebikrYStvO3JldHVybihzPDxpfHM+Pj4zMi1pKStlfWZ1bmN0aW9uIGYodCxlLHIsbixhLGksbyl7dmFyIHM9dCsocl4oZXx+bikpK2ErbztyZXR1cm4oczw8aXxzPj4+MzItaSkrZX1yLk1ENT1pLl9jcmVhdGVIZWxwZXIoYyksci5IbWFjTUQ1PWkuX2NyZWF0ZUhtYWNIZWxwZXIoYyl9KE1hdGgpLHQuTUQ1fShoLmV4cG9ydHMpfShmKTt2YXIgZD17ZXhwb3J0czp7fX0sXz17ZXhwb3J0czp7fX07IWZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbigpe3ZhciBlPXQscj1lLmxpYixuPXIuV29yZEFycmF5LGE9ci5IYXNoZXIsaT1lLmFsZ28sbz1bXSxzPWkuU0hBMT1hLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBuLmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OCwzMjg1Mzc3NTIwXSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj10aGlzLl9oYXNoLndvcmRzLG49clswXSxhPXJbMV0saT1yWzJdLHM9clszXSxjPXJbNF0saD0wO2g8ODA7aCsrKXtpZihoPDE2KW9baF09MHx0W2UraF07ZWxzZXt2YXIgbD1vW2gtM11eb1toLThdXm9baC0xNF1eb1toLTE2XTtvW2hdPWw8PDF8bD4+PjMxfXZhciB1PShuPDw1fG4+Pj4yNykrYytvW2hdO3UrPWg8MjA/MTUxODUwMDI0OSsoYSZpfH5hJnMpOmg8NDA/MTg1OTc3NTM5MysoYV5pXnMpOmg8NjA/KGEmaXxhJnN8aSZzKS0xODk0MDA3NTg4OihhXmlecyktODk5NDk3NTE0LGM9cyxzPWksaT1hPDwzMHxhPj4+MixhPW4sbj11fXJbMF09clswXStufDAsclsxXT1yWzFdK2F8MCxyWzJdPXJbMl0raXwwLHJbM109clszXStzfDAscls0XT1yWzRdK2N8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9kYXRhLGU9dC53b3JkcyxyPTgqdGhpcy5fbkRhdGFCeXRlcyxuPTgqdC5zaWdCeXRlcztyZXR1cm4gZVtuPj4+NV18PTEyODw8MjQtbiUzMixlWzE0KyhuKzY0Pj4+OTw8NCldPU1hdGguZmxvb3Ioci80Mjk0OTY3Mjk2KSxlWzE1KyhuKzY0Pj4+OTw8NCldPXIsdC5zaWdCeXRlcz00KmUubGVuZ3RoLHRoaXMuX3Byb2Nlc3MoKSx0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PWEuY2xvbmUuY2FsbCh0aGlzKTtyZXR1cm4gdC5faGFzaD10aGlzLl9oYXNoLmNsb25lKCksdH19KTtlLlNIQTE9YS5fY3JlYXRlSGVscGVyKHMpLGUuSG1hY1NIQTE9YS5fY3JlYXRlSG1hY0hlbHBlcihzKX0oKSx0LlNIQTF9KGguZXhwb3J0cyl9KF8pO3ZhciBwPXtleHBvcnRzOnt9fTshZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7dmFyIGUscixuO3I9KGU9dCkubGliLkJhc2Usbj1lLmVuYy5VdGY4LGUuYWxnby5ITUFDPXIuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHQsZSl7dD10aGlzLl9oYXNoZXI9bmV3IHQuaW5pdCwic3RyaW5nIj09dHlwZW9mIGUmJihlPW4ucGFyc2UoZSkpO3ZhciByPXQuYmxvY2tTaXplLGE9NCpyO2Uuc2lnQnl0ZXM+YSYmKGU9dC5maW5hbGl6ZShlKSksZS5jbGFtcCgpO2Zvcih2YXIgaT10aGlzLl9vS2V5PWUuY2xvbmUoKSxvPXRoaXMuX2lLZXk9ZS5jbG9uZSgpLHM9aS53b3JkcyxjPW8ud29yZHMsaD0wO2g8cjtoKyspc1toXV49MTU0OTU1NjgyOCxjW2hdXj05MDk1MjI0ODY7aS5zaWdCeXRlcz1vLnNpZ0J5dGVzPWEsdGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2hhc2hlcjt0LnJlc2V0KCksdC51cGRhdGUodGhpcy5faUtleSl9LHVwZGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5faGFzaGVyLnVwZGF0ZSh0KSx0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9oYXNoZXIscj1lLmZpbmFsaXplKHQpO3JldHVybiBlLnJlc2V0KCksZS5maW5hbGl6ZSh0aGlzLl9vS2V5LmNsb25lKCkuY29uY2F0KHIpKX19KX0oaC5leHBvcnRzKX0ocCksZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9dCxyPWUubGliLG49ci5CYXNlLGE9ci5Xb3JkQXJyYXksaT1lLmFsZ28sbz1pLk1ENSxzPWkuRXZwS0RGPW4uZXh0ZW5kKHtjZmc6bi5leHRlbmQoe2tleVNpemU6NCxoYXNoZXI6byxpdGVyYXRpb25zOjF9KSxpbml0OmZ1bmN0aW9uKHQpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZCh0KX0sY29tcHV0ZTpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcixuPXRoaXMuY2ZnLGk9bi5oYXNoZXIuY3JlYXRlKCksbz1hLmNyZWF0ZSgpLHM9by53b3JkcyxjPW4ua2V5U2l6ZSxoPW4uaXRlcmF0aW9ucztzLmxlbmd0aDxjOyl7ciYmaS51cGRhdGUocikscj1pLnVwZGF0ZSh0KS5maW5hbGl6ZShlKSxpLnJlc2V0KCk7Zm9yKHZhciBsPTE7bDxoO2wrKylyPWkuZmluYWxpemUociksaS5yZXNldCgpO28uY29uY2F0KHIpfXJldHVybiBvLnNpZ0J5dGVzPTQqYyxvfX0pO2UuRXZwS0RGPWZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gcy5jcmVhdGUocikuY29tcHV0ZSh0LGUpfX0oKSx0LkV2cEtERn0oaC5leHBvcnRzKX0oZCk7dmFyIGc9e2V4cG9ydHM6e319OyFmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXt0LmxpYi5DaXBoZXJ8fGZ1bmN0aW9uKGUpe3ZhciByPXQsbj1yLmxpYixhPW4uQmFzZSxpPW4uV29yZEFycmF5LG89bi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtLHM9ci5lbmM7cy5VdGY4O3ZhciBjPXMuQmFzZTY0LGg9ci5hbGdvLkV2cEtERixsPW4uQ2lwaGVyPW8uZXh0ZW5kKHtjZmc6YS5leHRlbmQoKSxjcmVhdGVFbmNyeXB0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jcmVhdGUodGhpcy5fRU5DX1hGT1JNX01PREUsdCxlKX0sY3JlYXRlRGVjcnlwdG9yOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0RFQ19YRk9STV9NT0RFLHQsZSl9LGluaXQ6ZnVuY3Rpb24odCxlLHIpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChyKSx0aGlzLl94Zm9ybU1vZGU9dCx0aGlzLl9rZXk9ZSx0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7by5yZXNldC5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX0scHJvY2VzczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fYXBwZW5kKHQpLHRoaXMuX3Byb2Nlc3MoKX0sZmluYWxpemU6ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnRoaXMuX2FwcGVuZCh0KSx0aGlzLl9kb0ZpbmFsaXplKCl9LGtleVNpemU6NCxpdlNpemU6NCxfRU5DX1hGT1JNX01PREU6MSxfREVDX1hGT1JNX01PREU6MixfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQ/dzp2fXJldHVybiBmdW5jdGlvbihlKXtyZXR1cm57ZW5jcnlwdDpmdW5jdGlvbihyLG4sYSl7cmV0dXJuIHQobikuZW5jcnlwdChlLHIsbixhKX0sZGVjcnlwdDpmdW5jdGlvbihyLG4sYSl7cmV0dXJuIHQobikuZGVjcnlwdChlLHIsbixhKX19fX0oKX0pO24uU3RyZWFtQ2lwaGVyPWwuZXh0ZW5kKHtfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wcm9jZXNzKCEwKX0sYmxvY2tTaXplOjF9KTt2YXIgdT1yLm1vZGU9e30sZj1uLkJsb2NrQ2lwaGVyTW9kZT1hLmV4dGVuZCh7Y3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuRW5jcnlwdG9yLmNyZWF0ZSh0LGUpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKHQsZSl9LGluaXQ6ZnVuY3Rpb24odCxlKXt0aGlzLl9jaXBoZXI9dCx0aGlzLl9pdj1lfX0pLGQ9dS5DQkM9ZnVuY3Rpb24oKXt2YXIgdD1mLmV4dGVuZCgpO2Z1bmN0aW9uIHIodCxyLG4pe3ZhciBhLGk9dGhpcy5faXY7aT8oYT1pLHRoaXMuX2l2PWUpOmE9dGhpcy5fcHJldkJsb2NrO2Zvcih2YXIgbz0wO288bjtvKyspdFtyK29dXj1hW29dfXJldHVybiB0LkVuY3J5cHRvcj10LmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5fY2lwaGVyLGE9bi5ibG9ja1NpemU7ci5jYWxsKHRoaXMsdCxlLGEpLG4uZW5jcnlwdEJsb2NrKHQsZSksdGhpcy5fcHJldkJsb2NrPXQuc2xpY2UoZSxlK2EpfX0pLHQuRGVjcnlwdG9yPXQuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXt2YXIgbj10aGlzLl9jaXBoZXIsYT1uLmJsb2NrU2l6ZSxpPXQuc2xpY2UoZSxlK2EpO24uZGVjcnlwdEJsb2NrKHQsZSksci5jYWxsKHRoaXMsdCxlLGEpLHRoaXMuX3ByZXZCbG9jaz1pfX0pLHR9KCksXz0oci5wYWQ9e30pLlBrY3M3PXtwYWQ6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9NCplLG49ci10LnNpZ0J5dGVzJXIsYT1uPDwyNHxuPDwxNnxuPDw4fG4sbz1bXSxzPTA7czxuO3MrPTQpby5wdXNoKGEpO3ZhciBjPWkuY3JlYXRlKG8sbik7dC5jb25jYXQoYyl9LHVucGFkOmZ1bmN0aW9uKHQpe3ZhciBlPTI1NSZ0LndvcmRzW3Quc2lnQnl0ZXMtMT4+PjJdO3Quc2lnQnl0ZXMtPWV9fTtuLkJsb2NrQ2lwaGVyPWwuZXh0ZW5kKHtjZmc6bC5jZmcuZXh0ZW5kKHttb2RlOmQscGFkZGluZzpffSkscmVzZXQ6ZnVuY3Rpb24oKXt2YXIgdDtsLnJlc2V0LmNhbGwodGhpcyk7dmFyIGU9dGhpcy5jZmcscj1lLml2LG49ZS5tb2RlO3RoaXMuX3hmb3JtTW9kZT09dGhpcy5fRU5DX1hGT1JNX01PREU/dD1uLmNyZWF0ZUVuY3J5cHRvcjoodD1uLmNyZWF0ZURlY3J5cHRvcix0aGlzLl9taW5CdWZmZXJTaXplPTEpLHRoaXMuX21vZGUmJnRoaXMuX21vZGUuX19jcmVhdG9yPT10P3RoaXMuX21vZGUuaW5pdCh0aGlzLHImJnIud29yZHMpOih0aGlzLl9tb2RlPXQuY2FsbChuLHRoaXMsciYmci53b3JkcyksdGhpcy5fbW9kZS5fX2NyZWF0b3I9dCl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX21vZGUucHJvY2Vzc0Jsb2NrKHQsZSl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLmNmZy5wYWRkaW5nO3JldHVybiB0aGlzLl94Zm9ybU1vZGU9PXRoaXMuX0VOQ19YRk9STV9NT0RFPyhlLnBhZCh0aGlzLl9kYXRhLHRoaXMuYmxvY2tTaXplKSx0PXRoaXMuX3Byb2Nlc3MoITApKToodD10aGlzLl9wcm9jZXNzKCEwKSxlLnVucGFkKHQpKSx0fSxibG9ja1NpemU6NH0pO3ZhciBwPW4uQ2lwaGVyUGFyYW1zPWEuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHQpe3RoaXMubWl4SW4odCl9LHRvU3RyaW5nOmZ1bmN0aW9uKHQpe3JldHVybih0fHx0aGlzLmZvcm1hdHRlcikuc3RyaW5naWZ5KHRoaXMpfX0pLGc9KHIuZm9ybWF0PXt9KS5PcGVuU1NMPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dC5jaXBoZXJ0ZXh0LHI9dC5zYWx0O3JldHVybihyP2kuY3JlYXRlKFsxMzk4ODkzNjg0LDE3MDEwNzY4MzFdKS5jb25jYXQocikuY29uY2F0KGUpOmUpLnRvU3RyaW5nKGMpfSxwYXJzZTpmdW5jdGlvbih0KXt2YXIgZSxyPWMucGFyc2UodCksbj1yLndvcmRzO3JldHVybiAxMzk4ODkzNjg0PT1uWzBdJiYxNzAxMDc2ODMxPT1uWzFdJiYoZT1pLmNyZWF0ZShuLnNsaWNlKDIsNCkpLG4uc3BsaWNlKDAsNCksci5zaWdCeXRlcy09MTYpLHAuY3JlYXRlKHtjaXBoZXJ0ZXh0OnIsc2FsdDplfSl9fSx2PW4uU2VyaWFsaXphYmxlQ2lwaGVyPWEuZXh0ZW5kKHtjZmc6YS5leHRlbmQoe2Zvcm1hdDpnfSksZW5jcnlwdDpmdW5jdGlvbih0LGUscixuKXtuPXRoaXMuY2ZnLmV4dGVuZChuKTt2YXIgYT10LmNyZWF0ZUVuY3J5cHRvcihyLG4pLGk9YS5maW5hbGl6ZShlKSxvPWEuY2ZnO3JldHVybiBwLmNyZWF0ZSh7Y2lwaGVydGV4dDppLGtleTpyLGl2Om8uaXYsYWxnb3JpdGhtOnQsbW9kZTpvLm1vZGUscGFkZGluZzpvLnBhZGRpbmcsYmxvY2tTaXplOnQuYmxvY2tTaXplLGZvcm1hdHRlcjpuLmZvcm1hdH0pfSxkZWNyeXB0OmZ1bmN0aW9uKHQsZSxyLG4pe3JldHVybiBuPXRoaXMuY2ZnLmV4dGVuZChuKSxlPXRoaXMuX3BhcnNlKGUsbi5mb3JtYXQpLHQuY3JlYXRlRGVjcnlwdG9yKHIsbikuZmluYWxpemUoZS5jaXBoZXJ0ZXh0KX0sX3BhcnNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P2UucGFyc2UodCx0aGlzKTp0fX0pLHk9KHIua2RmPXt9KS5PcGVuU1NMPXtleGVjdXRlOmZ1bmN0aW9uKHQsZSxyLG4pe258fChuPWkucmFuZG9tKDgpKTt2YXIgYT1oLmNyZWF0ZSh7a2V5U2l6ZTplK3J9KS5jb21wdXRlKHQsbiksbz1pLmNyZWF0ZShhLndvcmRzLnNsaWNlKGUpLDQqcik7cmV0dXJuIGEuc2lnQnl0ZXM9NCplLHAuY3JlYXRlKHtrZXk6YSxpdjpvLHNhbHQ6bn0pfX0sdz1uLlBhc3N3b3JkQmFzZWRDaXBoZXI9di5leHRlbmQoe2NmZzp2LmNmZy5leHRlbmQoe2tkZjp5fSksZW5jcnlwdDpmdW5jdGlvbih0LGUscixuKXt2YXIgYT0obj10aGlzLmNmZy5leHRlbmQobikpLmtkZi5leGVjdXRlKHIsdC5rZXlTaXplLHQuaXZTaXplKTtuLml2PWEuaXY7dmFyIGk9di5lbmNyeXB0LmNhbGwodGhpcyx0LGUsYS5rZXksbik7cmV0dXJuIGkubWl4SW4oYSksaX0sZGVjcnlwdDpmdW5jdGlvbih0LGUscixuKXtuPXRoaXMuY2ZnLmV4dGVuZChuKSxlPXRoaXMuX3BhcnNlKGUsbi5mb3JtYXQpO3ZhciBhPW4ua2RmLmV4ZWN1dGUocix0LmtleVNpemUsdC5pdlNpemUsZS5zYWx0KTtyZXR1cm4gbi5pdj1hLml2LHYuZGVjcnlwdC5jYWxsKHRoaXMsdCxlLGEua2V5LG4pfX0pfSgpfShoLmV4cG9ydHMpfShnKSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZT10LHI9ZS5saWIuQmxvY2tDaXBoZXIsbj1lLmFsZ28sYT1bXSxpPVtdLG89W10scz1bXSxjPVtdLGg9W10sbD1bXSx1PVtdLGY9W10sZD1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sZT0wO2U8MjU2O2UrKyl0W2VdPWU8MTI4P2U8PDE6ZTw8MV4yODM7dmFyIHI9MCxuPTA7Zm9yKGU9MDtlPDI1NjtlKyspe3ZhciBfPW5ebjw8MV5uPDwyXm48PDNebjw8NDtfPV8+Pj44XjI1NSZfXjk5LGFbcl09XyxpW19dPXI7dmFyIHA9dFtyXSxnPXRbcF0sdj10W2ddLHk9MjU3KnRbX11eMTY4NDMwMDgqXztvW3JdPXk8PDI0fHk+Pj44LHNbcl09eTw8MTZ8eT4+PjE2LGNbcl09eTw8OHx5Pj4+MjQsaFtyXT15LHk9MTY4NDMwMDkqdl42NTUzNypnXjI1NypwXjE2ODQzMDA4KnIsbFtfXT15PDwyNHx5Pj4+OCx1W19dPXk8PDE2fHk+Pj4xNixmW19dPXk8PDh8eT4+PjI0LGRbX109eSxyPyhyPXBedFt0W3Rbdl5wXV1dLG5ePXRbdFtuXV0pOnI9bj0xfX0oKTt2YXIgXz1bMCwxLDIsNCw4LDE2LDMyLDY0LDEyOCwyNyw1NF0scD1uLkFFUz1yLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXtpZighdGhpcy5fblJvdW5kc3x8dGhpcy5fa2V5UHJpb3JSZXNldCE9PXRoaXMuX2tleSl7Zm9yKHZhciB0PXRoaXMuX2tleVByaW9yUmVzZXQ9dGhpcy5fa2V5LGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMvNCxuPTQqKCh0aGlzLl9uUm91bmRzPXIrNikrMSksaT10aGlzLl9rZXlTY2hlZHVsZT1bXSxvPTA7bzxuO28rKylvPHI/aVtvXT1lW29dOihoPWlbby0xXSxvJXI/cj42JiZvJXI9PTQmJihoPWFbaD4+PjI0XTw8MjR8YVtoPj4+MTYmMjU1XTw8MTZ8YVtoPj4+OCYyNTVdPDw4fGFbMjU1JmhdKTooaD1hWyhoPWg8PDh8aD4+PjI0KT4+PjI0XTw8MjR8YVtoPj4+MTYmMjU1XTw8MTZ8YVtoPj4+OCYyNTVdPDw4fGFbMjU1JmhdLGhePV9bby9yfDBdPDwyNCksaVtvXT1pW28tcl1eaCk7Zm9yKHZhciBzPXRoaXMuX2ludktleVNjaGVkdWxlPVtdLGM9MDtjPG47YysrKXtpZihvPW4tYyxjJTQpdmFyIGg9aVtvXTtlbHNlIGg9aVtvLTRdO3NbY109Yzw0fHxvPD00P2g6bFthW2g+Pj4yNF1dXnVbYVtoPj4+MTYmMjU1XV1eZlthW2g+Pj44JjI1NV1dXmRbYVsyNTUmaF1dfX19LGVuY3J5cHRCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX2RvQ3J5cHRCbG9jayh0LGUsdGhpcy5fa2V5U2NoZWR1bGUsbyxzLGMsaCxhKX0sZGVjcnlwdEJsb2NrOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dFtlKzFdO3RbZSsxXT10W2UrM10sdFtlKzNdPXIsdGhpcy5fZG9DcnlwdEJsb2NrKHQsZSx0aGlzLl9pbnZLZXlTY2hlZHVsZSxsLHUsZixkLGkpLHI9dFtlKzFdLHRbZSsxXT10W2UrM10sdFtlKzNdPXJ9LF9kb0NyeXB0QmxvY2s6ZnVuY3Rpb24odCxlLHIsbixhLGksbyxzKXtmb3IodmFyIGM9dGhpcy5fblJvdW5kcyxoPXRbZV1eclswXSxsPXRbZSsxXV5yWzFdLHU9dFtlKzJdXnJbMl0sZj10W2UrM11eclszXSxkPTQsXz0xO188YztfKyspe3ZhciBwPW5baD4+PjI0XV5hW2w+Pj4xNiYyNTVdXmlbdT4+PjgmMjU1XV5vWzI1NSZmXV5yW2QrK10sZz1uW2w+Pj4yNF1eYVt1Pj4+MTYmMjU1XV5pW2Y+Pj44JjI1NV1eb1syNTUmaF1ecltkKytdLHY9blt1Pj4+MjRdXmFbZj4+PjE2JjI1NV1eaVtoPj4+OCYyNTVdXm9bMjU1JmxdXnJbZCsrXSx5PW5bZj4+PjI0XV5hW2g+Pj4xNiYyNTVdXmlbbD4+PjgmMjU1XV5vWzI1NSZ1XV5yW2QrK107aD1wLGw9Zyx1PXYsZj15fXA9KHNbaD4+PjI0XTw8MjR8c1tsPj4+MTYmMjU1XTw8MTZ8c1t1Pj4+OCYyNTVdPDw4fHNbMjU1JmZdKV5yW2QrK10sZz0oc1tsPj4+MjRdPDwyNHxzW3U+Pj4xNiYyNTVdPDwxNnxzW2Y+Pj44JjI1NV08PDh8c1syNTUmaF0pXnJbZCsrXSx2PShzW3U+Pj4yNF08PDI0fHNbZj4+PjE2JjI1NV08PDE2fHNbaD4+PjgmMjU1XTw8OHxzWzI1NSZsXSlecltkKytdLHk9KHNbZj4+PjI0XTw8MjR8c1toPj4+MTYmMjU1XTw8MTZ8c1tsPj4+OCYyNTVdPDw4fHNbMjU1JnVdKV5yW2QrK10sdFtlXT1wLHRbZSsxXT1nLHRbZSsyXT12LHRbZSszXT15fSxrZXlTaXplOjh9KTtlLkFFUz1yLl9jcmVhdGVIZWxwZXIocCl9KCksdC5BRVN9KGguZXhwb3J0cyl9KHUpO3ZhciB2PXUuZXhwb3J0cyx5PXtleHBvcnRzOnt9fTshZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciByPXQsbj1yLmxpYixhPW4uV29yZEFycmF5LGk9bi5IYXNoZXIsbz1yLmFsZ28scz1bXSxjPVtdOyFmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7Zm9yKHZhciByPWUuc3FydCh0KSxuPTI7bjw9cjtuKyspaWYoISh0JW4pKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIHIodCl7cmV0dXJuIDQyOTQ5NjcyOTYqKHQtKDB8dCkpfDB9Zm9yKHZhciBuPTIsYT0wO2E8NjQ7KXQobikmJihhPDgmJihzW2FdPXIoZS5wb3cobiwuNSkpKSxjW2FdPXIoZS5wb3cobiwxLzMpKSxhKyspLG4rK30oKTt2YXIgaD1bXSxsPW8uU0hBMjU2PWkuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IGEuaW5pdChzLnNsaWNlKDApKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPXRoaXMuX2hhc2gud29yZHMsbj1yWzBdLGE9clsxXSxpPXJbMl0sbz1yWzNdLHM9cls0XSxsPXJbNV0sdT1yWzZdLGY9cls3XSxkPTA7ZDw2NDtkKyspe2lmKGQ8MTYpaFtkXT0wfHRbZStkXTtlbHNle3ZhciBfPWhbZC0xNV0scD0oXzw8MjV8Xz4+PjcpXihfPDwxNHxfPj4+MTgpXl8+Pj4zLGc9aFtkLTJdLHY9KGc8PDE1fGc+Pj4xNyleKGc8PDEzfGc+Pj4xOSleZz4+PjEwO2hbZF09cCtoW2QtN10rditoW2QtMTZdfXZhciB5PW4mYV5uJmleYSZpLHc9KG48PDMwfG4+Pj4yKV4objw8MTl8bj4+PjEzKV4objw8MTB8bj4+PjIyKSxtPWYrKChzPDwyNnxzPj4+NileKHM8PDIxfHM+Pj4xMSleKHM8PDd8cz4+PjI1KSkrKHMmbF5+cyZ1KStjW2RdK2hbZF07Zj11LHU9bCxsPXMscz1vK218MCxvPWksaT1hLGE9bixuPW0rKHcreSl8MH1yWzBdPXJbMF0rbnwwLHJbMV09clsxXSthfDAsclsyXT1yWzJdK2l8MCxyWzNdPXJbM10rb3wwLHJbNF09cls0XStzfDAscls1XT1yWzVdK2x8MCxyWzZdPXJbNl0rdXwwLHJbN109cls3XStmfDB9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZGF0YSxyPXQud29yZHMsbj04KnRoaXMuX25EYXRhQnl0ZXMsYT04KnQuc2lnQnl0ZXM7cmV0dXJuIHJbYT4+PjVdfD0xMjg8PDI0LWElMzIsclsxNCsoYSs2ND4+Pjk8PDQpXT1lLmZsb29yKG4vNDI5NDk2NzI5NiksclsxNSsoYSs2ND4+Pjk8PDQpXT1uLHQuc2lnQnl0ZXM9NCpyLmxlbmd0aCx0aGlzLl9wcm9jZXNzKCksdGhpcy5faGFzaH0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgdD1pLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIHQuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpLHR9fSk7ci5TSEEyNTY9aS5fY3JlYXRlSGVscGVyKGwpLHIuSG1hY1NIQTI1Nj1pLl9jcmVhdGVIbWFjSGVscGVyKGwpfShNYXRoKSx0LlNIQTI1Nn0oaC5leHBvcnRzKX0oeSk7dmFyIHc9eS5leHBvcnRzLG09e2V4cG9ydHM6e319OyFmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtpZigiZnVuY3Rpb24iPT10eXBlb2YgQXJyYXlCdWZmZXIpe3ZhciBlPXQubGliLldvcmRBcnJheSxyPWUuaW5pdDsoZS5pbml0PWZ1bmN0aW9uKHQpe2lmKHQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmKHQ9bmV3IFVpbnQ4QXJyYXkodCkpLCh0IGluc3RhbmNlb2YgSW50OEFycmF5fHwidW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5JiZ0IGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQxNkFycmF5fHx0IGluc3RhbmNlb2YgVWludDE2QXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQzMkFycmF5fHx0IGluc3RhbmNlb2YgVWludDMyQXJyYXl8fHQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXl8fHQgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpJiYodD1uZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQsdC5ieXRlTGVuZ3RoKSksdCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe2Zvcih2YXIgZT10LmJ5dGVMZW5ndGgsbj1bXSxhPTA7YTxlO2ErKyluW2E+Pj4yXXw9dFthXTw8MjQtYSU0Kjg7ci5jYWxsKHRoaXMsbixlKX1lbHNlIHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSkucHJvdG90eXBlPWV9fSgpLHQubGliLldvcmRBcnJheX0oaC5leHBvcnRzKX0obSk7dmFyIGI9bS5leHBvcnRzLHg9e2V4cG9ydHM6e319OyFmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXtyZXR1cm4gdC5IbWFjU0hBMjU2fShoLmV4cG9ydHMpfSh4KTt2YXIgaz14LmV4cG9ydHM7b25tZXNzYWdlPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZGF0YSxuPWUuam9iLGk9ZS5jbWQscz1lLnNlcnZlcixjPWUucGF0aCxoPWUuYXBpS2V5LHU9ZS5idWZmZXIsZj1lLmtleUJhc2U2NCxkPWUuZ3ppcCxfPWUucmVmZXJyZXIscD1lLmlkLGc9ZS5hcHBJZCx5PWUucGVyc2lzdGVudElkLG09ZS5DUk9RVUVUX1ZFUlNJT04seD1lLmRlYnVnLHo9ZS53aGF0O3N3aXRjaChpKXtjYXNlInVwbG9hZEVuY3J5cHRlZCI6IWZ1bmN0aW9uKHQpe0QuYXBwbHkodGhpcyxhcmd1bWVudHMpfShjKTticmVhaztkZWZhdWx0OmNvbnNvbGUuZXJyb3IoIlVua25vd24gd29ya2VyIGNvbW1hbmQiLGkpfWZ1bmN0aW9uIEEodCl7dmFyIGU9RGF0ZS5ub3coKSxyPWIuY3JlYXRlKHQpLG49bC5wYXJzZShmKSxpPWsocixuKSxvPWIucmFuZG9tKDE2KSxzPXYuZW5jcnlwdChyLG4se2l2Om99KS5jaXBoZXJ0ZXh0LGM9bmV3IEFycmF5QnVmZmVyKDQrby5zaWdCeXRlcytpLnNpZ0J5dGVzK3Muc2lnQnl0ZXMpLGg9bmV3IERhdGFWaWV3KGMpLHU9MDtoLnNldFVpbnQzMih1LDExMjk0NjgyMDksITEpLHUrPTQ7Zm9yKHZhciBkPTAsXz1bbyxpLHNdO2Q8Xy5sZW5ndGg7ZCsrKXt2YXIgZyx5PWEoX1tkXS53b3Jkcyk7dHJ5e2Zvcih5LnMoKTshKGc9eS5uKCkpLmRvbmU7KXt2YXIgdz1nLnZhbHVlO2guc2V0SW50MzIodSx3LCExKSx1Kz00fX1jYXRjaCh0KXt5LmUodCl9ZmluYWxseXt5LmYoKX19cmV0dXJuIHgmJmNvbnNvbGUubG9nKCIiLmNvbmNhdChwLCIgIikuY29uY2F0KHosIiBlbmNyeXB0ZWQgKCIpLmNvbmNhdChjLmJ5dGVMZW5ndGgsIiBieXRlcykgaW4gIikuY29uY2F0KERhdGUubm93KCktZSwibXMiKSksY31mdW5jdGlvbiBTKHQpe3ZhciBlPURhdGUubm93KCkscj1vLmV4cG9ydHMuZGVmbGF0ZSh0LHtnemlwOiEwLGxldmVsOjF9KTtyZXR1cm4geCYmY29uc29sZS5sb2coIiIuY29uY2F0KHAsIiAiKS5jb25jYXQoeiwiIGNvbXByZXNzZWQgKCIpLmNvbmNhdChyLmxlbmd0aCwiIGJ5dGVzKSBpbiAiKS5jb25jYXQoRGF0ZS5ub3coKS1lLCJtcyIpKSxyfWZ1bmN0aW9uIEUodCl7dmFyIGU9RGF0ZS5ub3coKSxyPXcoYi5jcmVhdGUodCkpLG49bC5zdHJpbmdpZnkocikucmVwbGFjZSgvPS9nLCIiKS5yZXBsYWNlKC9cKy9nLCItIikucmVwbGFjZSgvXC8vZywiXyIpO3JldHVybiB4JiZjb25zb2xlLmxvZygiIi5jb25jYXQocCwiICIpLmNvbmNhdCh6LCIgaGFzaGVkICgiKS5jb25jYXQodC5sZW5ndGgsIiBieXRlcykgaW4gIikuY29uY2F0KERhdGUubm93KCktZSwibXMiKSksbn1mdW5jdGlvbiBCKHQpe3JldHVybiBSLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBSKCl7cmV0dXJuKFI9cihyZWdlbmVyYXRvclJ1bnRpbWUubWFyaygoZnVuY3Rpb24gdChlKXt2YXIgcixuLGEsaSxvLGMsbDtyZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoKGZ1bmN0aW9uKHQpe2Zvcig7Oylzd2l0Y2godC5wcmV2PXQubmV4dCl7Y2FzZSAwOmlmKHI9RGF0ZS5ub3coKSxuPSIiLmNvbmNhdChzLCIvIikuY29uY2F0KGUpLGgpe3QubmV4dD00O2JyZWFrfXJldHVybiB0LmFicnVwdCgicmV0dXJuIix7dXJsOm4sdXBsb2FkVXJsOm59KTtjYXNlIDQ6cmV0dXJuIHQubmV4dD02LGZldGNoKG4se2hlYWRlcnM6eyJYLUNyb3F1ZXQtQXV0aCI6aCwiWC1Dcm9xdWV0LUFwcCI6ZywiWC1Dcm9xdWV0LUlkIjp5LCJYLUNyb3F1ZXQtU2Vzc2lvbiI6cCwiWC1Dcm9xdWV0LVZlcnNpb24iOm19LHJlZmVycmVyOl99KTtjYXNlIDY6cmV0dXJuIGE9dC5zZW50LHQubmV4dD05LGEuanNvbigpO2Nhc2UgOTppZihpPXQuc2VudCxvPWkuZXJyb3IsYz1pLnJlYWQsbD1pLndyaXRlLCFvKXt0Lm5leHQ9MTU7YnJlYWt9dGhyb3cgRXJyb3Iobyk7Y2FzZSAxNTpyZXR1cm4geCYmY29uc29sZS5sb2coIiIuY29uY2F0KHAsIiAiKS5jb25jYXQoeiwiIGF1dGhvcml6ZWQgaW4gIikuY29uY2F0KERhdGUubm93KCktciwibXMiKSksdC5hYnJ1cHQoInJldHVybiIse3VybDpjLHVwbG9hZFVybDpsfSk7Y2FzZSAxNzpjYXNlImVuZCI6cmV0dXJuIHQuc3RvcCgpfX0pLHQpfSkpKSkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIEQoKXtyZXR1cm4oRD1yKHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKChmdW5jdGlvbiB0KGUpe3ZhciByLGEsaSxvLHMsYyxoLGwsZjtyZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoKGZ1bmN0aW9uKHQpe2Zvcig7Oylzd2l0Y2godC5wcmV2PXQubmV4dCl7Y2FzZSAwOnJldHVybiB0LnByZXY9MCxyPUEoZD9TKHUpOnUpLGUuaW5jbHVkZXMoIiVIQVNIJSIpJiYoZT1lLnJlcGxhY2UoIiVIQVNIJSIsRShyKSkpLHQubmV4dD01LEIoZSk7Y2FzZSA1OnJldHVybiBhPXQuc2VudCxpPWEudXBsb2FkVXJsLG89YS51cmwscz1EYXRlLm5vdygpLHQubmV4dD0xMSxmZXRjaChpLHttZXRob2Q6IlBVVCIsbW9kZToiY29ycyIsaGVhZGVyczp7IkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSIsIlgtQ3JvcXVldC1BcHAiOmcsIlgtQ3JvcXVldC1JZCI6eSwiWC1Dcm9xdWV0LVNlc3Npb24iOnAsIlgtQ3JvcXVldC1WZXJzaW9uIjptfSxyZWZlcnJlcjpfLGJvZHk6cn0pO2Nhc2UgMTE6aWYoYz10LnNlbnQsaD1jLm9rLGw9Yy5zdGF0dXMsZj1jLnN0YXR1c1RleHQsaCl7dC5uZXh0PTE3O2JyZWFrfXRocm93IEVycm9yKCJzZXJ2ZXIgcmV0dXJuZWQgIi5jb25jYXQobCwiICIpLmNvbmNhdChmLCIgZm9yIFBVVCAiKS5jb25jYXQoaSkpO2Nhc2UgMTc6eCYmY29uc29sZS5sb2coIiIuY29uY2F0KHAsIiAiKS5jb25jYXQoeiwiIHVwbG9hZGVkICgiKS5jb25jYXQobCwiKSBpbiAiKS5jb25jYXQoRGF0ZS5ub3coKS1zLCJtcyAiKS5jb25jYXQobykpLHBvc3RNZXNzYWdlKHtqb2I6bix1cmw6byxvazpoLHN0YXR1czpsLHN0YXR1c1RleHQ6Zn0pLHQubmV4dD0yNTticmVhaztjYXNlIDIxOnQucHJldj0yMSx0LnQwPXQuY2F0Y2goMCkseCYmY29uc29sZS5sb2coIiIuY29uY2F0KHAsIiB1cGxvYWQgZXJyb3IgIikuY29uY2F0KHQudDAubWVzc2FnZSkpLHBvc3RNZXNzYWdlKHtqb2I6bixvazohMSxzdGF0dXM6LTEsc3RhdHVzVGV4dDp0LnQwLm1lc3NhZ2V9KTtjYXNlIDI1OmNhc2UiZW5kIjpyZXR1cm4gdC5zdG9wKCl9fSksdCxudWxsLFtbMCwyMV1dKX0pKSkpLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19fSgpOwoK",rc=null,oc=!1,function(e){return sc=sc||nc(ic,rc,oc),new Worker(sc,e)}),cc="1.0.5";window.location.hostname.match(/co?de?pe?n\.io/)?console.log("Croquet "+cc):console.log("%cCroquet%c %c"+cc,"color:#F0493E","color:inherit","color:".concat(cc.includes("+")?"#909":"inherit"));var lc=!!window.location.hostname.match(/^(.*\.)?croquet\.io$/i),uc=lc&&window.location.pathname.startsWith("/dev/"),dc=lc?window.location.host:"croquet.io",hc="wss://".concat(dc,"/reflector/v").concat(1),fc="https://croquet.io/files/v1",mc="https://files.croquet.io",pc="https://api.croquet.io/sign",yc="https://api.croquet.io/dev/sign",bc=mc,vc=null;var gc,Zc=K.nocheat,wc=200,Xc=[0],xc=4096;var kc=new ac;kc.onerror=function(e){return console.error("UploadWorker error: ".concat(e.message))};var Lc=0,Gc=new Set;function Sc(e){var t,n=W(Gc);try{var r=function(){var n=t.value;if(n.id===e){var i=n.sessionSpec;return{v:{appId:i.appId,persistentId:i.persistentId,uploadEncrypted:function(e){return n.uploadEncrypted(e)},downloadEncrypted:function(e){return n.downloadEncrypted(e)}}}}};for(n.s();!(t=n.n()).done;){var o=r();if("object"===i(o))return o.v}}catch(e){n.e(e)}finally{n.f()}return{}}function Wc(e){var t,n=W(Gc);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.id===e)return i}}catch(e){n.e(e)}finally{n.f()}return null}var Yc=function(e){function t(){var e,n;s(this,t),e=K.dev||!1!==K.dev&&"localhost",n=K.dev||!1!==K.dev&&uc,vc={messages:K.has("debug","messages",!1),sends:K.has("debug","sends",!1),ticks:K.has("debug","ticks",!1),pong:K.has("debug","pong",!1),snapshot:K.has("debug","snapshot",!1),session:K.has("debug","session",!1),initsnapshot:K.has("debug","initsnapshot",e),reflector:K.has("debug","reflector",n)},this.reset()}var r,a,l,u,d,h,f,m,p,y,b,v,g,w,x,k,L;return c(t,[{key:"reset",value:function(){window.CROQUETVM===this.vm&&delete window.CROQUETVM,this.vm=null,this.session=null,this.connection=this.connection||new Cc(this),this.networkQueue=[],this.reflectorTime=0,this.msPerTick=this.msPerTick||0,this.tickMultiplier=this.tickMultiplier||1,this.extrapolatedTimeBase=Date.now(),this.key=this.key||null,this.tove=this.tove||null,this.viewId=this.viewId||Math.floor(Math.random()*Math.pow(36,10)).toString(36),this.timeline="",this.rejoinTimeout&&clearTimeout(this.rejoinTimeout),this.rejoinTimeout=0,this.rebootSignal=null,this.sendBuffer=[],this.users=0,this.usersTotal=0,this.cpuTime=0,this.triggeringCpuTime=null,this.synced=null,this.latency=0,this.latencyHistory&&(this.latencyHistory=[]),this.localTicker&&(window.clearInterval(this.localTicker),delete this.localTicker),this.syncTimer&&(window.clearTimeout(this.syncTimer),delete this.syncTimer),this.tuttiHistory=[],this.lastAnimationEnd=0,this.animationGapCheck=[],this.rateLimitedSendTimes=[],this.rateLimitBuffer=[],this.rateLimitSoftWarned=!1,this.rateLimitBufferWarned=!1,this.rateLimitLastLogged=0,this.payloadSizeWarned=!1,dt.removeAllSubscriptionsFor(this.viewId),dt.addSubscription(this.viewId,"__views__",this.viewId,(function(e){return Ue("users now ".concat(e.count))}),"oncePerFrameWhileSynced"),this.leaving||ct.showSyncWait(!0)}},{key:"id",get:function(){return this.vm?this.vm.id:this.sessionSpec.id}},{key:"persistentId",get:function(){return this.sessionSpec.persistentId}},{key:"versionId",get:function(){return this.sessionSpec.codeHash}},{key:"extrapolatedTime",get:function(){return Date.now()-this.extrapolatedTimeBase}},{key:"viewOnly",get:function(){return this.sessionSpec.viewOnly}},{key:"backlog",get:function(){return this.vm?this.reflectorTime-this.vm.time:0}},{key:"starvation",get:function(){return Date.now()-this.lastReceived}},{key:"lag",get:function(){return this.vm?Math.max(0,this.extrapolatedTime-this.vm.time-this.msPerTick):0}},{key:"activity",get:function(){return Date.now()-this.lastSent}},{key:"viewed",get:function(){return!(!this.session||!this.session.view)}},{key:"connected",get:function(){return this.connection.connected}},{key:"shouldLeaveWhenDisconnected",get:function(){return this.leaving||!this.canRejoinSeamlessly||0===this.sessionSpec.rejoinLimit}},{key:"canRejoinSeamlessly",get:function(){return!!this.timeline}},{key:"checkForConnection",value:function(e){this.connection.checkForConnection(e)}},{key:"dormantDisconnect",value:function(){this.connected&&this.connection.dormantDisconnect()}},{key:"initFromSessionSpec",value:(L=o(regeneratorRuntime.mark((function e(t){var i,r,o,s,a,c,l,u,d,h,f,m,p,y,b,v,g,Z,w,X,x,k,L,G,S,Y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.name,r=t.optionsFromUrl,o=t.password,s=t.appId,a=t.apiKey,c=t.viewIdDebugSuffix,l=s?"".concat(s,"/").concat(i):i,c&&(this.viewId=this.viewId.replace(/_.*$/,"")+"_"+encodeURIComponent((""+c).slice(0,16)).replace(/[^a-z0-9]/gi,(function(e){return"_".concat("%"===e?"":e.charCodeAt(0).toString(16).toUpperCase())}))),u=n({},t.options),r){d=W(r);try{for(d.s();!(h=d.n()).done;)(f=h.value)in K&&(u[f]=K[f])}catch(e){d.e(e)}finally{d.f()}}for(m={},p=0,y=["hashOverride"];p<y.length;p++)(b=y[p])in K?m[b]=K[b]:b in t&&(m[b]=t[b]);return this.key=Ar(o,"",{keySize:8}),e.next=10,ne(l,u);case 10:return v=e.sent,e.next=13,this.verifyApiKey(a,s,v);case 13:return g=e.sent,Z=g.developerId,w=g.token,e.next=18,oe(v,Z,m,cc);case 18:return X=e.sent,x=X.id,k=X.codeHash,L=X.computedCodeHash,e.next=24,this.encrypt(x);case 24:this.tove=e.sent,vc.session&&console.log('Croquet session "'.concat(l,'":\n        sessionId=').concat(x).concat(s?"\n        persistentId=".concat(v):"","\n        versionId=").concat(k===L?k:"".concat(k," (specified in hashOverride)\n        versionId=").concat(L," (computed)"),"\n        viewId=").concat(this.viewId)),this.eventRateLimit=t.eventRateLimit,this.eventHistoryLimit=this.eventRateLimit,this.eventMaxBundles=this.eventRateLimit,this.sessionSpec=n(n({},t),{},{options:u,name:l,id:x,persistentId:v,developerId:Z,token:w,codeHash:k,computedCodeHash:L}),G=this.getTickAndMultiplier(),S=G.msPerTick,Y=G.multiplier,this.msPerTick=S,this.tickMultiplier=Y,this.setUpActivityChecks();case 34:case"end":return e.stop()}}),e,this)}))),function(e){return L.apply(this,arguments)})},{key:"establishSession",value:(k=o(regeneratorRuntime.mark((function e(){var t,n,i,r,o,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sessionSpec,n=t.id,i=t.persistentId,r=t.codeHash,this.sessionSpec.snapshot={id:n,time:0,meta:{id:n,persistentId:i,codeHash:r,created:(new Date).toISOString()}},o=new Promise((function(e){return s.sessionSpec.sessionJoined=e})),this.checkForConnection(!1),vc.session&&console.log(n,"waiting for SYNC"),e.next=7,o;case 7:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"verifyApiKey",value:(x=o(regeneratorRuntime.mark((function e(t,n,i){var r,o,s,a,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=vc.reflector?yc:pc,e.next=4,fetch("".concat(r,"/join?meta=login"),{method:"GET",mode:"cors",headers:{"X-Croquet-Auth":t,"X-Croquet-App":n,"X-Croquet-Id":i,"X-Croquet-Version":cc},referrer:ct.referrerURL()});case 4:return o=e.sent,e.next=7,o.json();case 7:if(s=e.sent,a=s.error,c=s.developerId,l=s.token,!a){e.next=13;break}throw Error(a);case 13:return vc.session&&console.log("Croquet: verified API key"),e.abrupt("return",{developerId:c,token:l});case 17:throw e.prev=17,e.t0=e.catch(0),Error("Error verifying Croquet API key: ".concat(e.t0.message));case 20:case"end":return e.stop()}}),e,null,[[0,17]])}))),function(e,t,n){return x.apply(this,arguments)})},{key:"lastKnownTime",value:function(e){return Math.max(e.time,e.externalTime)}},{key:"syncCheck",value:(w=o(regeneratorRuntime.mark((function e(t,n){var i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.synced){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.sendTutti(t,"syncCheck",n);case 4:i=e.sent,(r=Object.keys(i)).length>1?console.warn("sync check failed:",r):console.log("sync check ok");case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return w.apply(this,arguments)})},{key:"takeSnapshot",value:function(){var e=this.vm.snapshot(),t=this.lastKnownTime(e),i=e.externalSeq;return e.meta=n(n({},this.sessionSpec.snapshot.meta),{},{options:this.sessionSpec.options,time:t,seq:i,date:(new Date).toISOString(),host:window.location.hostname,sdk:cc}),delete e.meta.hash,e}},{key:"scheduleSnapshot",value:function(){if(this.connected&&this.vm){var e=this.vm.time,t=e-this.vm.lastSnapshotPoll;if(t<5e3)vc.snapshot&&console.log("not requesting snapshot poll (".concat(t,"ms since poll scheduled)"));else{var n=new il(e,0,this.vm.id,"handlePollForSnapshot",[]);this.sendTagged(n,{debounce:5e3,msgID:"pollForSnapshot"}),vc.snapshot&&console.log(this.id,"requesting snapshot poll via reflector")}}}},{key:"handlePollForSnapshot",value:function(e){var t=this;if(!0===this.synced){var n,i,r,o=this.triggeringCpuTime||this.cpuTime;this.triggeringCpuTime=null,this.cpuTime=0;try{n=Pe.begin("snapshot"),i={cpuTime:o,hash:this.vm.getSummaryHash(),viewId:this.viewId}}catch(e){return void De("snapshot",e)}finally{r=Pe.end("snapshot")-n,this.cpuTime-=r}vc.snapshot&&console.log(this.id,"Summary hashing took ".concat(Math.ceil(r),"ms")),Promise.resolve().then((function(){return t.pollForSnapshot(e,i)}))}else this.triggeringCpuTime=null}},{key:"pollForSnapshot",value:(g=o(regeneratorRuntime.mark((function e(t,n){var i,r,o,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.cpuTime+=Math.random(),vc.snapshot&&console.log(this.id,"sending snapshot vote",n),e.next=4,this.sendTutti(t,"snapshot",n);case 4:if(i=e.sent,!0===this.synced){e.next=8;break}return vc.snapshot&&console.log(this.id,"Ignoring snapshot vote during sync"),e.abrupt("return");case 8:vc.snapshot&&console.log(this.id,"received snapshot votes",i),r=this.analyzeTally(i,"cpuTime"),o=r.numberOfGroups,s=r.shouldUpload,a=r.dissidentFlag,o>1&&console.error(this.id,"Session diverged! Snapshots fall into ".concat(o," groups")),s&&this.serveSnapshot(a);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"analyzeTally",value:function(e,t){var n=this,i=!1,r=null,o=[],s={},a=null;Object.keys(e).forEach((function(e,t){var i=JSON.parse(e);o.push(i);var r=i.hash;i.viewId===n.viewId&&(a=t),s[r]||(s[r]=[]),s[r].push(t)}));var c=Object.keys(s),l=c.length,u=c[0];if(l>1&&(c.sort((function(e,t){return s[t].length-s[e].length})),s[c[0]].length===s[c[1]].length&&(vc.snapshot&&console.log(this.id,"Deciding consensus by tie-break"),u=c[0]<c[1]?c[0]:c[1])),null!==a){var d=o[a].hash,h=s[d];h.length>1&&h.sort((function(e,n){return o[e][t]-o[n][t]})),h[0]===a&&(i=!0,d!==u&&(r={groupVotes:h.length,allVotes:o.length}))}return{numberOfGroups:l,shouldUpload:i,dissidentFlag:r}}},{key:"serveSnapshot",value:function(e){var t,n,i;try{t=Pe.begin("snapshot"),i=this.takeSnapshot()}catch(e){return void De("snapshot",e)}finally{n=Pe.end("snapshot")-t}vc.snapshot&&console.log(this.id,"snapshot taken in ".concat(Math.ceil(n)," ms")),this.uploadSnapshot(i,e)}},{key:"snapshotPath",value:function(e,t,n){var i=Math.ceil(e).toString().padStart(10,"0"),r=this.sessionSpec,o=r.appId,s=r.persistentId,a=r.codeHash;return r.apiKey?"apps/".concat(o,"/snap/").concat(a,"/").concat(s,".").concat(this.id,"/").concat(i,"_").concat(t,".").concat(n):"snapshots/".concat(this.id,"/").concat(i,"_").concat(t,"-").concat(n,".snap")}},{key:"hashSnapshot",value:function(e){return e.meta.hash?e.meta.hash:(e.meta.hashPromise||(e.meta.hashPromise=new Promise((function(t){var i=n({},e);delete i.meta,q(JSON.stringify(i)).then((function(n){e.meta.hash=n,delete e.meta.hashPromise,t(n)}))}))),e.meta.hashPromise)}},{key:"uploadServer",value:function(){var e=vc.reflector?yc:pc;return this.sessionSpec.apiKey||(e=fc),"string"==typeof K.files&&(e=K.files).endsWith("/")&&(e=e.slice(0,-1)),e}},{key:"uploadSnapshot",value:(v=o(regeneratorRuntime.mark((function e(t){var n,i,r,o,s,a,c,l,u,d,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>1&&void 0!==h[1]?h[1]:null,e.next=3,this.hashSnapshot(t);case 3:return i=Pe.begin("snapshot"),r=JSON.stringify(t),o=Pe.end("snapshot")-i,vc.snapshot&&console.log(this.id,"snapshot stringified (".concat(r.length," bytes) in ").concat(Math.ceil(o),"ms")),s=t.meta,a=s.time,c=s.seq,l=s.hash,u=this.connection.socket,e.prev=9,e.next=12,this.uploadEncrypted({content:r,path:this.snapshotPath(a,c,l),key:this.key,gzip:!0,debug:vc.snapshot,what:"snapshot"});case 12:if(d=e.sent,this.connection.socket===u){e.next=16;break}return console.warn(this.id,"Controller was reset while trying to upload snapshot"),e.abrupt("return",!1);case 16:return this.announceSnapshotUrl(a,c,l,d,n),e.abrupt("return",!0);case 20:return e.prev=20,e.t0=e.catch(9),console.error(this.id,"Failed to upload snapshot"),e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this,[[9,20]])}))),function(e){return v.apply(this,arguments)})},{key:"announceSnapshotUrl",value:function(e,t,n,i,r){if(vc.snapshot){var o="time: ".concat(e,", seq: ").concat(t,", hash: ").concat(n);r&&(o+=", as dissident; "+JSON.stringify(r)),console.log(this.id,"sending snapshot url to reflector (".concat(o,"): ").concat(i))}try{this.connection.send(JSON.stringify({id:this.id,action:"SNAP",args:{time:e,seq:t,hash:n,url:i,dissident:r}}))}catch(e){console.error("ERROR while sending",e)}}},{key:"downloadEncrypted",value:(b=o(regeneratorRuntime.mark((function e(t){var n,i,r,o,s,a,c,l,u,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,i=t.gzip,r=t.key,o=t.debug,s=t.json,a=t.what,n.startsWith(fc)&&(n=n.replace(fc,mc)),c=Date.now(),e.next=5,fetch(n,{method:"GET",mode:"cors",headers:{"X-Croquet-App":this.sessionSpec.appId,"X-Croquet-Id":this.sessionSpec.persistentId,"X-Croquet-Session":this.sessionSpec.id,"X-Croquet-Version":cc},referrer:ct.referrerURL()});case 5:return l=e.sent,e.next=8,l.arrayBuffer();case 8:return u=e.sent,o&&console.log(this.id,"".concat(a," fetched (").concat(u.byteLength," bytes) in ").concat(-c+(c=Date.now()),"ms")),d=this.decryptBinary(u,r),o&&console.log(this.id,"".concat(a," decrypted (").concat(d.length," bytes) in ").concat(-c+(c=Date.now()),"ms")),h=i?tc.inflate(d):d,o&&i&&console.log(this.id,"".concat(a," inflated (").concat(h.length," bytes) in ").concat(-c+(c=Date.now()),"ms")),e.abrupt("return",s?JSON.parse((new TextDecoder).decode(h)):h);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"uploadEncrypted",value:(y=o(regeneratorRuntime.mark((function e(t){var n,i,r,o,s,a,c,l,u,d,h,f,m,p,y,b=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.content,i=t.path,r=t.key,o=t.gzip,s=t.keep,a=t.debug,c=t.what,l="string"==typeof n?(new TextEncoder).encode(n).buffer:n,u=s?void 0:[l],d="string"==typeof r?r:Jr.stringify(r),h=this.sessionSpec,f=h.apiKey,m=h.appId,p=h.persistentId,y=++Lc,e.abrupt("return",new Promise((function(e,t){kc.postMessage({job:y,cmd:"uploadEncrypted",server:b.uploadServer(),path:i,apiKey:f,buffer:l,keyBase64:d,gzip:o,referrer:ct.referrerURL(),id:b.id,appId:m,persistentId:p,CROQUET_VERSION:cc,debug:a,what:c},u),kc.addEventListener("message",(function n(i){if(y===i.data.job){var r=i.data,o=r.url,s=r.ok,a=r.status,c=r.statusText;kc.removeEventListener("message",n),s?e(o):t(Error("".concat(a,": ").concat(c)))}}))})));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"persistentPath",value:function(e){var t=this.sessionSpec,n=t.appId,i=t.persistentId;return"apps/".concat(n,"/").concat(i,"/save/").concat(e)}},{key:"pollForPersist",value:(p=o(regeneratorRuntime.mark((function e(t,n,i,r,o){var s,a,c,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.synced){e.next=2;break}return e.abrupt("return");case 2:if(this.sessionSpec.appId){e.next=4;break}throw Error("Persistence API requires appId");case 4:return e.next=6,this.persistenceVoting(t,n,r,o);case 6:if(s=e.sent,a=s.shouldUpload,c=s.dissidentFlag,a){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,this.uploadEncrypted({path:this.persistentPath(r),content:i,key:this.key,gzip:!0,debug:vc.snapshot,what:"persistent data"});case 13:l=e.sent,vc.snapshot&&(u=c?" (as dissident; ".concat(JSON.stringify(c),")"):"",console.log(this.id,"sending persistent data url to reflector".concat(u,": ").concat(l)));try{this.connection.send(JSON.stringify({id:this.id,action:"SAVE",args:{persistTime:n,url:l,dissident:c}}))}catch(e){console.error("ERROR while sending",e)}case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i,r){return p.apply(this,arguments)})},{key:"persistenceVoting",value:(m=o(regeneratorRuntime.mark((function e(t,n,i,r){var o,s,a,c,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.synced){e.next=2;break}return e.abrupt("return",!1);case 2:return o={viewId:this.viewId,hash:i,ms:r+.001*Math.random()},vc.snapshot&&console.log(this.id,"sending persistence vote for time @".concat(n),o),e.next=6,this.sendTutti(t,"persist",o);case 6:return s=e.sent,vc.snapshot&&console.log(this.id,"received persistence votes for time @".concat(n),s),a=this.analyzeTally(s,"ms"),c=a.numberOfGroups,l=a.shouldUpload,u=a.dissidentFlag,c>1&&console.warn(this.id,"Persistence records fall into ".concat(c," groups")),e.abrupt("return",{shouldUpload:l,dissidentFlag:u});case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return m.apply(this,arguments)})},{key:"convertReflectorMessage",value:function(e){var t=this.id,n="noop",i=[];switch(e[2].what){case"users":var r=e[2],o=r.joined,s=r.left,a=r.active,c=r.total;this.users=a,this.usersTotal=c;var l=this.id,u="__views__",d={entered:o||[],exited:s||[],count:a};t=this.id,n="publishFromModelOnly",i=[l,u,d],dt.handleEvent(this.viewId+":"+u,d);break;case"tally":var h=e[2],f=h.tuttiSeq,m=h.tuttiKey,p=h.tally,y=h.tallyTarget,b=h.missingClients;(vc.messages||vc.snapshot)&&b&&console.log("".concat(b," ").concat(1===b?"client":"clients"," failed to participate in tally ").concat(m||f));var v=m?function(e){return e.tuttiKey===m}:function(e){return e.dummyTuttiSeq===f},g=this.tuttiHistory.findIndex(v),w=-1!==g&&this.tuttiHistory.splice(g,1)[0];if(w&&w.resolve(p),y){var X={tally:p};w&&(X._local=w.payload);var x=Z(y,3);t=x[0],n=x[1],i=[x[2],X]}}var k=new il(0,0,t,n,i);e[2]=k.asState()[2]}},{key:"receive",value:(f=o(regeneratorRuntime.mark((function e(t,n){var i,r,o,s,a,c,l,u,d,h,f,m,p,y,b,v,g,w,x,k,L,G,S,Y,C,R,V,I,T,K,P,H,M,N,F,z,j,E=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.lastReceived,this.lastReceived=this.connection.lastReceived,e.t0=t,e.next="SYNC"===e.t0?5:"RECV"===e.t0?86:"TICK"===e.t0?108:"INFO"===e.t0?116:"REQU"===e.t0?119:122;break;case 5:if(this.syncReceived=!0,this.clearSyncReceiptTimeout(),Gc.add(this),o=n.messages,s=n.url,a=n.persisted,c=n.time,l=n.seq,u=n.snapshotSeq,d=n.tove,h=n.reflector,!d||d===this.tove){e.next=19;break}if(e.prev=10,this.decrypt(d)===this.id){e.next=13;break}throw Error("wrong sessionId in tove?!");case 13:e.next=19;break;case 15:return e.prev=15,e.t1=e.catch(10),this.connection.closeConnectionWithError("SYNC",Error("failed to decrypt session secret: ".concat(e.t1.message)),4200),e.abrupt("return");case 19:if(f=n.timeline||n.reflectorSession,m=a?"persisted session":"snapshot",vc.session&&console.log(this.id,"received SYNC from ".concat(h," reflector: time ").concat(c,", ").concat(o.length," messages, ").concat(m," ").concat(s||"<none>")),p=!!this.vm)if(this.networkQueue.length=0,y=!!f&&f===this.timeline,b=o[0],v=l,g=void 0!==u?u:b?b[1]:v,vc.messages&&console.log(this.id,"rejoin: we have #".concat(this.vm.seq," SYNC has #").concat(g,"-#").concat(v)),y&&nl(g,this.vm.seq)&&nl(this.vm.seq,v)&&c>=this.reflectorTime){if(b&&nl(b[1],this.vm.seq)&&(w=this.vm.seq-b[1]+1>>>0,vc.messages&&console.log(this.id,"rejoin: discarding ".concat(w," messages #").concat(b[1],"-#").concat(this.vm.seq)),o.splice(0,w)),this.sendBuffer.length>0){x=this.sendBuffer,this.sendBuffer=[],vc.session&&console.log(this.id,"rejoin: sending ".concat(x.length," messages buffered while disconnected")),k=W(x);try{for(k.s();!(L=k.n()).done;)(0,L.value)()}catch(e){k.e(e)}finally{k.f()}}}else vc.session&&console.log(this.id,"cannot rejoin seamlessly, rebooting model/view"),this.leave(!0),p=!1;G=this.networkQueue,this.networkQueue=[],S=W(o),e.prev=27,S.s();case 29:if((Y=S.n()).done){e.next=47;break}if("string"==typeof(C=Y.value)[2]){e.next=35;break}this.convertReflectorMessage(C),e.next=43;break;case 35:e.prev=35,C[2]=this.decryptPayload(C[2])[0],e.next=43;break;case 39:return e.prev=39,e.t2=e.catch(35),this.connection.closeConnectionWithError("SYNC",Error("failed to decrypt message: ".concat(e.t2.message)),4200),e.abrupt("return");case 43:vc.messages&&console.log(this.id,"received in SYNC "+JSON.stringify(C)),this.networkQueue.push(C);case 45:e.next=29;break;case 47:e.next=52;break;case 49:e.prev=49,e.t3=e.catch(27),S.e(e.t3);case 52:return e.prev=52,S.f(),e.finish(52);case 55:if((r=this.networkQueue).push.apply(r,X(G)),c>this.reflectorTime&&this.timeFromReflector(c),!p){e.next=61;break}return vc.session&&console.log(this.id,"seamless rejoin successful"),this.sessionSpec.sessionJoined(),e.abrupt("return");case 61:if(this.timeline=f||"",vc.snapshot&&s&&console.log("".concat(this.id," fetching ").concat(m," ").concat(s)),!s){e.next=74;break}return e.prev=64,e.next=67,this.downloadEncrypted({url:s,gzip:!0,key:this.key,debug:vc.snapshot,json:!0,what:m});case 67:R=e.sent,e.next=74;break;case 70:return e.prev=70,e.t4=e.catch(64),this.connection.closeConnectionWithError("SYNC",Error("failed to fetch ".concat(m,": ").concat(e.t4.message)),4200),e.abrupt("return");case 74:if(this.connected){e.next=77;break}return console.log(this.id,"disconnected during SYNC"),e.abrupt("return");case 77:return a?this.install(R):(R&&(this.sessionSpec.snapshot=R),this.install()),vc.session&&console.log("".concat(this.id," fast-forwarding from ").concat(Math.round(this.vm.time))),e.next=81,new Promise((function(e){E.fastForwardHandler=function(t){E.connected&&E.vm?"error"===t?e(!1):t&&E.viewId in E.vm.views&&e(!0):(console.log(E.id,"disconnected during SYNC fast-forwarding"),e(!1))},Promise.resolve().then((function(){return E.stepSession("fastForward",{budget:wc})}))}));case 81:return V=e.sent,delete this.fastForwardHandler,V&&vc.session&&console.log("".concat(this.id," fast-forwarded to ").concat(Math.round(this.vm.time))),V&&this.sessionSpec.sessionJoined(),e.abrupt("return");case 86:if((I=n)[1]>>>=0,"string"==typeof I[2]){e.next=94;break}vc.messages&&console.log(this.id,"received META "+JSON.stringify(I)),this.convertReflectorMessage(I),vc.messages&&console.log(this.id,"converted to "+JSON.stringify(I)),e.next=105;break;case 94:e.prev=94,T=this.decryptPayload(I[2]),K=Z(T,3),P=K[0],H=K[1],M=K[2],I[2]=P,H===this.viewId&&this.addToStatistics(M,this.lastReceived),vc.messages&&console.log(this.id,"received "+JSON.stringify(I)),e.next=105;break;case 101:return e.prev=101,e.t5=e.catch(94),this.connection.closeConnectionWithError("RECV",Error("failed to decrypt message: ".concat(e.t5.message)),4200),e.abrupt("return");case 105:return this.networkQueue.push(I),this.rebootSignal||(this.timeFromReflector(I[0]),this.simulateIfNeeded&&Promise.resolve().then((function(){return E.simulateIfNeeded()}))),e.abrupt("return");case 108:if(this.vm){e.next=110;break}return e.abrupt("return");case 110:return N="number"==typeof n?n:n.time,vc.ticks&&(F=i&&this.lastReceived-i-this.msPerTick*this.tickMultiplier|0,console.log(this.id,"Controller received TICK ".concat(N," ").concat(Math.abs(F)<5?"on time":F<0?"early":"late"," (").concat(F," ms)"))),this.timeFromReflector(N),this.tickMultiplier>1&&this.multiplyTick(N),this.simulateIfNeeded&&Promise.resolve().then((function(){return E.simulateIfNeeded()})),e.abrupt("return");case 116:return z=n.msg,j=n.options,ct.showMessage(z,j),e.abrupt("return");case 119:return vc.snapshot&&console.log("received REQU (snapshot request) from reflector"),this.cpuTime=12345,e.abrupt("return");case 122:console.warn("Unknown action:",t,n);case 123:case"end":return e.stop()}}),e,this,[[10,15],[27,49,52,55],[35,39],[64,70],[94,101]])}))),function(e,t){return f.apply(this,arguments)})},{key:"install",value:function(e){var t=Date.now(),n=this.sessionSpec,i=n.snapshot,r=n.initFn,o=n.options,s=Z(i.modelsById?["deserializ","snapshot"]:["initializ","root model"],2),a=s[0],c=s[1];vc.session&&console.log("".concat(this.id," ").concat(a,"ing ").concat(c));var l=new $c(i,(function(){try{return r(o,e)}catch(e){throw De("initFn",e),e}}));if((vc.session||vc.snapshot&&i.modelsById)&&console.log("".concat(this.id," ").concat(c," ").concat(a,"ed in ").concat(Date.now()-t,"ms")),vc.initsnapshot&&!i.modelsById){vc.snapshot&&console.log("".concat(this.id," exercising snapshot and restore after init()"));var u=JSON.stringify(l.snapshot());l=new $c(JSON.parse(u),(function(){return r(o)}))}var d=this.lastKnownTime(l);this.reflectorTime=Math.max(this.reflectorTime,d),this.setVM(l)}},{key:"setVM",value:function(e){this.vm=e,this.vm.controller=this}},{key:"sendJoin",value:function(){var e=this;this.syncReceived=!1,delete this.fastForwardHandler,this.rejoinTimeout&&(clearTimeout(this.rejoinTimeout),this.rejoinTimeout=0),vc.session&&console.log(this.id,"Controller sending JOIN");var t=this.getTickAndMultiplier(),n=t.tick,i=t.delay,r=this.sessionSpec,o=r.name,s=r.codeHash,a=r.appId,c=r.apiKey,l=r.persistentId,u=r.developerId,d=r.heraldUrl,h=r.rejoinLimit,f=r.autoSleep,m=r.computedCodeHash,p={name:o,apiKey:c,appId:a,persistentId:l,url:ct.referrerURL(),sdk:cc,developerId:u,version:1,user:this.viewId,ticks:{tick:n,delay:i},dormantDelay:f,tove:this.tove,codeHash:s};d&&Object.assign(p,{heraldUrl:d}),h&&Object.assign(p,{leaveDelay:h+250}),m!==s&&Object.assign(p,{computedCodeHash:m}),this.connection.send(JSON.stringify({id:this.id,action:"JOIN",args:p})),this.syncReceiptTimeout=setTimeout((function(){delete e.syncReceiptTimeout,e.syncReceived||e.connection.closeConnectionWithError("join",Error("SYNC not received in time"))}),5e3)}},{key:"clearSyncReceiptTimeout",value:function(){this.syncReceiptTimeout&&(clearTimeout(this.syncReceiptTimeout),delete this.syncReceiptTimeout)}},{key:"connectionInterrupted",value:function(){var e=this;this.syncReceived&&(this.shouldLeaveWhenDisconnected?this.leave():this.rejoinTimeout||(this.rejoinTimeout=setTimeout((function(){vc.session&&console.log(e.id,"rejoin timed out"),e.rejoinTimeout=0,e.leave()}),this.sessionSpec.rejoinLimit)))}},{key:"leave",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.sessionSpec.rebootModelView;if(this.reset(),vc.session&&console.log(this.id,"resetting ".concat(e?"(but keeping)":"and discarding"," controller")),e||Gc.delete(this),!this.sessionSpec)throw Error("do not discard sessionSpec!");t()}},{key:"encrypt",value:(h=o(regeneratorRuntime.mark((function e(t){var n,i,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N.random(16),i=no.encrypt(t,this.key,{iv:n}),r=ro(t,this.key),o="".concat(Jr.stringify(n)).concat(Jr.stringify(r)).concat(i),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"deprecatedDefaultKey",get:function(){return gc||(gc=Ar("THIS SHOULDN'T BE IN LOGS","",{keySize:8})),gc}},{key:"decrypt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.key,n=Jr.parse(e.slice(0,24)),i=Jr.parse(e.slice(24,68)),r=e.slice(68),o=no.decrypt(r,t,{iv:n}),s="";try{s=Ur.stringify(o)}catch(e){}var a=ro(s,this.key);if(this.compareHmacs(i.words,a.words))return s;if(t!==this.deprecatedDefaultKey)return this.decrypt(e,this.deprecatedDefaultKey);throw Error("Decryption error")}},{key:"decryptBinary",value:function(e,t){var n,i,r,o,s,a=(new TextDecoder).decode(new Uint8Array(e,0,4));switch("string"==typeof t&&(t=Jr.parse(t)),a){case"CRQ0":n=(new TextDecoder).decode(e),i=Jr.parse(n.slice(4,28)),r=Jr.parse(n.slice(28,72)),o=n.slice(72),s=no.decrypt(o,t,{iv:i});break;case"CRQ1":n=new Uint8Array(e),i=N.create(n.subarray(4,20)),r=N.create(n.subarray(20,52)),o=N.create(n.subarray(52)),s=no.decrypt({ciphertext:o},t,{iv:i});break;default:throw Error("".concat(this.id," unknown encryption version ").concat(a))}s.clamp();var c=ro(s,t);if(this.compareHmacs(r.words,c.words))return _(s);if(t!==this.deprecatedDefaultKey)return this.decryptBinary(e,this.deprecatedDefaultKey);throw Error("Decryption error")}},{key:"encryptMessage",value:(d=o(regeneratorRuntime.mark((function e(t,n,i){var r,o,s,a,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.asState(),o=Z(r,3),s=o[0],a=o[1],c=o[2],e.next=3,this.encryptPayload([c,n,i]);case 3:return l=e.sent,e.abrupt("return",[s,a,l]);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"encryptPayload",value:(u=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.encrypt(JSON.stringify(t)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"decryptPayload",value:function(e){return JSON.parse(this.decrypt(e))}},{key:"compareHmacs",value:function(e,t){for(var n=e.length===t.length,i=0;i<e.length;i++)e[i]!==t[i]&&(n=!1);return n}},{key:"sendMessage",value:function(e){var t=this;if(!this.viewOnly){var n=e.asState()[2].length;if(n>16384)console.warn("".concat(this.id," Message with payload of ").concat(n," bytes exceeds maximum ").concat(16384," and will not be sent to reflector."));else{!this.payloadSizeWarned&&n>xc&&(console.log("".concat(this.id," Message with payload of ").concat(n," bytes being sent to reflector. Maximum recommended is ").concat(xc,".")),this.payloadSizeWarned=!0);var i=Date.now(),r=this.rateLimitedSendTimes,o=this.rateLimitBuffer;if(Pe.perSecondTally({requestedMessages:1}),o.length)this.addToRateLimitBuffer(e);else{var s=0;if(r.length&&this.synced){var a=r[r.length-1],c=1e3/this.eventRateLimit-(i-a);c>1&&(s=Math.ceil(c))}s?(this.addToRateLimitBuffer(e),setTimeout((function(){return t.serviceRateLimitBuffer()}),s)):(this.recordRateLimitedSend(i),this.socketSendMessage(e),Pe.perSecondTally({sentSingleMessages:1,sentMessagesTotal:1,sentPayloadTotal:n}))}}}}},{key:"recordRateLimitedSend",value:function(e){var t=this.rateLimitedSendTimes;!this.synced&&t.length&&t[t.length-1]===e||(t.push(e),t.length>this.eventHistoryLimit&&t.shift()),!this.rateLimitSoftWarned&&t.length===this.eventHistoryLimit&&e-t[0]<1010&&(console.warn("".concat(this.id," Sends to reflector are at or above recommended limit of ").concat(this.eventHistoryLimit," within one second. Events will be bundled as necessary to keep to the limit.")),this.rateLimitSoftWarned=!0)}},{key:"addToRateLimitBuffer",value:function(e){Pe.perSecondTally({bundledMessages:1});var t=Date.now(),n=e.asState(),i=n[2].length,r=this.rateLimitBuffer;if(r.length){var o=r[r.length-1],s=o.msgStates;if(o.totalPayload<xc)return s.push({msgState:n,bufferTime:t}),void(o.totalPayload+=i)}Pe.perSecondTally({newBundles:1}),r.push({msgStates:[{msgState:n,bufferTime:t}],totalPayload:i});var a=r.length;vc.session&&a%5==0&&a!==this.rateLimitLastLogged&&(console.log("".concat(this.id," SEND rate-limit buffer grew to ").concat(a," event bundles (max ").concat(this.eventMaxBundles,")")),this.rateLimitLastLogged=a),a>this.eventMaxBundles?(console.error("".concat(this.id," Disconnecting after overflow of SEND rate-limit buffer.")),this.connection.closeConnectionWithError("SEND",Error("Send rate exceeded"),4200)):!this.rateLimitBufferWarned&&a>this.eventMaxBundles/2&&(console.warn("".concat(this.id," SEND rate-limit buffer is 50% full. If send rate does not drop, the app will be disconnected.")),this.rateLimitBufferWarned=!0)}},{key:"serviceRateLimitBuffer",value:function(){var e=this;if(this.connected){var t=this.rateLimitBuffer;if(t.length){var n=Date.now(),i=1e3/this.eventRateLimit,r=this.rateLimitedSendTimes;if(r.length){var o=r[r.length-1];if(i-(n-o)>0)return}var s=t.shift(),a=s.msgStates,c=s.totalPayload,l=[],u=0;a.forEach((function(e){l.push(e.msgState),u+=n-e.bufferTime}));var d=new il(this.vm.time,0,this.vm.id,"handleBundledEvents",["dummy",{events:l}]);if(this.socketSendMessage(d),this.recordRateLimitedSend(n),Pe.perSecondTally({sentBundles:1,sentMessagesTotal:a.length,sendDelay:u,sentBundlePayload:c,sentPayloadTotal:c}),vc.session&&this.connected){var h=t.length;h&&h%5==0&&h!==this.rateLimitLastLogged&&(console.log("".concat(this.id," SEND rate-limit buffer dropped to ").concat(h," event bundles")),this.rateLimitLastLogged=h)}t.length&&setTimeout((function(){return e.serviceRateLimitBuffer()}),i)}}}},{key:"socketSendMessage",value:(l=o(regeneratorRuntime.mark((function e(t){var n,i,r,o,s=this,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:null,e.next=3,this.encryptMessage(t,this.viewId,Date.now());case 3:if(i=e.sent,r=n?"tagged SEND ".concat(t.asState()," with tags ").concat(JSON.stringify(n)):"SEND ".concat(t.asState()),this.connected){e.next=8;break}return this.vm&&(vc.sends&&console.log(this.id,"buffering ".concat(r)),this.sendBuffer.push((function(){return s.socketSendMessage(t,n)}))),e.abrupt("return");case 8:vc.sends&&console.log(this.id,"sending ".concat(r)),o={id:this.id,action:"SEND",args:[].concat(X(i),[this.latency])},n&&(o.tags=n),this.lastSent=Date.now(),this.connection.send(JSON.stringify(o));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"sendTagged",value:(a=o(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.viewOnly){e.next=2;break}return e.abrupt("return");case 2:this.socketSendMessage(t,n);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"sendTutti",value:(r=o(regeneratorRuntime.mark((function e(t,n,i){var r,o,s,a,c,l,u,d=this,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>3&&void 0!==h[3]?h[3]:null,o=!(h.length>4&&void 0!==h[4])||h[4],s=h.length>5&&void 0!==h[5]?h[5]:null,!this.viewOnly){e.next=5;break}return e.abrupt("return",null);case 5:if(e.t0=r,!e.t0){e.next=10;break}return e.next=9,this.encryptMessage(r,this.viewId,Date.now());case 9:e.t0=e.sent;case 10:if(a=e.t0,c=P(i),this.connected){e.next=15;break}return this.vm&&(vc.sends&&console.log(this.id,"buffering TUTTI ".concat(c," ").concat(r&&r.asState()," ").concat(s)),this.sendBuffer.push((function(){return d.sendTutti(t,n,i,r,o,s)}))),e.abrupt("return",!1);case 15:return vc.sends&&console.log(this.id,"sending TUTTI ".concat(c," ").concat(r&&r.asState()," ").concat(s)),this.lastSent=Date.now(),l=1e6+Math.floor(t/100),u="".concat(n,"@").concat(t),this.connection.send(JSON.stringify({id:this.id,action:"TUTTI",args:[t,l,c,a,o,s,u]})),e.abrupt("return",new Promise((function(e){d.tuttiHistory.length>100&&d.tuttiHistory.shift(),d.tuttiHistory.push({time:t,tuttiKey:u,dummyTuttiSeq:l,payload:c,resolve:e})})));case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"sendLog",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.connected?(vc.sends&&console.log(this.id,"sending LOG"),n.length<2&&(n=n[0]),this.connection.send(JSON.stringify({action:"LOG",args:n}))):this.vm&&(vc.sends&&console.log(this.id,"buffering LOG"),this.sendBuffer.push((function(){return e.sendLog.apply(e,X(n))})))}},{key:"addToStatistics",value:function(e,t){this.latency=t-e,this.latencyHistory&&(this.latencyHistory.length>=100&&this.latencyHistory.shift(),this.latencyHistory.push({time:t,ms:this.latency}))}},{key:"latencies",get:function(){return this.latencyHistory||(this.latencyHistory=[]),this.latencyHistory}},{key:"getTickAndMultiplier",value:function(){var e=this.sessionSpec.options,t=Z(((["number","string"].includes(i(e.tps))?e.tps:["number","string"].includes(i(this.sessionSpec.tps))?this.sessionSpec.tps:20)+"x").split("x").map((function(e){return Number.parseFloat("0"+e)})),2),n=t[0],r=t[1],o=1e3/Math.max(1/30,Math.min(60,n)),s=Math.max(1,r),a=o,c=0;return s>1&&!Zc&&(a=o/s,c=Math.ceil(a*(s-1))),{msPerTick:a,multiplier:s,tick:o,delay:c}}},{key:"simulate",value:function(e){var t=this;if(!this.vm)return!0;try{var n=!0;if(this.networkQueue.length+this.vm.messages.size===0)n=this.vm.advanceTo(this.reflectorTime,e);else{for(var i=Pe.begin("simulate");n;){var r=this.networkQueue[0];if(!r)break;if(!(n=this.vm.advanceTo(r[0],e)))break;this.networkQueue.shift();var o=this.vm.scheduleExternalMessage(r);n=this.vm.advanceTo(o.time,e),this.cpuTime+=5}n&&(n=this.vm.advanceTo(this.reflectorTime,e)),this.cpuTime+=Math.max(.01,Pe.end("simulate")-i)}Pe.backlog(this.backlog);var s=this.lag,a=Math.max(200,.1*this.msPerTick),c=Math.max(2e3,.2*this.msPerTick);if("boolean"==typeof this.synced&&this.viewed&&(this.synced&&s>c||!this.synced&&s<a))!this.synced?this.syncTimer||(this.syncTimer=setTimeout((function(){delete t.syncTimer,t.lag<a&&t.applySyncChange(!0)}),200)):this.applySyncChange(!1);return this.synced&&n&&this.cpuTime>5e3&&(this.triggeringCpuTime=this.cpuTime,this.cpuTime=0,this.isBeingAnimated()?setTimeout((function(){return t.scheduleSnapshot()}),Math.floor(2e3*Math.random())):this.scheduleSnapshot()),n}catch(e){return De("simulate",e),this.connection.closeConnectionWithError("simulate",e),"error"}}},{key:"stepSession",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(window.logMessageStats){var n=Pe.stepSession(t.frameTime,!0);n&&console.log(n)}var i=this.backlog,r=this.latency,o=this.starvation,s=this.activity;if("animation"===e){Pe.animationFrame(t.frameTime,{backlog:i,starvation:o,latency:r,activity:s,users:this.users});var a=Date.now();if(this.lastAnimationEnd){var c=a-this.lastAnimationEnd;if(!0===this.animationGapCheck&&c>200&&(this.animationGapCheck=[],vc.session&&console.log("".concat(this.id," animation has stopped (too long between steps)"))),!0!==this.animationGapCheck){var l=this.animationGapCheck;l.push(c),l.length>4&&l.shift(),4===l.length&&l.reduce((function(e,t){return e+t}),0)<=400&&(this.animationGapCheck=!0,vc.session&&console.log("".concat(this.id," animation has started")))}}this.lastAnimationEnd=a}if(this.connected){if(this.vm){var u;switch(e){case"animation":var d=t.expectedSimFPS,h=Date.now(),f=Xc.reduce((function(e,t){return e+t}),0)/Xc.length;if(!1===(u=this.simulate(h+Math.min(f,wc)))){var m=0===d?0:1e3/d*4;this.backlog>m&&(u=this.simulate(h+wc-f))}"error"!==u&&(Xc.push(Date.now()-h),Xc.length>4&&Xc.shift());break;case"fastForward":case"background":u=this.simulate(Date.now()+t.budget);break;default:console.warn(e)}this.fastForwardHandler&&this.fastForwardHandler(u),"error"!==u&&(Pe.begin("update"),this.processModelViewEvents("animation"===e),Pe.end("update"),this.serviceRateLimitBuffer(),"animation"===e&&(t.view&&(Pe.begin("render"),this.inViewRealm((function(){return t.view.update(t.frameTime)})),Pe.end("render")),this.lastAnimationEnd=Date.now()))}}else this.isInBackground()||this.checkForConnection(!0)}},{key:"applySyncChange",value:function(e){vc.session&&console.log(this.id,"synced=".concat(e)),this.synced=e,ct.showSyncWait(!e),this.vm.publishFromView(this.viewId,"synced",e)}},{key:"inViewRealm",value:function(e){var t=this;return vt(this.vm,(function(){return e(t.vm)}))}},{key:"processModelViewEvents",value:function(e){return this.vm?this.vm.processModelViewEvents(e):0}},{key:"timeFromReflector",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reflector";e<this.reflectorTime?("controller"!==t||vc.ticks)&&console.warn("time is ".concat(this.reflectorTime,", ignoring time ").concat(e," from ").concat(t)):("boolean"!=typeof this.synced&&(this.synced=!1),this.reflectorTime=e,this.extrapolatedTimeBase=Date.now()-e,this.vm&&Pe.backlog(this.backlog),this.tickHook&&this.tickHook())}},{key:"multiplyTick",value:function(e){var t=this;this.localTicker&&window.clearInterval(this.localTicker);var n=this.msPerTick,i=this.tickMultiplier,r=1;this.localTicker=window.setInterval((function(){t.timeFromReflector(Math.round(e+r*n),"controller"),vc.ticks&&console.log(t.id,"Controller generate TICK "+t.reflectorTime,r),++r>=i&&(window.clearInterval(t.localTicker),t.localTicker=0)}),n)}},{key:"startStepping",value:function(e){var t=this;window.requestAnimationFrame((function n(i){t.leaving||(t.isOutOfSight()||e(i),window.requestAnimationFrame(n))}))}},{key:"setUpActivityChecks",value:function(){var e=this,t=null;this.isOutOfSight=function(){return"hidden"===document.visibilityState||!t},this.isBeingAnimated=function(){var t=!0===e.animationGapCheck,n=Date.now()-e.lastAnimationEnd<200;return t&&!n&&(e.animationGapCheck=[],vc.session&&console.log("".concat(e.id," animation has stopped (too long since last step)"))),t&&n},this.isInBackground=function(){return e.isOutOfSight()||!e.isBeingAnimated()};new IntersectionObserver((function(e,n){return t=e[0].isIntersecting})).observe(document.body);var n,i=this.sessionSpec.autoSleep;if(i){var r=1e3*i,o=0,s=0;n=function(){var t=Date.now();t-o<980||(o=t,e.isOutOfSight()?s?t-s>r&&(e.dormantDisconnect(),s=0):s=t:s=0)}}var a=function(){e.leaving?c&&(clearInterval(c),c=null):e.connected&&e.vm&&(n&&n(),e.isBeingAnimated()||e.connection.keepAlive(Date.now()))},c=setInterval(a,1e3);this.simulateIfNeeded=function(){if(!e.isBeingAnimated()&&(a(),e.connected)){var t=.9*e.msPerTick;i&&(t=Math.min(t,wc));var n=e.synced?"background":"fastForward";e.stepSession(n,{budget:t})}}}},{key:"toString",value:function(){return"Controller[".concat(this.id,"]")}},{key:e,value:function(){return this.toString()}}]),t}(Symbol.toPrimitive),Cc=function(){function e(t){s(this,e),this.controller=t,this.socketLastSent=0,this.connectBlocked=!1,this.connectRestricted=!1,this.connectHasBeenCalled=!1,this.reconnectDelay=0,this.missingTickThreshold=1/0}return c(e,[{key:"id",get:function(){return this.controller.id}},{key:"setTick",value:function(e){this.missingTickThreshold=Math.min(3*e,45e3)}},{key:"connected",get:function(){return!(!this.socket||this.socket.readyState!==WebSocket.OPEN)}},{key:"checkForConnection",value:function(e){this.socket||this.connectHasBeenCalled||this.connectBlocked||this.connectRestricted&&!e||this.connectToReflector()}},{key:"connectToReflector",value:function(){var e=this;if(!this.socket&&!this.connectHasBeenCalled){this.connectHasBeenCalled=!0,this.connectBlocked=!1,this.connectRestricted=!1;var t=vc.reflector?"wss://croquet.io/reflector-dev/dev":hc,n={},i=this.controller.sessionSpec.token;if(i&&(n.token=i),K.reflector){var r=K.reflector.toUpperCase();"CF"===r||r.match(/^[A-Z]{3}$/)?(t=vc.reflector?"wss://croquet.network/reflector/dev/":"wss://croquet.network/reflector/",3===r.length&&(n.colo=r)):K.reflector.match(/^[-a-z0-9]+$/i)?n.region=K.reflector:t=K.reflector}if(!t.match(/^wss?:/))throw Error("Cannot interpret reflector address "+t);t.endsWith("/")||(t+="/");for(var o=new URL(t+this.id),s=0,a=Object.entries(n);s<a.length;s++){var c=Z(a[s],2),l=c[0],u=c[1];o.searchParams.append(l,u)}var d=new WebSocket(o);d.onopen=function(t){e.socket=d,e.connectHasBeenCalled=!1,vc.session&&console.log(e.id,e.socket.constructor.name,"connected to",e.socket.url),e.reconnectDelay=0,Pe.connected(!0),e.controller.sendJoin()},d.onmessage=function(t){d===e.socket&&e.receive(t.data)},d.onerror=function(t){vc.session&&console.log(e.id,d.constructor.name,"connection error"),e.connectHasBeenCalled=!1,e.controller.clearSyncReceiptTimeout()},d.onclose=function(t){e.socketClosed(t.code,t.reason)}}}},{key:"socketClosed",value:function(e,t){var n=this;this.controller.clearSyncReceiptTimeout();var i=1e3!==e&&e<4100,r=4110===e;r||1e3===e||this.reconnectDelay||setTimeout((function(){n.connected||ct.showMessage("Connection closed: ".concat(e," ").concat(t),{level:i?"error":"fatal"})}),500),vc.session&&console.log(this.id,"".concat(this.socket?this.socket.constructor.name+" closed":"closed before opening,"," with code: ").concat(e," ").concat(t)),Pe.connected(!1),r?this.connectRestricted=!0:this.connectBlocked=!0,this.disconnected(),i&&(vc.session&&console.log(this.id,"reconnecting in ".concat(this.reconnectDelay," ms")),this.reconnectTimeout=window.setTimeout((function(){delete n.reconnectTimeout,n.connectToReflector()}),this.reconnectDelay),this.reconnectDelay=Math.min(3e4,Math.round((this.reconnectDelay+100)*(1+Math.random()))))}},{key:"disconnected",value:function(){this.socket&&(this.socket=null,this.lastReceived=0,this.socketLastSent=0,this.stalledSince=0,this.connectHasBeenCalled=!1,this.controller.connectionInterrupted())}},{key:"send",value:function(e){this.socketLastSent=Date.now(),this.socket.send(e)}},{key:"receive",value:function(e){this.lastReceived=Date.now();var t=JSON.parse(e),n=t.id,i=t.action,r=t.args;if(n)try{this.controller.receive(i,r)}catch(e){this.closeConnectionWithError("receive",e)}else switch(i){case"PONG":if(vc.pong&&console.log("PONG after",Date.now()-r,"ms"),this.pongHook)try{this.pongHook(r)}catch(e){console.error(e)}break;default:console.warn("Unknown action",i)}}},{key:"dormantDisconnect",value:function(){this.connected&&(vc.session&&console.log(this.id,"dormant; disconnecting from reflector"),this.closeConnection(4110,"Going dormant"))}},{key:"closeConnectionWithError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3;console.error(t),console.warn("closing socket"),n>=4100&&4110!==n&&(this.controller.leaving=function(){}),this.closeConnection(n,"Error in "+e)}},{key:"closeConnection",value:function(e,t){this.socket&&(this.socket.onclose=null,this.socket.close(e,t),this.socketClosed(e,t))}},{key:"PULSE",value:function(e){this.connected&&(0===this.socket.bufferedAmount?(vc.session&&console.log("".concat(this.id," sending PULSE")),this.send(JSON.stringify({action:"PULSE"})),this.stalledSince=0):this.stalledSince&&e-this.stalledSince>500?console.log("".concat(this.id," Reflector connection stalled: ").concat(this.socket.bufferedAmount," bytes unsent for ").concat(e-this.stalledSince," ms")):this.stalledSince=Date.now())}},{key:"keepAlive",value:function(e){0!==this.lastReceived&&(e-this.socketLastSent>25e3||e-this.lastReceived>this.missingTickThreshold)&&this.PULSE(e)}},{key:"PING",value:function(){this.connected&&this.send(JSON.stringify({action:"PING",args:Date.now()}))}}]),e}();window.setInterval((function(){var e,t=W(Gc);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.connected&&n.vm&&n.connection.keepAlive(Date.now())}}catch(e){t.e(e)}finally{t.f()}}),100);var Rc=Symbol("hash"),Vc=Symbol("key"),Ic=Symbol("url"),Tc=new Map;function Kc(e){return K.has("debug",e,!1)}function Pc(e){return e.replace(/.*\//,"")}function Hc(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Mc(e){return e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+3&-4,"=")}function Nc(e,t){return t.replace(/[\s\S]/g,(function(t){return String.fromCharCode(t.charCodeAt(0)^e.charCodeAt(0))}))}var Fc=function(){function e(t,n,i){s(this,e);var r=Tc.get(t);if(r)return Kc("data")&&console.log("Croquet.Data: using cached handle for ".concat(t)),r;if(i.slice(-43)!==t)throw Error("Croquet Data: malformed URL");Object.defineProperty(this,Rc,{value:t}),Object.defineProperty(this,Vc,{value:n}),Object.defineProperty(this,Ic,{value:i}),Tc.set(t,this),Kc("data")&&console.log("Croquet.Data: created new handle for ".concat(t))}var t,n;return c(e,null,[{key:"store",value:(n=o(regeneratorRuntime.mark((function t(n,r){var o,s,a,c,l,u,d,h,f,m=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=m.length>2&&void 0!==m[2]&&m[2],"object"===i(n)&&(console.warn("Deprecated: Croquet.Data.store(sessionId, data) called without sessionId"),r=n),!$c.hasCurrent()){t.next=4;break}throw Error("Croquet.Data.store() called from Model code");case 4:return s=Sc(n),a=s.appId,c=s.persistentId,l=s.uploadEncrypted,u=N.random(32).toString(Jr),d="apps/".concat(a,"/").concat(c,"/data/%HASH%"),t.next=9,l({path:d,content:r,key:u,keep:o,debug:Kc("data"),what:"shared data"});case 9:return h=t.sent,f=Pc(h),t.abrupt("return",new e(f,u,h));case 12:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetch",value:(t=o(regeneratorRuntime.mark((function e(t,n){var r,o,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===i(t)&&(console.warn("Deprecated: Croquet.Data.fetch(sessionId, handle) called without sessionId"),n=t),!$c.hasCurrent()){e.next=3;break}throw Error("Croquet.Data.fetch() called from Model code");case 3:if(r=Sc(t),o=r.downloadEncrypted,s=n&&n[Rc],a=n&&n[Vc],c=n&&n[Ic],"string"==typeof s&&"string"==typeof a&&"string"==typeof c){e.next=9;break}throw Error("Croquet.Data.fetch() called with invalid handle");case 9:return e.abrupt("return",o({url:c,key:a,debug:Kc("data"),what:"shared data"}));case 10:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"hash",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base64url";"function"==typeof e&&(e=Function.prototype.toString.call(e)),"string"==typeof e?e=(new TextEncoder).encode(e):e&&e.constructor===DataView?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e&&e.constructor===ArrayBuffer?e=new Uint8Array(e):ArrayBuffer.isView(e)||(e=(new TextEncoder).encode(P(e)));var n=j(N.create(e));switch(t){case"hex":return n.toString();case"base64":return n.toString(Jr);case"base64url":return Hc(n.toString(Jr));default:throw Error('Croquet.Data: unknown hash output "'.concat(t,'", expected "hex"/"base64"/"base64url"'))}}},{key:"fromId",value:function(e){var t,n,i,r,o=e.slice(0,1);switch(o){case"0":t=e.slice(1,44),n=e.slice(44),i="".concat(bc,"/sessiondata/").concat(t);break;case"1":t=e.slice(1,44),n=e.slice(44,87)+"=",r=e.slice(87),i="".concat(bc,"/apps/").concat(r,"/data/").concat(t);break;case"2":t=e.slice(1,44),r=Nc(n=Mc(e.slice(44,87)),atob(Mc(e.slice(87)))),i="".concat(bc,"/apps/").concat(r,"/data/").concat(t);break;case"3":t=(i=Nc(n=Mc(e.slice(1,44)),atob(Mc(e.slice(44))))).slice(-43);break;default:throw Error("Croquet.Data expected handle v0-v".concat("3"," got v").concat(o))}return new this(t,n,i)}},{key:"toId",value:function(e){if(!e)return"";var t=e[Rc],n=e[Vc],i=e[Ic];if(i.slice(-43)!==t)throw Error("Croquet Data: malformed URL");var r=Hc(n),o=Hc(btoa(Nc(n,i)));return"".concat("3").concat(r).concat(o)}}]),e}(),zc={cls:Fc,write:function(e){return Fc.toId(e)},read:function(e){return Fc.fromId(e)}},jc=null,Ec=null;var _c=function(e){u(n,e);var t=v(n);function n(){return s(this,n),t.apply(this,arguments)}return n}(p(Error));Object.defineProperty(_c.prototype,"name",{value:"CroquetWarning"});var Jc={};function Qc(e,t){var n=JSON.parse(atob(e.slice(1,-1))),i=n.qPara,r=n.qArgs,o=n.qFn,s=JSON.stringify(i),a=Jc[s]||(Jc[s]=m(Function,X(i)));return"number"==typeof o&&(r[o]=a),a.call.apply(a,[t].concat(X(r))).bind(t)}function Uc(e,t){if(jc)throw Error("VirtualMachine confusion");if(!(e instanceof $c))throw Error("not a VM: "+e);var n=jc;try{jc=e,window.CROQUETVM=e,t()}finally{jc=n}}var Dc="#__vote",Oc="#reflected",Bc="#divergence",Ac=new WeakMap;function qc(e){Ac.set(e,null)}var $c=function(e){function t(e,i){var r=this;s(this,t),function(){if(!window.CroquetViewMath){window.CroquetMath.random=function(){return jc.random()},window.CroquetViewMath=n({},Math);for(var e=function(){var e=Z(i[t],2),n=e[0],r=e[1],o=Math[n];Math[n]=1===r.length?function(e){return jc?r(e):o(e)}:function(e,t){return jc?r(e,t):o(e,t)}},t=0,i=Object.entries(window.CroquetMath);t<i.length;t++)e()}if(!window.CroquetViewDate){var r=window.Date,o=!1;function s(e,t){return o||(o=!0,console.warn(new _c("".concat(e," used in Model code")))),t}function a(e,t,n,i,o,c,l){var u=this instanceof a,d=[e,t,n,i,o,c,l];if(d.length=arguments.length,jc)switch(s(u?"new Date()":"Date()"),arguments.length){case 0:d.push(jc.time);break;case 1:break;default:d[0]=r.UTC.apply(r,d),d.length=1}var h=m(r,d);return u?h:""+h}a.prototype=r.prototype,a.UTC=r.UTC,a.now=function(){return jc?s("Date.now()",jc.time):r.now()},a.parse=function(){return jc?s("Date.parse()",0):r.parse.apply(r,arguments)},window.CroquetViewDate=r,window.Date=a}}(),Ec={snapshot:K.has("debug","snapshot",!1),session:K.has("debug","session",!1)},qc(this),Uc(this,(function(){bt(r,(function(){if(r.modelsById={},r.modelsByName={},r.messages=new Er((function(e,t){return e.before(t)})),r.subscriptions={},r.views={},r._random=function(){throw Error("You must not use random when applying state!")},r.id=e.id,r.time=0,r.seq=4294967280,r.externalTime=0,r.externalSeq=r.seq,r.futureSeq=0,r.lastSnapshotPoll=0,r.lastPersistencePoll=0,r.inPersistenceCoolOff=!1,r.persisted="",r.modelsId=0,r.controller=null,e.modelsById){for(var t=al.newOrRecycled(r).readVM(e,"$"),n=[],o=0,s=Object.keys(t);o<s.length;o++){var a=s[o];a in r||"meta"===a?"messages"===a?n=t.messages:r[a]=t[a]:console.warn("Ignoring property snapshot.".concat(a))}var c,l=W(n);try{for(l.s();!(c=l.n()).done;){var u=c.value;r.messages.add(u.convertIfNeeded(r))}}catch(e){l.e(e)}finally{l.f()}}else r._random=new de(e.id,{state:!0}),i(r),r.addSubscription(r,r.id,"__views__",r.generateJoinExit)}))}))}return c(t,[{key:"registerModel",value:function(e,t){if(jc!==this)throw Error("You can only create models from model code!");return t||(t=this.id+"/M"+ ++this.modelsId),this.modelsById[t]=e,t}},{key:"deregisterModel",value:function(e){if(jc!==this)throw Error("You can only destroy models from model code!");var t=this.modelsById;delete this.modelsById[e];for(var n=0,i=Object.entries(this.modelsByName);n<i.length;n++){var r=Z(i[n],2),o=r[0];t===r[1]&&delete this.modelsByName[o]}this.messages.removeMany((function(t){return t.hasReceiver(e)}))}},{key:"lookUpModel",value:function(e){if(e===this.id)return this;var t=this.modelsById[e];if(t)return t;var n=Z(e.match(/^([^#]+)#(.*)$/),3);n[0];var i=n[1],r=n[2];return this.modelsById[i].lookUp(r)}},{key:"get",value:function(e){return this.modelsByName[e]}},{key:"set",value:function(e,t){if(jc!==this)throw Error("You can only make a model well-known from model code!");this.modelsByName[e]=t}},{key:"callModelMethod",value:function(e,t,n){if(jc)throw Error("You cannot make a reflector send from model code!");var i=this.lookUpModel(e);if(i){var r=new il(this.time,0,i.id,t,n);this.controller.sendMessage(r)}else console.error(Error("Model not found: ".concat(e)))}},{key:"noop",value:function(){}},{key:"generateJoinExit",value:function(e){var t=e.entered,n=e.exited,i=e.count;if(t.length===i){var r,o=W(n=Object.keys(this.views));try{for(o.s();!(r=o.n()).done;){var s=r.value;this.views[s].extraConnections=0}}catch(e){o.e(e)}finally{o.f()}}if(0!==t.length&&0!==n.length){var a=t.filter((function(e){return n.includes(e)}));if(0!==a.length&&(t=t.filter((function(e){return!a.includes(e)})),n=n.filter((function(e){return!a.includes(e)})),0===t.length&&0===n.length))return}var c,l=W(n);try{for(l.s();!(c=l.n()).done;){var u=c.value;if(this.views[u]){if(this.views[u].extraConnections){this.views[u].extraConnections--,Ec.session&&console.log("".concat(this.id," @").concat(this.time,"#").concat(this.seq," view ").concat(u," closed extra connection"));continue}delete this.views[u],this.publishFromModelOnly(this.id,"view-exit",u)}else console.error("".concat(this.id," @").concat(this.time,"#").concat(this.seq," view ").concat(u," exited without being present - this should not happen")),this.controller.sendLog("view-exit-mismatch @".concat(this.time,"#").concat(this.seq," ").concat(u," left without being present"))}}catch(e){l.e(e)}finally{l.f()}var d,h=W(t);try{for(h.s();!(d=h.n()).done;){var f=d.value;this.views[f]?(Ec.session&&console.log("".concat(this.id," @").concat(this.time,"#").concat(this.seq," view ").concat(f," opened another connection")),this.views[f].extraConnections=(this.views[f].extraConnections||0)+1):(this.views[f]={},this.publishFromModelOnly(this.id,"view-join",f))}}catch(e){h.e(e)}finally{h.f()}var m=Object.values(this.views).reduce((function(e,t){return e+1+(t.extraConnections||0)}),0);i!==m&&(console.error("@".concat(this.time,"#").concat(this.seq," view count mismatch (model: ").concat(m,", reflector: ").concat(i,") - this should not happen")),this.controller.sendLog("view-exit-mismatch @".concat(this.time,"#").concat(this.seq," connections model: ").concat(m," reflector: ").concat(i)))}},{key:"scheduleExternalMessage",value:function(e){var t=il.fromState(e,this);if(t.time<this.time)throw Error("past message from reflector "+e);var n=this.externalSeq+1>>>0;if(t.seq!==n)throw Error("External message error. Expected message #".concat(n," got #").concat(t.seq));return this.externalTime=t.time,this.externalSeq=t.seq,t.seq=2*t.seq+1,this.messages.add(t),t}},{key:"futureSend",value:function(e,t,n,i){if(e.every)return this.futureRepeat(e.every,t,n,i);if(e<0)throw Error("attempt to send future message into the past");this.futureSeq=this.futureSeq+1>>>0;var r=new il(this.time+e,2*this.futureSeq,t,n,i);return this.messages.add(r),r}},{key:"futureRepeat",value:function(e,t,n,i){this.futureSend(e,this.id,"futureExecAndRepeat",[e,t,n,i])}},{key:"futureExecAndRepeat",value:function(e,t,n,i){var r=this.lookUpModel(t);if("function"==typeof r[n])try{r[n].apply(r,X(i))}catch(e){De("future message ".concat(r,".").concat(n),e)}else{var o=Qc(n,r);try{o.apply(void 0,X(i))}catch(e){De("future message ".concat(r," ").concat(o),e)}}this.futureRepeat(e,t,n,i)}},{key:"future",value:function(e,t,n,i){var r=this.asQFunc(e,n);if("string"==typeof r)return this.futureSend(t,e.id,r,i);var o=this;return new Proxy(e,{get:function(n,i){if("function"==typeof e[i])return function(){if(o.lookUpModel(e.id)!==e)throw Error("future send to unregistered model");for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return o.futureSend(t,e.id,i,r)};throw Error("Tried to call "+i+"() on future of "+Object.getPrototypeOf(e).constructor.name+" which is not a function")}})}},{key:"advanceTo",value:function(e,t){if(jc)throw Error("cannot advance time from model code");for(var n,i=0;(n=this.messages.peek())&&n.time<=e;){var r=n,o=r.time,s=r.seq;if(o<this.time)throw Error("past message encountered: "+n);if(1&s&&(this.seq=this.seq+1>>>0,s/2>>>0!==this.seq))throw Error("Sequence error: expected ".concat(this.seq," got ").concat(s/2>>>0," in ").concat(n));if(this.messages.poll(),this.time=n.time,n.executeOn(this),++i>100&&(i=0,Date.now()>t))return!1}return this.time=e,!0}},{key:"asQFunc",value:function(e,t){if("string"==typeof t)return t;if("function"==typeof t){if(e[t.name]===t)return t.name;for(var n=e;null!==n;){for(var i=0,r=Object.entries(Object.getOwnPropertyDescriptors(n));i<r.length;i++){var o=Z(r[i],2),s=o[0];if(o[1].value===t)return s}n=Object.getPrototypeOf(n)}var a=t.toString().match(/^\(?([a-z][a-z0-9]*)?\)? *=> *this\.([a-z][a-z0-9]*) *\( *([a-z][a-z0-9]*)? *\) *$/i);return!a||a[3]&&a[3]!==a[1]?function(e,t){"function"==typeof e&&(t=e,e={});var n=Object.keys(e).concat(["return "+t]),i=Object.values(e),r={qPara:n,qArgs:i},o=i.indexOf(t);return o>=0&&(i[o]=n[o],r.qFn=o),"{".concat(btoa(JSON.stringify(r)),"}")}(t):a[2]}return null}},{key:"addSubscription",value:function(e,t,n,i){if(jc!==this)throw Error("Cannot add a model subscription from outside model code");var r=this.asQFunc(e,i);if("string"!=typeof r)throw Error('Subscription handler for "'.concat(n,'" must be a method name'));if(r.indexOf(".")<0&&"function"!=typeof e[r]&&"{"!==r[0])throw Error('Subscriber method for "'.concat(n,'" not found: ').concat(e,".").concat(r,"()"));var o=t+":"+n,s=e.id+"."+r;if(this.subscriptions[o]){if(-1!==this.subscriptions[o].indexOf(s))throw Error("".concat(e,".").concat(r," already subscribed to ").concat(n))}else this.subscriptions[o]=[];this.subscriptions[o].push(s)}},{key:"removeSubscription",value:function(e,t,n,i){if(jc!==this)throw Error("Cannot remove a model subscription from outside model code");var r=t+":"+n,o=e.id+"."+i,s=this.subscriptions[r];if(s){var a=s.indexOf(o);s.splice(a,1),0===s.length&&delete this.subscriptions[r]}}},{key:"removeAllSubscriptionsFor",value:function(e){for(var t="".concat(e.id,":"),n="".concat(e.id,"."),i=0,r=Object.entries(this.subscriptions);i<r.length;i++){var o=Z(r[i],2),s=o[0],a=o[1];if(s.startsWith(t))delete this.subscriptions[s];else{for(var c=a.length-1;c>=0;c--)a[c].startsWith(n)&&a.splice(c,1);0===a.size&&delete this.subscriptions[s]}}}},{key:"publishFromModel",value:function(e,t,n){if(jc!==this)throw Error("Cannot publish a model event from outside model code");var i=t.endsWith(Oc);i&&(t=t.slice(0,t.length-Oc.length));var r=e+":"+t;this.handleModelEventInModel(r,n,i),this.handleModelEventInView(r,n)}},{key:"publishFromModelOnly",value:function(e,t,n){if(jc!==this)throw Error("Cannot publish a model event from outside model code");var i=e+":"+t;this.handleModelEventInModel(i,n)}},{key:"publishFromView",value:function(e,t,n){if(jc)throw Error("Cannot publish a view event from model code");var i=e+":"+t;this.handleViewEventInModel(i,n),this.handleViewEventInView(i,n)}},{key:"handleBundledEvents",value:function(e,t){var n,i=W(t.events);try{for(i.s();!(n=i.n()).done;){var r=n.value;il.fromState(r,this).executeOn(this,!0)}}catch(e){i.e(e)}finally{i.f()}}},{key:"handleModelEventInModel",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(jc!==this)throw Error("handleModelEventInModel called from outside model code");if(i){if(!0!==this.controller.synced)return;var r=e+Dc,o=e+Bc,s=!!dt.subscriptions[r],a=!!this.subscriptions[e],c=!!this.subscriptions[o];s&&c&&console.log("divergence subscription for ".concat(e," overridden by vote subscription"));var l,u=a?new il(this.time,0,this.id,"handleModelEventInModel",[e,t]):null;l=s?[this.id,"handleModelEventInView",r]:[this.id,"handleTuttiDivergence",o],Promise.resolve().then((function(){return n.controller.sendTutti(n.time,e,t,u,s,l)}))}else if(this.subscriptions[e]){var d,h=W(this.subscriptions[e]);try{for(h.s();!(d=h.n()).done;){var f=d.value,m=f.split("."),p=w(m),y=p[0],b=p.slice(1),v=b.join("."),g=this.lookUpModel(y);if(g)if("{"!==v[0])if(-1===v.indexOf(".")){if("function"!=typeof g[v]){De("event ".concat(e," ").concat(g,".").concat(v,"(): method not found"));continue}try{g[v](t)}catch(t){De("event ".concat(e," ").concat(g,".").concat(v,"()"),t)}}else try{var Z=v.split(".");g.call(Z[0],Z[1],t)}catch(t){De("event ".concat(e," ").concat(g,".").concat(v,"()"),t)}else{var X=Qc(v,g);try{X(t)}catch(t){De("event ".concat(e," ").concat(g," ").concat(X),t)}}else Qe("event ".concat(e," .").concat(v,"(): subscriber not found"))}}catch(e){h.e(e)}finally{h.f()}}}},{key:"handleViewEventInModel",value:function(e,t){if(this.subscriptions[e]){var n=new il(this.time,0,this.id,"handleModelEventInModel",[e,t]);this.controller.sendMessage(n)}}},{key:"handleModelEventInView",value:function(e,t){var n=this;dt.handleEvent(e,t,(function(e){return function(e){if(!jc)throw Error("VirtualMachine confusion");var t=jc;try{jc=null,e()}finally{jc=t}}((function(){return vt(n,e,!0)}))}))}},{key:"handleViewEventInView",value:function(e,t){dt.handleEvent(e,t)}},{key:"handleTuttiDivergence",value:function(e,t){if(this.subscriptions[e])this.handleModelEventInModel(e,t);else{var n=e.split(":").slice(-1)[0];console.warn("uncaptured divergence in ".concat(n,":"),t)}}},{key:"processModelViewEvents",value:function(e){var t=this;if(jc)throw Error("cannot process view events in model code");return vt(this,(function(){return dt.processFrameEvents(e,!!t.controller.synced)}))}},{key:"pollToCheckSync",value:function(){var e=this,t=this.time;if(!0===this.controller.synced){var n=Date.now(),i=this.getSummaryHash(),r=Date.now()-n;this.controller.cpuTime-=r,Promise.resolve().then((function(){return e.controller.syncCheck(t,i)}))}}},{key:"handlePollForSnapshot",value:function(){var e=this.time,t=e-this.lastSnapshotPoll;t<5e3?console.log("rejecting snapshot poll ".concat(t,"ms after previous")):(this.lastSnapshotPoll=e,this.controller.handlePollForSnapshot(e))}},{key:"snapshot",value:function(){return sl.newOrRecycled(this).snapshot(this,"$")}},{key:"getSummaryHash",value:function(){return P((new ol).getHash(this))}},{key:"persist",value:function(e,t){var n=Pe.begin("snapshot"),r="function"==typeof t?t.call(e):t;if("object"!==i(r))throw Error("Croquet: persistSession() can only persist objects (got ".concat(i(r),")"));var o,s,a=P(r),c=Fc.hash(a),l=Pe.end("snapshot")-n,u=this.persisted===c,d=this.time;if(Ec.snapshot&&console.log("".concat(this.id," persistent data @").concat(d," collected, stringified and hashed in ").concat(Math.ceil(l),"ms").concat(u?" (unchanged, ignoring)":"")),!u)if(o=this,s={persistTime:d,persistentString:a,persistentHash:c,ms:l},Ac.set(o,s),this.persisted=c,this.inPersistenceCoolOff)Ec.snapshot&&console.log("".concat(this.id," persistence poll postponed by cooloff"));else{var h=this.lastPersistencePoll?this.lastPersistencePoll+25e3-this.time:0;h>0?(Ec.snapshot&&console.log("".concat(this.id," postponing persistence poll by ").concat(h,"ms")),this.futureSend(h,this.id,"triggerPersistencePoll",[]),this.inPersistenceCoolOff=!0):this.triggerPersistencePoll()}}},{key:"triggerPersistencePoll",value:function(){var e=this;this.inPersistenceCoolOff=!1,this.lastPersistencePoll=this.controller?this.time:0;var t,n=(t=this,Ac.get(t));if(n){var i=n.persistTime,r=n.persistentString,o=n.persistentHash,s=n.ms;if(qc(this),this.controller&&this.controller.synced){Ec.snapshot&&console.log("".concat(this.id," asking controller to poll for persistence @").concat(i));var a=this.time;Promise.resolve().then((function(){return e.controller.pollForPersist(a,i,r,o,s)}))}}}},{key:"random",value:function(){if(jc!==this)throw Error("replicated random accessed from outside the model");return this._random()}},{key:"randomID",value:function(){if(jc!==this)throw Error("replicated random accessed from outside the model");for(var e="",t=0;t<4;t++)e+=(this._random.int32()>>>0).toString(16).padStart(8,"0");return e}},{key:"toString",value:function(){return"VirtualMachine[".concat(this.id,"]")}},{key:Symbol.toPrimitive,value:function(){return this.toString()}}],[{key:"current",value:function(){return jc||console.warn("VirtualMachine.current() called from outside the vm!"),jc}},{key:"hasCurrent",value:function(){return!!jc}}]),t}();function el(e,t,n){n.length>0&&(n=cl.newOrRecycled().encode(n));return"".concat(e,">").concat(t).concat(n.length>0?JSON.stringify(n):"")}function tl(e,t){var n=Z(e.match(/^([^[]+)(\[.*)?$/i),3);n[0];var i=n[1],r=n[2],o=Z(i.split(">"),2),s=o[0],a=o[1],c=[];r&&(c=ll.newOrRecycled(t).decode(JSON.parse(r)));return{receiver:s,selector:a,args:c}}function nl(e,t){return(t-e|0)>=0}var il=function(e){function t(e,n,i,r,o){s(this,t),this.time=e,this.seq=n,this.receiver=i,this.selector=r,this.args=o}return c(t,[{key:"convertIfNeeded",value:function(e){if(this.payload){var t=tl(this.payload,e),n=t.receiver,i=t.selector,r=t.args;delete this.payload,this.receiver=n,this.selector=i,this.args=r}return this}},{key:"before",value:function(e){return this.time!==e.time?this.time<e.time:this.isExternal()!==e.isExternal()?e.isExternal():this.isExternal()?nl(this.externalSeq,e.externalSeq):nl(this.internalSeq,e.internalSeq)}},{key:"hasReceiver",value:function(e){return this.receiver===e}},{key:"isExternal",value:function(){return 1&this.seq}},{key:"externalSeq",get:function(){return this.seq/2>>>0},set:function(e){this.seq=2*e+1}},{key:"internalSeq",get:function(){return this.seq/2>>>0},set:function(e){this.seq=2*e}},{key:"asState",value:function(){return[this.time,this.seq,el(this.receiver,this.selector,this.args)]}},{key:"executeOn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n?function(e){return e()}:function(t){return Uc(e,(function(){return bt(e,t)}))},r=this.receiver,o=this.selector,s=this.args,a=e.lookUpModel(r);if(a)if("{"===o[0]){var c=Qc(o,a);i((function(){try{c.apply(void 0,X(s))}catch(e){De("".concat(t.shortString()," ").concat(c),e)}}))}else"function"!=typeof a[o]?Qe("".concat(this.shortString()," ").concat(a,".").concat(o,"(): method not found")):i((function(){try{a[o].apply(a,X(s))}catch(e){De("".concat(t.shortString()," ").concat(a,".").concat(o,"()"),e)}}));else Qe("".concat(this.shortString()," ").concat(o,"(): receiver not found"))}},{key:"shortString",value:function(){return"".concat(this.isExternal()?"External":"Future","Message")}},{key:"toString",value:function(){var e=this.receiver,t=this.selector,n=this.args,i=this.isExternal(),r=i?this.externalSeq:this.internalSeq;return"".concat(i?"External":"Future","Message[").concat(this.time).concat(":#"[+i]).concat(r," ").concat(e,".").concat(t,"(").concat(n.map(JSON.stringify).join(", "),")]")}},{key:Symbol.toPrimitive,value:function(){return this.toString()}}],[{key:"fromState",value:function(e,n){var i=Z(e,3),r=i[0],o=i[1],s=tl(i[2],n);return new t(r,o,s.receiver,s.selector,s.args)}}]),t}(),rl=function(){var e=new ArrayBuffer(8),t=new DataView(e);return function(e){return t.setFloat64(0,e,!0),t.getInt32(0,!0)+t.getInt32(4,!0)}}(),ol=function(){function e(){s(this,e),this.refs=new Map,this.todo=[],this.hashers=new Map,this.addHasher("Teatime:Message",il),this.addHasher("Teatime:Data",zc);var t,n=W(pl.allClassTypes());try{for(n.s();!(t=n.n()).done;){var i=Z(t.value,2),r=i[0],o=i[1];this.addHasher(r,o)}}catch(e){n.e(e)}finally{n.f()}}return c(e,[{key:"addHasher",value:function(e,t){var i=this,r=Object.getPrototypeOf(t)===Object.prototype?t:{cls:t,write:function(e){return n({},e)}},o=r.cls,s=r.write;this.hashers.set(o,(function(e){return i.hashStructure(e,s(e))}))}},{key:"getHash",value:function(e){this.hashState={oC:0,mC:0,nanC:0,infC:0,zC:0,nC:0,nH:0,sC:0,sL:0,fC:0};for(var t=0,n=Object.entries(e);t<n.length;t++){var i=Z(n[t],2),r=i[0],o=i[1];if("controller"!==r&&"meta"!==r)if("_random"===r)this.hash(o.state(),!1);else if("messages"===r){var s=o.asArray();(this.hashState.fC=s.length)&&this.hash(s,!1)}else this.hashEntry(r,o)}return this.hashDeferred(),this.hashState}},{key:"hashDeferred",value:function(){for(;this.todo.length>0;){var e=this.todo.shift(),t=e.key,n=e.value;this.hashEntry(t,n,!1)}}},{key:"hash",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];switch(i(e)){case"number":return void(Number.isNaN(e)?this.hashState.nanC++:Number.isFinite(e)?0===e?this.hashState.zC++:(this.hashState.nC++,this.hashState.nH+=rl(e)):this.hashState.infC++);case"string":return this.hashState.sC++,void(this.hashState.sL+=e.length);case"boolean":case"undefined":return;default:if(this.refs.has(e))return;var n=Object.prototype.toString.call(e).slice(8,-1);switch(n){case"Array":return void this.hashArray(e,t);case"ArrayBuffer":return void this.hashArray(new Uint8Array(e),!1);case"Set":case"Map":return void this.hashStructure(e,X(e));case"DataView":return void this.hashArray(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),!1);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":return void this.hashArray(e,!1);case"Object":if(e instanceof pl)this.hashModel(e);else if(e.constructor===Object)this.hashObject(e,t);else{var r=this.hashers.get(e.constructor);r&&r(e)}}}}},{key:"hashModel",value:function(e){this.hashState.mC++,this.refs.set(e,!0);for(var t=0,n=Object.entries(e);t<n.length;t++){var i=Z(n[t],2),r=i[0],o=i[1];"__realm"!==r&&(void 0!==o&&this.hashEntry(r,o))}}},{key:"hashObject",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.hashState.oC++,this.refs.set(e,!0);for(var n=0,i=Object.entries(e);n<i.length;n++){var r=Z(i[n],2),o=r[0],s=r[1];void 0!==s&&this.hashEntry(o,s,t)}}},{key:"hashArray",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.refs.set(e,!0);for(var n=0;n<e.length;n++)this.hashEntry(n,e[n],t)}},{key:"hashStructure",value:function(e,t){void 0!==t&&(this.refs.set(e,!0),this.hash(t,!1))}},{key:"hashEntry",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"$"!==e[0]?n&&"object"===i(t)?this.todo.push({key:e,value:t}):this.hash(t):Qe("hash: ignoring property ".concat(e),{only:"once"})}}]),e}(),sl=function(){function e(t){s(this,e),this.vm=t,this.nextRef=1,this.refs=new Map,this.todo=[],this.writers=new Map,this.addWriter("Teatime:Message",il),this.addWriter("Teatime:Data",zc);var n,i=W(pl.allClassTypes());try{for(i.s();!(n=i.n()).done;){var r=Z(n.value,2),o=r[0],a=r[1];this.addWriter(o,a)}}catch(e){i.e(e)}finally{i.f()}}return c(e,[{key:"addWriter",value:function(e,t){var i=this,r=Object.getPrototypeOf(t)===Object.prototype?t:{cls:t,write:function(e){return n({},e)}},o=r.cls,s=r.write;this.writers.set(o,(function(t,n){return i.writeAs(e,t,s(t),n)}))}},{key:"snapshot",value:function(e){for(var t={_random:e._random.state(),messages:this.write(e.messages.asArray())},n=0,i=Object.entries(e);n<i.length;n++){var r=Z(i[n],2),o=r[0],s=r[1];"controller"!==o&&(t[o]||this.writeInto(t,o,s,"$"))}return this.writeDeferred(),t}},{key:"writeDeferred",value:function(){for(;this.todo.length>0;){var e=this.todo.shift(),t=e.state,n=e.key,i=e.value,r=e.path;this.writeInto(t,n,i,r,!1)}}},{key:"write",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];switch(i(e)){case"number":return Object.is(e,-0)?{$class:"NegZero"}:Number.isSafeInteger(e)?e:Number.isNaN(e)?{$class:"NaN"}:Number.isFinite(e)?this.writeFloat(e):{$class:"Infinity",$value:Math.sign(e)};case"string":case"boolean":return e;case"undefined":return{$class:"Undefined"};default:if(this.refs.has(e))return this.writeRef(e);var r=Object.prototype.toString.call(e).slice(8,-1);switch(r){case"Array":return this.writeArray(e,t,n);case"ArrayBuffer":return this.writeArrayBuffer(e);case"Set":case"Map":return this.writeAs(r,e,X(e),t);case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":return this.writeTypedArray(r,e);case"Object":if(e instanceof pl)return this.writeModel(e,t);if(e.constructor===Object||"function"!=typeof e.constructor)return this.writeObject(e,t,n);var o=this.writers.get(e.constructor);if(o)return o(e,t);throw console.error("Croquet Snapshot: unknown class ".concat(t,":"),e),Error("Croquet Snapshot: class not registered in Model.types(): ".concat(e.constructor.name));case"Null":return e;default:throw console.error("Croquet Snapshot: unsupported property ".concat(t,":"),e),Error("Croquet Snapshot: ".concat(r,"s are not supported as model properties"))}}}},{key:"writeModel",value:function(e,t){var n={$model:pl.classToID(e.constructor)};this.refs.set(e,n);var i,r=W(Object.keys(e).sort());try{for(r.s();!(i=r.n()).done;){var o=i.value;if("__realm"!==o){var s=e[o];this.writeInto(n,o,s,t)}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"writeObject",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={};this.refs.set(e,i);var r,o=W(Object.keys(e).sort());try{for(o.s();!(r=o.n()).done;){var s=r.value,a=e[s];this.writeInto(i,s,a,t,n)}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"writeArray",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[];this.refs.set(e,i);for(var r=0;r<e.length;r++)this.writeInto(i,r,e[r],t,n);return i}},{key:"writeArrayBuffer",value:function(e){var t={$class:"ArrayBuffer",$value:dl(e)};return this.refs.set(e,t),t}},{key:"writeTypedArray",value:function(e,t){var n={$class:e,$value:[this.writeArrayBuffer(t.buffer),t.byteOffset,"DataView"===e?t.byteLength:t.length]};return this.refs.set(t,n),n}},{key:"writeFloat",value:function(e){return e}},{key:"writeAs",value:function(e,t,n,r){if(void 0===n)return n;var o={$class:e};this.refs.set(t,o);var s=this.write(n,r,!1);return"object"!==i(s)||s.$class||Array.isArray(s)?o.$value=s:Object.assign(o,s),o}},{key:"writeRef",value:function(e){var t=this.refs.get(e);if("object"!==i(t))throw Error("Non-object in refs: "+e);return Array.isArray(t)&&(t.toJSON=function(){return{$id:this.$id,$class:"Array",$value:X(this)}}),{$ref:t.$id||(t.$id=this.nextRef++)}}},{key:"writeInto",value:function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if("$"!==t[0])if(o&&"object"===i(n))this.todo.push({state:e,key:t,value:n,path:r});else{var s="string"==typeof t&&t.match(/^[_a-z][_a-z0-9]*$/i),a=r+(s?".".concat(t):"[".concat(JSON.stringify(t),"]")),c=this.write(n,a);void 0!==c&&(e[t]=c)}else Qe("snapshot: ignoring property ".concat(t),{only:"once"})}}],[{key:"newOrRecycled",value:function(e){var t=this.reusableInstance;return t?(t.vm=e,t.nextRef=1,t.refs=new Map,t.todo=[]):t=this.reusableInstance=new this(e),t}},{key:"reusableInstance",get:function(){return this[this.name+"-instance"]},set:function(e){this[this.name+"-instance"]=e}},{key:"resetInstance",value:function(){this.reusableInstance=null}}]),e}(),al=function(){function e(t){s(this,e),this.vm=t,this.refs=new Map,this.todo=[],this.unresolved=[],this.readers=new Map,this.addReader("Teatime:Message",il),this.addReader("Teatime:Data",zc);var n,i=W(pl.allClassTypes());try{for(i.s();!(n=i.n()).done;){var r=Z(n.value,2),o=r[0],a=r[1];this.addReader(o,a)}}catch(e){i.e(e)}finally{i.f()}this.readers.set("Undefined",(function(){})),this.readers.set("NaN",(function(){return NaN})),this.readers.set("Infinity",(function(e){return e*(1/0)})),this.readers.set("NegZero",(function(){return-0})),this.readers.set("Set",(function(e){return new Set(e)})),this.readers.set("Map",(function(e){return new Map(e)})),this.readers.set("Array",(function(e){return e.slice(0)})),this.readers.set("ArrayBuffer",(function(e){return function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i.buffer}(e)})),this.readers.set("DataView",(function(e){return m(DataView,X(e))})),this.readers.set("Int8Array",(function(e){return m(Int8Array,X(e))})),this.readers.set("Uint8Array",(function(e){return m(Uint8Array,X(e))})),this.readers.set("Uint8ClampedArray",(function(e){return m(Uint8ClampedArray,X(e))})),this.readers.set("Int16Array",(function(e){return m(Int16Array,X(e))})),this.readers.set("Uint16Array",(function(e){return m(Uint16Array,X(e))})),this.readers.set("Int32Array",(function(e){return m(Int32Array,X(e))})),this.readers.set("Uint32Array",(function(e){return m(Uint32Array,X(e))})),this.readers.set("Float32Array",(function(e){return m(Float32Array,X(e))})),this.readers.set("Float64Array",(function(e){return m(Float64Array,X(e))}))}return c(e,[{key:"addReader",value:function(e,t){var n="object"===i(t)?t.read:function(e){return Object.assign(Object.create(t.prototype),e)};this.readers.set(e,n)}},{key:"readVM",value:function(e,t){if("$"!==t)throw Error("VirtualMachine must be root object");for(var n={_random:new de(null,{state:e._random})},i=0,r=Object.entries(e);i<r.length;i++){var o=Z(r[i],2),s=o[0],a=o[1];n[s]||this.readInto(n,s,a,t)}return this.readDeferred(),this.resolveRefs(),n}},{key:"readDeferred",value:function(){for(;this.todo.length>0;){var e=this.todo.shift(),t=e.object,n=e.key,i=e.value,r=e.path;this.readInto(t,n,i,r,1)}}},{key:"resolveRefs",value:function(){var e,t=W(this.unresolved);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=n.object,r=n.key,o=n.ref,s=n.path;if(!this.refs.has(o))throw Error("Unresolved ref: ".concat(o," at ").concat(s,"[").concat(JSON.stringify(r),"]"));i[r]=this.refs.get(o)}}catch(e){t.e(e)}finally{t.f()}}},{key:"read",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(i(e)){case"number":case"string":case"boolean":return e;default:var r=Object.prototype.toString.call(e).slice(8,-1);switch(r){case"Array":return this.readArray(e,t,n);case"Null":return null;case"Object":var o=e.$class,s=e.$model,a=e.$ref;if(a)throw Error("refs should have been handled in readInto()");return s?this.readModel(e,t):o?this.readAs(o,e,t):this.readObject(Object,e,t,n);default:throw Error("Don't know how to deserialize ".concat(r," at ").concat(t))}}}},{key:"readModel",value:function(e,t){var n=pl.instantiateClassID(e.$model,e.id);e.$id&&this.refs.set(e.$id,n);for(var i=0,r=Object.entries(e);i<r.length;i++){var o=Z(r[i],2),s=o[0],a=o[1];"id"!==s&&"$"!==s[0]&&this.readInto(n,s,a,t)}return n}},{key:"readObject",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=new e;t.$id&&this.refs.set(t.$id,r);for(var o=0,s=Object.entries(t);o<s.length;o++){var a=Z(s[o],2),c=a[0],l=a[1];"$"!==c[0]&&this.readInto(r,c,l,n,i)}return r}},{key:"readArray",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];e.$id&&this.refs.set(e.$id,i);for(var r=0;r<e.length;r++)void 0!==e[r]&&this.readInto(i,r,e[r],t,n);return i}},{key:"readAs",value:function(e,t,n){var i={},r=new Map;if("$value"in t)i=this.read(t.$value,n,2);else for(var o=0,s=Object.entries(t);o<s.length;o++){var a=Z(s[o],2),c=a[0],l=a[1];if("$"!==c[0]){var u=l&&l.$ref;u?this.refs.has(u)?i[c]=this.refs.get(u):(i[c]="<unresolved>",r.set(u,c)):this.readInto(i,c,l,n,1)}}var d=this.readers.get(e)(i,n);d||"Undefined"===e||"NaN"===e||"NegZero"===e||console.warn('Reading "'.concat(e,'" returned ').concat(d," at ").concat(n)),t.$id&&this.refs.set(t.$id,d);var h,f=W(r.entries());try{for(f.s();!(h=f.n()).done;){var m=Z(h.value,2),p=m[0],y=m[1];this.unresolved.push({object:d,key:y,ref:p,path:n})}}catch(e){f.e(e)}finally{f.f()}return d}},{key:"readRef",value:function(e,t,n,i){if(!n||!n.$ref)return!1;var r=n.$ref;return this.refs.has(r)?e[t]=this.refs.get(r):(e[t]="<unresolved>",this.unresolved.push({object:e,key:t,ref:r,path:i})),!0}},{key:"readInto",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!this.readRef(e,t,n,r))if(0!==o||"object"!==i(n)){var s="string"==typeof t&&t.match(/^[_a-z][_a-z0-9]*$/i),a=r+(s?".".concat(t):"[".concat(JSON.stringify(t),"]"));e[t]=this.read(n,a,o>0?o-1:0)}else this.todo.push({object:e,key:t,value:n,path:r})}}],[{key:"newOrRecycled",value:function(e){var t=this.reusableInstance;return t?(t.vm=e,t.refs=new Map,t.todo=[],t.unresolved=[]):t=this.reusableInstance=new this(e),t}},{key:"reusableInstance",get:function(){return this[this.name+"-instance"]},set:function(e){this[this.name+"-instance"]=e}},{key:"resetInstance",value:function(){this.reusableInstance=null}}]),e}(),cl=function(e){u(n,e);var t=v(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"encode",value:function(e){var t=this.writeArray(e,"$");return this.writeDeferred(),t}},{key:"writeModel",value:function(e){return{$ref:e.id}}}]),n}(sl),ll=function(e){u(n,e);var t=v(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"decode",value:function(e){var t=this.readArray(e,"$");return this.readDeferred(),this.resolveRefs(),t}},{key:"resolveRefs",value:function(){var e,t=W(this.unresolved);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=n.object,r=n.key,o=n.ref,s=n.path;if(this.refs.has(o))i[r]=this.refs.get(o);else{var a=this.vm.lookUpModel(o);if(!a)throw Error("Unresolved ref: ".concat(o," at ").concat(s,"[").concat(JSON.stringify(r),"]"));i[r]=a}}}catch(e){t.e(e)}finally{t.f()}}}]),n}(al);function ul(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set,o=Object.values(e).filter((function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return("Object"===t||"Array"===t)&&!r.has(e)})),s=W(o);try{for(s.s();!(t=s.n()).done;){var a=t.value;r.add(a);var c=n+"."+a.constructor.name;if(i[c]){if(i[c]!==a.constructor)throw new Error("Class with name "+c+" already gathered, but new one has different identity")}else i[c]=a.constructor}}catch(e){s.e(e)}finally{s.f()}var l,u=W(o);try{for(u.s();!(l=u.n()).done;){var d=l.value;ul(d,n,i,r)}}catch(e){u.e(e)}finally{u.f()}}function dl(e){for(var t=new Uint8Array(e),n=t.byteLength,i="",r=0;r<n;r++)i+=String.fromCharCode(t[r]);return window.btoa(i)}var hl=K.has("debug","classes",!1),fl=Symbol("SECRET"),ml=new WeakSet,pl=function(e){function t(e){if(s(this,t),e!==fl)throw Error("You must create ".concat(this,' using create() not "new"!'))}return c(t,[{key:"init",value:function(e){ml.delete(this)}},{key:"destroy",value:function(){yt().unsubscribeAll(this),yt().deregister(this)}},{key:"publish",value:function(e,t,n){this.__realm||this.__realmError(),this.__realm.publish(t,n,e)}},{key:"subscribe",value:function(e,t,n){return this.__realm||this.__realmError(),this.__realm.subscribe(this,e,t,n)}},{key:"unsubscribe",value:function(e,t){this.__realm||this.__realmError(),this.__realm.unsubscribe(this,e,t)}},{key:"unsubscribeAll",value:function(){this.__realm||this.__realmError(),this.__realm.unsubscribeAll(this)}},{key:"__realmError",value:function(){if(!this.id)throw Error("".concat(this," has no ID, did you call super.init(options)?"))}},{key:"future",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.__realm||this.__realmError();for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this.__realm.future(this,e,t,i)}},{key:"random",value:function(){return yt().random()}},{key:"now",value:function(){return yt().now()}},{key:"beWellKnownAs",value:function(e){yt().vm.set(e,this)}},{key:"getModel",value:function(e){return this.__realm.vm.lookUpModel(e)}},{key:"wellKnownModel",value:function(e){return this.__realm.vm.get(e)}},{key:"modelOnly",value:function(e){if($c.current()===this.__realm.vm)return!0;var t=Error(e||"".concat(this,".modelOnly() called from outside a model!"));throw De("view code",t),t}},{key:"sessionId",get:function(){return this.__realm.vm.id}},{key:"viewCount",get:function(){return Object.keys(this.__realm.vm.views).length}},{key:"persistSession",value:function(e){if(this!==this.wellKnownModel("modelRoot"))throw Error("persistSession() must only be called on the root model");this.__realm.vm.persist(this,e)}},{key:Symbol.toPrimitive,value:function(){var e=this.constructor[bl]||this.constructor.name;return e.includes("Model")?e:"".concat(e,"[Model]")}}],[{key:"create",value:function(e,n,i){if(!gl(this))throw Error('Model class "'.concat(this.name,'" not registered'));var r=yt(),o=new this(fl);return Object.defineProperty(o,"__realm",{value:r}),Object.defineProperty(o,"id",{value:r.register(o),enumerable:!0}),ml.add(o),"string"==typeof n&&(console.warn('Croquet: Model.create(..., "'.concat(n,'") with a well-known name argument is deprecated!')),o.beWellKnownAs(n),n=void 0),i&&o.beWellKnownAs(i),o.init(e,n),ml.has(o)&&(ml.delete(o),Object.getPrototypeOf(this)!==t&&console.warn("".concat(o," did not call super.init(options)"))),o}},{key:"createNoInit",value:function(e){var t=yt(),n=new this(fl);return Object.defineProperty(n,"__realm",{value:t}),Object.defineProperty(n,"id",{value:e,enumerable:!0}),n}},{key:"allowConstructors",value:function(){fl=void 0,console.warn("disabling error reporting for Model constructors")}},{key:"register",value:function(e){return e||(e=this.name,console.warn("Deprecation warning: ".concat(this.name,".register(classId) called without classId. See https://croquet.io/sdk/docs/Model.html#.register"))),al.resetInstance(),sl.resetInstance(),cl.resetInstance(),ll.resetInstance(),function(e,t){var n=J(e),i=q("".concat(t,":").concat(n));ee.push(i),O()&&i.then((function(e){B[e].what="Class ".concat(t)}))}(this,e),function(e,t){var n=yl[t];if(n&&n!==e)throw Error("Registering model class ".concat(e.name,' failed, id "').concat(t,'" already used by ').concat(n.name));gl(e)?hl&&!n&&console.warn("ignoring re-exported model class ".concat(t)):(hl&&console.log("registering model class ".concat(t)),e[bl]=t);yl[t]=e}(this,e),this}},{key:"wellKnownModel",value:function(e){if(!$c.hasCurrent())throw Error("static Model.wellKnownModel() called from outside model");return $c.current().get(e)}},{key:"types",value:function(){return{}}},{key:"classToID",value:function(e){return function(e){if(gl(e))return e[bl];throw Error('Class "'.concat(e.name,'" not found, did you call ').concat(e.name,'.register("').concat(e.name,'")?'))}(e)}},{key:"classFromID",value:function(e){return Zl(e)}},{key:"allClasses",value:function(){return vl()}},{key:"allClassTypes",value:function(){return function(){var e,t={},n=W(vl());try{for(n.s();!(e=n.n()).done;){var i=e.value;Object.assign(t,i.types())}}catch(e){n.e(e)}finally{n.f()}return Object.entries(t)}()}},{key:"instantiateClassID",value:function(e,t){return Zl(e).createNoInit(t)}}]),t}(),yl={},bl=Symbol("CLASS_ID");function vl(){return Object.values(yl)}function gl(e){return Object.prototype.hasOwnProperty.call(e,bl)}function Zl(e){if(yl[e])return yl[e];throw Error('Class "'.concat(e,'" in snapshot, but not found in current source?'))}var wl="Croquet.Model";pl[bl]=wl,yl[wl]=pl;var Xl=function(e){function t(e){s(this,t),"object"===i(e)&&"__realm"in e||console.warn("Croquet: argument to View constructor needs to be a Model");var n=yt("");n&&n.isViewRealm()||(n=vt(e.__realm.vm,(function(){return yt()}),!0)),Object.defineProperty(this,"realm",{value:n}),Object.defineProperty(this,"id",{value:n.register(this),configurable:!0})}return c(t,[{key:"detach",value:function(){this.unsubscribeAll(),this.realm.deregister(this),Object.defineProperty(this,"id",{value:""})}},{key:"reattach",value:function(){Object.defineProperty(this,"id",{value:this.realm.register(this)})}},{key:"publish",value:function(e,t,n){this.realm.publish(t,n,e)}},{key:"subscribe",value:function(e,t,n){"string"==typeof n&&(n=this[n]),n=n.bind(this);var i=t.event?t:{event:t},r=i.event,o=i.handling;this.realm.subscribe(r,this.id,n,e,o)}},{key:"unsubscribe",value:function(e,t){this.realm.unsubscribe(t,this.id,null,e)}},{key:"unsubscribeAll",value:function(){this.realm.unsubscribeAll(this.id)}},{key:"future",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.realm.future(this,e)}},{key:"random",value:function(){return yt().random()}},{key:"now",value:function(){return this.realm.now()}},{key:"externalNow",value:function(){return this.realm.externalNow()}},{key:"extrapolatedNow",value:function(){return this.realm.extrapolatedNow()}},{key:"update",value:function(e){}},{key:"wellKnownModel",value:function(e){return this.realm.vm.get(e)}},{key:"sessionId",get:function(){return this.realm.vm.id}},{key:"session",get:function(){return this.realm.vm.controller.session}},{key:"viewId",get:function(){return this.realm.vm.controller.viewId}},{key:Symbol.toPrimitive,value:function(){var e=this.constructor.name;return e.includes("View")?e:"".concat(e,"[View]")}}],[{key:"displayStatus",value:function(e,t){return Ue(e,t)}},{key:"displayWarning",value:function(e,t){return Qe(e,t)}},{key:"displayError",value:function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&ct.showMessage(e,n(n({},t),{},{level:"error"}))}(e,t)}}]),t}(),xl=new(function(){function e(){s(this,e),this.ready=!1,this.isInIframe=window.top!==window,this.subscriptions={},this.enumerator=null}return c(e,[{key:"setReceiver",value:function(e){this.receiver=e,this.ready=!0}},{key:"setIframeEnumerator",value:function(e){this.enumerator=e}},{key:"on",value:function(e,t){var n=this;if(!this.receiver)throw Error("setReceiver() has not been called");if("string"==typeof t&&(t=this.receiver[t]),!t)throw Error("Messenger.on: the second argument must be a method name or a function");if(this.subscriptions[e]){if(this.findIndex(this.subscriptions[e],t)>=0)throw Error("".concat(t," is already subscribed"))}else this.subscriptions[e]=[];this.subscriptions[e].push(t),this.listener||(this.listener=function(e){return n.receive(e)},window.addEventListener("message",this.listener))}},{key:"detach",value:function(){this.listener&&(window.removeEventListener("message",this.listener),this.listener=null),this.stopPublishingPointerMove(),this.receiver=null,this.subscriptions={},this.enumerator=null,this.ready=!1}},{key:"removeSubscription",value:function(e,t){"string"==typeof t&&(t=this.receiver[t]);var n=this.subscriptions[e];if(n){var i=this.findIndex(n,t);n.splice(i,1),0===n.length&&delete this.subscriptions[e]}}},{key:"removeAllSubscriptions",value:function(){this.subscriptions={}}},{key:"receive",value:function(e){var t=e.data,n=t.event,i=t.data,r=e.source;this.handleEvent(n,i,r)}},{key:"handleEvent",value:function(e,t,n){var i=this,r=this.subscriptions[e];r&&r.forEach((function(e){e.call(i.receiver,t,n)}))}},{key:"send",value:function(e,t,n){this.isInIframe?window.top.postMessage({event:e,data:t},"*"):n?n.postMessage({event:e,data:t},"*"):this.enumerator&&this.enumerator().forEach((function(n){n.contentWindow.postMessage({event:e,data:t},"*")}))}},{key:"findIndex",value:function(e,t){var n=t.name;return e.findIndex((function(e){var i=e.name;return n||i?n===i:t===e}))}},{key:"startPublishingPointerMove",value:function(){var e=this;this._moveHandler||(this._moveHandler=function(t){return e.send("pointerPosition",{x:t.clientX,y:t.clientY,type:t.type})},window.document.addEventListener("pointermove",this._moveHandler,!0))}},{key:"stopPublishingPointerMove",value:function(){this._moveHandler&&(window.document.removeEventListener("pointermove",this._moveHandler,!0),this._moveHandler=null)}}]),e}());var kl=60,Ll=function(){function e(){s(this,e)}var t,r,a;return c(e,null,[{key:"join",value:(a=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.join_impl(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),ct.showMessage(e.t0.message,{level:"fatal"}),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e){return a.apply(this,arguments)})},{key:"join_impl",value:(r=o(regeneratorRuntime.mark((function t(r){var s,a,c,l,u,d,h,f,m,p,y,b,v,g,w,x,k,L,G,S,W,Y,C,R,V,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(I=function(){x.model=null,x.view&&(K.has("debug","session",!1)&&console.log(x.id,"detaching root view"),x.view.detach(),""!==x.view.id&&console.warn("Croquet: ".concat(x.view," did not call super.detach()")),x.view=null),ct.clearSessionMoniker(),xl.ready&&xl.detach()},V=function(){return(V=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I(),!g.leaving){e.next=4;break}return g.leaving(!0),e.abrupt("return");case 4:if(!C){e.next=6;break}return e.abrupt("return");case 6:return C=!0,e.next=9,g.establishSession(k);case 9:C=!1,x.model=g.vm.get("modelRoot"),x.id=g.id,x.persistentId=g.persistentId,x.versionId=g.versionId,g.session=x,ct.makeSessionWidgets(x.id),g.inViewRealm((function(){K.has("debug","session",!1)&&console.log(x.id,"creating root view"),x.view=new f(x.model)}));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)},R=function(){return V.apply(this,arguments)},d=function(e,t){return e===t||e.prototype instanceof t},"object"===i(r)){t.next=6;break}throw Error("Croquet: please use new Session.join( {apiKey, ...} ) API. See https://croquet.io/sdk/docs/Session.html#.join");case 6:s=0,a=Object.entries(r);case 7:if(!(s<a.length)){t.next=16;break}if(c=Z(a[s],2),l=c[0],!((u=c[1])instanceof Promise)){t.next=13;break}return t.next=12,u;case 12:r[l]=t.sent;case 13:s++,t.next=7;break;case 16:if("string"==typeof r.apiKey){t.next=18;break}throw Error("Croquet: no apiKey provided in Session.join()!");case 18:if(!(r.apiKey.length>128)){t.next=20;break}throw Error("Croquet: apiKey > 128 characters in Session.join()!");case 20:if("string"==typeof r.name){t.next=22;break}throw Error("Croquet: no session name provided in Session.join()!");case 22:if(!(r.name.length>128)){t.next=24;break}throw Error("Croquet: session name > 128 characters in Session.join()!");case 24:if("function"==typeof(h=r.model)&&d(h,pl)){t.next=27;break}throw Error("Croquet: bad model class in Session.join()");case 27:if("function"==typeof(f=r.view||Xl)&&d(f,Xl)){t.next=30;break}throw Error("Croquet: bad view class in Session.join()");case 30:if("string"==typeof r.appId){t.next=32;break}throw Error("Croquet: no appId provided in Session.join()");case 32:if(!(!r.appId.length>128)){t.next=34;break}throw Error("Croquet: appId > 128 characters in Session.join()");case 34:if(r.appId.match(/^[a-z](-?[a-z0-9_])*(\.[a-z0-9_](-?[a-z0-9_])*)+$/i)){t.next=36;break}throw Error("Croquet: malformed appId in Session.join()");case 36:if("string"==typeof r.password&&r.password){t.next=38;break}throw Error("Croquet: no password provided in Session.join()");case 38:if((m=K.reflector||r.reflector)&&(m.includes("://")||m.match(/^[-a-z0-9]+$/i)?K.reflector=m:console.warn('Croquet: Not a valid websocket url, ignoring reflector "'.concat(m,'"'))),!("rejoinLimit"in r)){t.next=45;break}if(!("number"!=typeof r.rejoinLimit||r.rejoinLimit<0||r.rejoinLimit>6e4)){t.next=43;break}throw Error("rejoinLimit range: 0-60000");case 43:t.next=46;break;case 45:r.rejoinLimit=1e3;case 46:if(!("eventRateLimit"in r)){t.next=51;break}if(!("number"!=typeof r.eventRateLimit||r.eventRateLimit<1||r.eventRateLimit>60)){t.next=49;break}throw Error("eventRateLimit range: 1-60");case 49:t.next=52;break;case 51:r.eventRateLimit=20;case 52:if(!r.heraldUrl){t.next=57;break}if(!(r.heraldUrl.length>256)){t.next=55;break}throw Error("heraldUrl can only be 256 characters");case 55:if(r.heraldUrl.startsWith("https://")){t.next=57;break}throw Error("heraldUrl needs to be https");case 57:if(!r.hashOverride){t.next=62;break}if(43===r.hashOverride.length){t.next=60;break}throw Error("hashOverride must be 43 characters");case 60:if(-1===r.hashOverride.search(/[^-_a-zA-Z0-9]/)){t.next=62;break}throw Error("hashOverride must be base64url encoded");case 62:if(r.debug&&(p=function(e){return"string"==typeof e&&(e=e.split(",")),e?Array.isArray(e)?e:[e]:[]},K.debug=[].concat(X(p(r.debug)),X(p(K.debug))).join(",")),!("autoSleep"in r)){t.next=78;break}if(y=r.autoSleep,"number"!==(b=i(y))){t.next=71;break}if(!(y<0)){t.next=69;break}throw Error("an autoSleep value must be >= 0");case 69:t.next=76;break;case 71:if("boolean"!==b){t.next=75;break}r.autoSleep=y?10:0,t.next=76;break;case 75:throw Error("autoSleep must be numeric or boolean");case 76:t.next=79;break;case 78:r.autoSleep=10;case 79:"expectedSimFPS"in r&&(kl=Math.min(r.expectedSimFPS,120)),v=["name","password","apiKey","appId","tps","autoSleep","heraldUrl","rejoinLimit","eventRateLimit","optionsFromUrl","viewIdDebugSuffix","hashOverride"],Wl(),g=new Yc,w=JSON.parse(JSON.stringify(n({},r.options))),t.t0=function(e){g.stepSession("animation",{frameTime:e,view:x.view,expectedSimFPS:kl})},t.t1=function(){return e.leave(x.id)},x={id:"",persistentId:"",versionId:"",model:null,view:null,step:t.t0,leave:t.t1,get latency(){return g.latency},get latencies(){return g.latencies}},k={options:w,initFn:function(e,t){return h.create(e,t,"modelRoot")},rebootModelView:R};for(L=0,G=Object.entries(r);L<G.length;L++)S=Z(G[L],2),W=S[0],Y=S[1],v.includes(W)&&(k[W]=Y);return t.next=91,g.initFromSessionSpec(k);case 91:return C=!1,t.next=94,R();case 94:return"manual"!==r.step&&g.startStepping(x.step),t.abrupt("return",x);case 96:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)})},{key:"leave",value:(t=o(regeneratorRuntime.mark((function e(t){var n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Wc(t)){e.next=3;break}return e.abrupt("return",!1);case 3:if(n.reconnectTimeout&&(clearTimeout(n.reconnectTimeout),delete n.reconnectTimeout),i=new Promise((function(e){return n.leaving=e})),(r=n.connection).connected){e.next=8;break}return e.abrupt("return",!1);case 8:return r.closeConnection(1e3),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"thisSession",value:function(){var e=$c.current();return e?e.id:""}}]),e}(),Gl={};function Sl(e){if(!Object.isFrozen(e)){Object.freeze(e);for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];!r||"object"!==i(r)&&"function"!=typeof r||Sl(r)}}}function Wl(){Object.isFrozen(Gl)||(Sl(Gl),function(e){var t=JSON.stringify(e,(function(e,t){return"function"==typeof t?J(t):t}));if("{}"!==t){var n=JSON.parse(t),i=q(P(n));ee.push(i),O()&&i.then((function(e){B[e].what="Croquet Constants"}))}}(Gl))}return e.App=ct,e.Constants=Gl,e.Data=Fc,e.Messenger=xl,e.Model=pl,e.Session=Ll,e.View=Xl,e.gatherInternalClassTypes=function(e,t){var n={};return ul({root:e},t,n,new Set),n},e.startSession=function(){return ct.showMessage("Croquet.startSession() is deprecated, please use Croquet.Session.join()",{level:"warning",only:"once"}),Ll.join.apply(Ll,arguments)},Object.defineProperty(e,"__esModule",{value:!0}),e}({});

